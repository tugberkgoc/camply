This is a polyfill for the \href{https://encoding.spec.whatwg.org/}{\tt Encoding Living Standard} A\+PI for the Web, allowing encoding and decoding of textual data to and from Typed Array buffers for binary data in Java\+Script.

By default it adheres to the spec and does not support {\itshape encoding} to legacy encodings, only {\itshape decoding}. It is also implemented to match the specification\textquotesingle{}s algorithms, rather than for performance. The intended use is within Web pages, so it has no dependency on server frameworks or particular module schemes.

Basic examples and tests are included.

\subsubsection*{Install}

There are a few ways you can get the {\ttfamily text-\/encoding} library.

\paragraph*{Node}

{\ttfamily text-\/encoding} is on {\ttfamily npm}. Simply run\+:


\begin{DoxyCode}
npm install text-encoding
\end{DoxyCode}


Or add it to your {\ttfamily package.\+json} dependencies.

\paragraph*{Bower}

{\ttfamily text-\/encoding} is on {\ttfamily bower} as well. Install with bower like so\+:


\begin{DoxyCode}
bower install text-encoding
\end{DoxyCode}


Or add it to your {\ttfamily bower.\+json} dependencies.

\subsubsection*{H\+T\+ML Page Usage}


\begin{DoxyCode}
<script src="encoding-indexes.js"></script>
<script src="encoding.js"></script>
\end{DoxyCode}


\subsubsection*{A\+PI Overview}

Basic Usage


\begin{DoxyCode}
var uint8array = new TextEncoder().encode(string);
var string = new TextDecoder(encoding).decode(uint8array);
\end{DoxyCode}


Streaming Decode


\begin{DoxyCode}
var string = "", decoder = new TextDecoder(encoding), buffer;
while (buffer = next\_chunk()) \{
  string += decoder.decode(buffer, \{stream:true\});
\}
string += decoder.decode(); // finish the stream
\end{DoxyCode}


\subsubsection*{Encodings}

All encodings from the Encoding specification are supported\+:

utf-\/8 ibm866 iso-\/8859-\/2 iso-\/8859-\/3 iso-\/8859-\/4 iso-\/8859-\/5 iso-\/8859-\/6 iso-\/8859-\/7 iso-\/8859-\/8 iso-\/8859-\/8-\/i iso-\/8859-\/10 iso-\/8859-\/13 iso-\/8859-\/14 iso-\/8859-\/15 iso-\/8859-\/16 koi8-\/r koi8-\/u macintosh windows-\/874 windows-\/1250 windows-\/1251 windows-\/1252 windows-\/1253 windows-\/1254 windows-\/1255 windows-\/1256 windows-\/1257 windows-\/1258 x-\/mac-\/cyrillic gb18030 hz-\/gb-\/2312 big5 euc-\/jp iso-\/2022-\/jp shift\+\_\+jis euc-\/kr replacement utf-\/16be utf-\/16le x-\/user-\/defined

(Some encodings may be supported under other names, e.\+g. ascii, iso-\/8859-\/1, etc. See \href{https://encoding.spec.whatwg.org/}{\tt Encoding} for additional labels for each encoding.)

Encodings other than {\bfseries utf-\/8}, {\bfseries utf-\/16le} and {\bfseries utf-\/16be} require an additional {\ttfamily encoding-\/indexes.\+js} file to be included. It is rather large (596kB uncompressed, 188kB gzipped); portions may be deleted if support for some encodings is not required.

\subsubsection*{Non-\/\+Standard Behavior}

As required by the specification, only encoding to {\bfseries utf-\/8} is supported. If you want to try it out, you can force a non-\/standard behavior by passing the {\ttfamily N\+O\+N\+S\+T\+A\+N\+D\+A\+R\+D\+\_\+allow\+Legacy\+Encoding} option to Text\+Encoder and a label. For example\+:


\begin{DoxyCode}
var uint8array = new TextEncoder(
  'windows-1252', \{ NONSTANDARD\_allowLegacyEncoding: true \}).encode(text);
\end{DoxyCode}


But note that the above won\textquotesingle{}t work if you\textquotesingle{}re using the polyfill in a browser that natively supports the Text\+Encoder A\+PI natively, since the polyfill won\textquotesingle{}t be used!

You can force the polyfill to be used by using this before the polyfill\+:


\begin{DoxyCode}
<script>
window.TextEncoder = window.TextDecoder = null;
</script>
\end{DoxyCode}


To support the legacy encodings (which may be stateful), the Text\+Encoder {\ttfamily encode()} method accepts an optional dictionary and {\ttfamily stream} option, e.\+g. {\ttfamily encoder.\+encode(string, \{stream\+: true\});} This is not needed for standard encoding since the input is always in complete code points. 