\href{http://travis-ci.org/mongodb-js/mongodb-core}{\tt } \href{https://coveralls.io/github/mongodb-js/mongodb-core?branch=1.3}{\tt }

\section*{Description}

The Mongo\+DB Core driver is the low level part of the 2.\+0 or higher Mongo\+DB driver and is meant for library developers not end users. It does not contain any abstractions or helpers outside of the basic management of Mongo\+DB topology connections, C\+R\+UD operations and authentication.

\subsection*{Mongo\+DB Node.\+JS Core Driver}

\tabulinesep=1mm
\begin{longtabu} spread 0pt [c]{*{2}{|X[-1]}|}
\hline
\rowcolor{\tableheadbgcolor}\textbf{ what  }&\textbf{ where   }\\\cline{1-2}
\endfirsthead
\hline
\endfoot
\hline
\rowcolor{\tableheadbgcolor}\textbf{ what  }&\textbf{ where   }\\\cline{1-2}
\endhead
documentation  &\href{http://mongodb.github.io/node-mongodb-native/}{\tt http\+://mongodb.\+github.\+io/node-\/mongodb-\/native/}   \\\cline{1-2}
apidoc  &\href{http://mongodb.github.io/node-mongodb-native/}{\tt http\+://mongodb.\+github.\+io/node-\/mongodb-\/native/}   \\\cline{1-2}
source  &\href{https://github.com/mongodb-js/mongodb-core}{\tt https\+://github.\+com/mongodb-\/js/mongodb-\/core}   \\\cline{1-2}
mongodb  &\href{http://www.mongodb.org/}{\tt http\+://www.\+mongodb.\+org/}   \\\cline{1-2}
\end{longtabu}


\subsubsection*{Blogs of Engineers involved in the driver}


\begin{DoxyItemize}
\item Christian Kvalheim \href{https://twitter.com/christkv}{\tt } \href{http://christiankvalheim.com}{\tt http\+://christiankvalheim.\+com}
\end{DoxyItemize}

\subsubsection*{Bugs / Feature Requests}

Think youâ€™ve found a bug? Want to see a new feature in node-\/mongodb-\/native? Please open a case in our issue management tool, J\+I\+RA\+:


\begin{DoxyItemize}
\item Create an account and login \href{https://jira.mongodb.org}{\tt https\+://jira.\+mongodb.\+org}.
\item Navigate to the N\+O\+DE project \href{https://jira.mongodb.org/browse/NODE}{\tt https\+://jira.\+mongodb.\+org/browse/\+N\+O\+DE}.
\item Click {\bfseries Create Issue} -\/ Please provide as much information as possible about the issue type and how to reproduce it.
\end{DoxyItemize}

Bug reports in J\+I\+RA for all driver projects (i.\+e. N\+O\+DE, P\+Y\+T\+H\+ON, C\+S\+H\+A\+RP, J\+A\+VA) and the Core Server (i.\+e. S\+E\+R\+V\+ER) project are {\bfseries public}.

\subsubsection*{Questions and Bug Reports}


\begin{DoxyItemize}
\item mailing list\+: \href{https://groups.google.com/forum/#!forum/node-mongodb-native}{\tt https\+://groups.\+google.\+com/forum/\#!forum/node-\/mongodb-\/native}
\item jira\+: \href{http://jira.mongodb.org/}{\tt http\+://jira.\+mongodb.\+org/}
\end{DoxyItemize}

\subsubsection*{Change Log}

\href{http://jira.mongodb.org/browse/NODE}{\tt http\+://jira.\+mongodb.\+org/browse/\+N\+O\+DE}

\section*{Quick\+Start}

The quick start guide will show you how to set up a simple application using Core driver and Mongo\+DB. It scope is only how to set up the driver and perform the simple crud operations. For more inn depth coverage we encourage reading the tutorials.

\subsection*{Create the package.\+json file}

Let\textquotesingle{}s create a directory where our application will live. In our case we will put this under our projects directory.


\begin{DoxyCode}
mkdir myproject
cd myproject
\end{DoxyCode}


Create a {\bfseries package.\+json} using your favorite text editor and fill it in.


\begin{DoxyCode}
\{
  "name": "myproject",
  "version": "1.0.0",
  "description": "My first project",
  "main": "index.js",
  "repository": \{
    "type": "git",
    "url": "git://github.com/christkv/myfirstproject.git"
  \},
  "dependencies": \{
    "mongodb-core": "~1.0"
  \},
  "author": "Christian Kvalheim",
  "license": "Apache 2.0",
  "bugs": \{
    "url": "https://github.com/christkv/myfirstproject/issues"
  \},
  "homepage": "https://github.com/christkv/myfirstproject"
\}
\end{DoxyCode}


Save the file and return to the shell or command prompt and use {\bfseries N\+PM} to install all the dependencies.


\begin{DoxyCode}
npm install
\end{DoxyCode}


You should see {\bfseries N\+PM} download a lot of files. Once it\textquotesingle{}s done you\textquotesingle{}ll find all the downloaded packages under the {\bfseries node\+\_\+modules} directory.

\subsection*{Booting up a Mongo\+DB Server }

Let\textquotesingle{}s boot up a Mongo\+DB server instance. Download the right Mongo\+DB version from \href{http://www.mongodb.org}{\tt Mongo\+DB}, open a new shell or command line and ensure the {\bfseries mongod} command is in the shell or command line path. Now let\textquotesingle{}s create a database directory (in our case under $\ast$$\ast$/data$\ast$$\ast$).


\begin{DoxyCode}
mongod --dbpath=/data --port 27017
\end{DoxyCode}


You should see the {\bfseries mongod} process start up and print some status information.

\subsection*{Connecting to Mongo\+DB}

Let\textquotesingle{}s create a new {\bfseries app.\+js} file that we will use to show the basic C\+R\+UD operations using the Mongo\+DB driver.

First let\textquotesingle{}s add code to connect to the server. Notice that there is no concept of a database here and we use the topology directly to perform the connection.


\begin{DoxyCode}
var Server = require('mongodb-core').Server
  , assert = require('assert');

// Set up server connection
var server = new Server(\{
    host: 'localhost'
  , port: 27017
  , reconnect: true
  , reconnectInterval: 50
\});

// Add event listeners
server.on('connect', function(\_server) \{
  console.log('connected');
  test.done();
\});

server.on('close', function() \{
  console.log('closed');
\});

server.on('reconnect', function() \{
  console.log('reconnect');
\});

// Start connection
server.connect();
\end{DoxyCode}


To connect to a replicaset we would use the {\ttfamily Repl\+Set} class and for a set of Mongos proxies we use the {\ttfamily Mongos} class. Each topology class offer the same C\+R\+UD operations and you operate on the topology directly. Let\textquotesingle{}s look at an example exercising all the different available C\+R\+UD operations.


\begin{DoxyCode}
var Server = require('mongodb-core').Server
  , assert = require('assert');

// Set up server connection
var server = new Server(\{
    host: 'localhost'
  , port: 27017
  , reconnect: true
  , reconnectInterval: 50
\});

// Add event listeners
server.on('connect', function(\_server) \{
  console.log('connected');

  // Execute the ismaster command
  \_server.command('system.$cmd', \{ismaster: true\}, function(err, result) \{

    // Perform a document insert
    \_server.insert('myproject.inserts1', [\{a:1\}, \{a:2\}], \{
      writeConcern: \{w:1\}, ordered:true
    \}, function(err, results) \{
      assert.equal(null, err);
      assert.equal(2, results.result.n);      

      // Perform a document update
      \_server.update('myproject.inserts1', [\{
        q: \{a: 1\}, u: \{'$set': \{b:1\}\}
      \}], \{
        writeConcern: \{w:1\}, ordered:true
      \}, function(err, results) \{
        assert.equal(null, err);
        assert.equal(1, results.result.n);

        // Remove a document
        \_server.remove('myproject.inserts1', [\{
          q: \{a: 1\}, limit: 1
        \}], \{
          writeConcern: \{w:1\}, ordered:true
        \}, function(err, results) \{
          assert.equal(null, err);
          assert.equal(1, results.result.n);

          // Get a document
          var cursor = \_server.cursor('integration\_tests.inserts\_example4', \{
              find: 'integration\_tests.example4'
            , query: \{a:1\}
          \});

          // Get the first document
          cursor.next(function(err, doc) \{
            assert.equal(null, err);
            assert.equal(2, doc.a);

            // Execute the ismaster command
            \_server.command("system.$cmd"
              , \{ismaster: true\}, function(err, result) \{
                assert.equal(null, err)
                \_server.destroy();              
            \});
          \});
      \});
    \});

    test.done();
  \});
\});

server.on('close', function() \{
  console.log('closed');
\});

server.on('reconnect', function() \{
  console.log('reconnect');
\});

// Start connection
server.connect();
\end{DoxyCode}


The core driver does not contain any helpers or abstractions only the core crud operations. These consist of the following commands.


\begin{DoxyItemize}
\item {\ttfamily insert}, Insert takes an array of 1 or more documents to be inserted against the topology and allows you to specify a write concern and if you wish to execute the inserts in order or out of order.
\item {\ttfamily update}, Update takes an array of 1 or more update commands to be executed against the server topology and also allows you to specify a write concern and if you wish to execute the updates in order or out of order.
\item {\ttfamily remove}, Remove takes an array of 1 or more remove commands to be executed against the server topology and also allows you to specify a write concern and if you wish to execute the removes in order or out of order.
\item {\ttfamily cursor}, Returns you a cursor for either the \textquotesingle{}virtual\textquotesingle{} {\ttfamily find} command, a command that returns a cursor id or a plain cursor id. Read the cursor tutorial for more inn depth coverage.
\item {\ttfamily command}, Executes a command against Mongo\+DB and returns the result.
\item {\ttfamily auth}, Authenticates the current topology using a supported authentication scheme.
\end{DoxyItemize}

The Core Driver is a building block for library builders and is not meant for usage by end users as it lacks a lot of features the end user might need such as automatic buffering of operations when a primary is changing in a replicaset or the db and collections abstraction.

\subsection*{Next steps}

The next step is to get more in depth information about how the different aspects of the core driver works and how to leverage them to extend the functionality of the cursors. Please view the tutorials for more detailed information. 