<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Camply: 5.4.0 / 2018-12-14</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="camply.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Camply
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">Camply is a social platform that users can share their own experiences.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">5.4.0 / 2018-12-14 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li>feat(schematype): add <code>SchemaType.get()</code>, custom getters across all instances of a schematype #6912</li>
<li>feat(schematype): add <code>SchemaType.cast()</code>, configure casting for individual schematypes #7045</li>
<li>feat(schematype): add <code>SchemaType.checkRequired()</code>, configure what values pass <code>required</code> check for a schematype #7186 #7150</li>
<li>feat(model): add <code>Model.findOneAndReplace()</code> #7162</li>
<li>feat(model): add <code>Model.events</code> emitter that emits all <code>error</code>'s that occur with a given model #7125</li>
<li>feat(populate): add <code>count</code> option to populate virtuals, support returning # of populated docs instead of docs themselves #4469</li>
<li>feat(aggregate): add <code>.catch()</code> helper to make aggregations full thenables #7267</li>
<li>feat(query): add hooks for <code>deleteOne()</code> and <code>deleteMany()</code> #7195</li>
<li>feat(document): add hooks for <code>updateOne()</code> #7133</li>
<li>feat(query): add <code>Query::map()</code> for synchronously transforming results before post middleware runs #7142</li>
<li>feat(schema): support passing an array of objects or schemas to <code>Schema</code> constructor #7218</li>
<li>feat(populate): add <code>clone</code> option to ensure multiple docs don't share the same populated doc #3258</li>
<li>feat(query): add <code>Query::maxTimeMS()</code> helper #7254</li>
<li>fix(query): deprecate broken <code>Aggregate::addCursorFlag()</code> #7120</li>
<li>docs(populate): fix incorrect example #7335 <a href="https://github.com/zcfan">zcfan</a></li>
<li>docs(middleware): add <code>findOneAndDelete</code> to middleware list #7327 <a href="https://github.com/danielkesselberg">danielkesselberg</a></li>
</ul>
<h1>5.3.16 / 2018-12-11 </h1>
<ul>
<li>fix(document): handle <code>__proto__</code> in queries #7290</li>
<li>fix(document): use Array.isArray() instead of checking constructor name for arrays #7290</li>
<li>docs(populate): add section about what happens when no document matches #7279</li>
<li>fix(mongoose): avoid crash on &lsquo;import mongoose, {Schema} from 'mongoose&rsquo;` #5648</li>
</ul>
<h1>5.3.15 / 2018-12-05 </h1>
<ul>
<li>fix(query): handle <code>orFail()</code> with <code>findOneAndUpdate()</code> and <code>findOneAndDelete()</code> #7297 #7280</li>
<li>fix(document): make <code>save()</code> succeed if strict: false with a <code>collection</code> property #7276</li>
<li>fix(document): add <code>flattenMaps</code> option for toObject() #7274</li>
<li>docs(document): document flattenMaps option #7274</li>
<li>fix(populate): support populating individual subdoc path in document array #7273</li>
<li>fix(populate): ensure <code>model</code> option overrides <code>refPath</code> #7273</li>
<li>fix(map): don't call subdoc setters on init #7272</li>
<li>fix(document): use internal get() helper instead of lodash.get to support <code>null</code> projection param #7271</li>
<li>fix(document): continue running validateSync() for all elements in doc array after first error #6746</li>
</ul>
<h1>5.3.14 / 2018-11-27 </h1>
<ul>
<li>docs(api): use <code>openUri()</code> instead of legacy <code>open()</code> #7277 <a href="https://github.com/artemjackson">artemjackson</a></li>
<li>fix(document): don't mark date underneath single nested as modified if setting to string #7264</li>
<li>fix(update): set timestamps on subdocs if not using $set with no overwrite #7261</li>
<li>fix(document): use symbol instead of <code>__parent</code> so user code doesn't conflict #7230</li>
<li>fix(mongoose): allow using <code>mongoose.model()</code> without context, like &lsquo;import {model} from 'mongoose&rsquo;` #3768</li>
</ul>
<h1>5.3.13 / 2018-11-20 </h1>
<ul>
<li>fix: bump mongodb driver -&gt; 3.1.10 #7266</li>
<li>fix(populate): support setting a model as a <code>ref</code> #7253</li>
<li>docs(schematype): add ref() function to document what is a valid <code>ref</code> path in a schematype #7253</li>
<li>fix(array): clean modified subpaths when calling <code>splice()</code> #7249</li>
<li>docs(compatibility): don't show Mongoose 4.11 as compatible with MongoDB 3.6 re: MongoDB's official compatibility table #7248 <a href="https://github.com/a-harrison">a-harrison</a></li>
<li>fix(document): report correct validation error if doc array set to primitive #7242</li>
<li>fix(mongoose): print warning when including server-side lib with jest jsdom environment #7240</li>
</ul>
<h1>5.3.12 / 2018-11-13 </h1>
<ul>
<li>docs(compatibility): don't show Mongoose 4.11 as compatible with MongoDB 3.6 re: MongoDB's official compatibility table #7238 <a href="https://github.com/a-harrison">a-harrison</a></li>
<li>fix(populate): use <code>instanceof</code> rather than class name for comparison #7237 <a href="https://github.com/ivanseidel">ivanseidel</a></li>
<li>docs(api): make options show up as a nested list #7232</li>
<li>fix(document): don't mark array as modified on init if doc array has default #7227</li>
<li>docs(api): link to bulk write result object in <code>bulkWrite()</code> docs #7225</li>
</ul>
<h1>5.3.11 / 2018-11-09 </h1>
<ul>
<li>fix(model): make parent pointers non-enumerable so they don't crash JSON.stringify() #7220</li>
<li>fix(document): allow saving docs with nested props with '.' using <code>checkKeys: false</code> #7144</li>
<li>docs(lambda): use async/await with lambda example #7019</li>
</ul>
<h1>5.3.10 / 2018-11-06 </h1>
<ul>
<li>fix(discriminator): support reusing a schema for multiple discriminators #7200</li>
<li>fix(cursor): handle <code>lean(false)</code> correctly with query cursors #7197</li>
<li>fix(document): avoid manual populate if <code>ref</code> not set #7193</li>
<li>fix(schema): handle schema without <code>.base</code> for browser build #7170</li>
<li>docs: add further reading section</li>
</ul>
<h1>5.3.9 / 2018-11-02 </h1>
<ul>
<li>fix: upgrade bson dep -&gt; 1.1.0 to match mongodb-core #7213 <a href="https://github.com/NewEraCracker">NewEraCracker</a></li>
<li>docs(api): fix broken anchor link #7210 <a href="https://github.com/gfranco93">gfranco93</a></li>
<li>fix: don't set parent timestamps because a child has timestamps set to false #7203 #7202 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(document): run setter only once when doing <code>.set()</code> underneath a single nested subdoc #7196</li>
<li>fix(document): surface errors in subdoc pre validate #7187</li>
<li>fix(query): run default functions after hydrating the loaded document #7182</li>
<li>fix(query): handle strictQuery: 'throw' with nested path correctly #7178</li>
<li>fix(update): update timestamps on replaceOne() #7152</li>
<li>docs(transactions): add example of aborting a transaction #7113</li>
</ul>
<h1>5.3.8 / 2018-10-30 </h1>
<ul>
<li>fix: bump mongodb driver -&gt; 3.1.8 to fix connecting to +srv uri with no credentials #7191 #6881 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(document): sets defaults correctly in child docs with projection #7159</li>
<li>fix(mongoose): handle setting custom type on a separate mongoose global #7158</li>
<li>fix: add unnecessary files to npmignore #7157</li>
<li>fix(model): set session when creating new subdoc #7104</li>
</ul>
<h1>5.3.7 / 2018-10-26 </h1>
<ul>
<li>fix(browser): fix buffer usage in browser build #7184 #7173 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(document): make depopulate() work on populate virtuals and unpopulated docs #7180 #6075 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(document): only pass properties as 2nd arg to custom validator if <code>propsParameter</code> set #7145</li>
<li>docs(schematypes): add note about nested paths with <code>type</code> getting converted to mixed #7143</li>
<li>fix(update): run update validators on nested doc when $set on an array #7135</li>
<li>fix(update): copy exact errors from array subdoc validation into top-level update validator error #7135</li>
</ul>
<h1>5.3.6 / 2018-10-23 </h1>
<ul>
<li>fix(cursor): fix undefined transforms error</li>
</ul>
<h1>5.3.5 / 2018-10-22 </h1>
<ul>
<li>fix(model): make sure versionKey on <code>replaceOne()</code> always gets set at top level to prevent cast errors #7138</li>
<li>fix(cursor): handle non-boolean lean option in <code>eachAsync()</code> #7137</li>
<li>fix(update): correct cast update that overwrites a map #7111</li>
<li>fix(schema): handle arrays of mixed correctly #7109</li>
<li>fix(query): use correct path when getting schema for child timestamp update #7106</li>
<li>fix(document): make <code>$session()</code> propagate sessions to child docs #7104</li>
<li>fix(document): handle user setting &lsquo;schema.options.strict = 'throw&rsquo;` #7103</li>
<li>fix(types): use core Node.js buffer prototype instead of safe-buffer because safe-buffer is broken for Node.js 4.x #7102</li>
<li>fix(document): handle setting single doc with refPath to document #7070</li>
<li>fix(model): handle array filters when updating timestamps for subdocs #7032</li>
</ul>
<h1>5.3.4 / 2018-10-15 </h1>
<ul>
<li>fix(schema): make <code>add()</code> and <code>remove()</code> return the schema instance #7131 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(query): don't require passing model to <code>cast()</code> #7118</li>
<li>fix: support <code>useFindAndModify</code> as a connection-level option #7110 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(populate): handle plus path projection with virtual populate #7050</li>
<li>fix(schema): allow using ObjectId type as schema path type #7049</li>
<li>docs(schematypes): elaborate on how schematypes relate to types #7049</li>
<li>docs(deprecations): add note about gridstore deprecation #6922</li>
<li>docs(guide): add storeSubdocValidationError option to guide #6802</li>
</ul>
<h1>5.3.3 / 2018-10-12 </h1>
<ul>
<li>fix(document): enable storing mongoose validation error in MongoDB by removing <code>$isValidatorError</code> property #7127</li>
<li>docs(api): clarify that aggregate triggers aggregate middleware #7126 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(connection): handle Model.init() when an index exists on schema + autoCreate == true #7122 <a href="https://github.com/jesstelford">jesstelford</a></li>
<li>docs(middleware): explain how to switch between document and query hooks for <code>remove()</code> #7093</li>
<li>docs(api): clean up encoding issues in SchemaType.prototype.validate docs #7091</li>
<li>docs(schema): add schema types to api docs and update links on schematypes page #7080 #7076 <a href="https://github.com/lineus">lineus</a></li>
<li>docs(model): expand model constructor docs with examples and <code>fields</code> param #7077</li>
<li>docs(aggregate): remove incorrect description of noCursorTimeout and add description of aggregate options #7056</li>
<li>docs: re-add array type to API docs #7027</li>
<li>docs(connections): add note about <code>members.host</code> errors due to bad host names in replica set #7006</li>
</ul>
<h1>5.3.2 / 2018-10-07 </h1>
<ul>
<li>fix(query): make sure to return correct result from <code>orFail()</code> #7101 #7099 <a href="https://github.com/gsandorx">gsandorx</a></li>
<li>fix(schema): handle <code>{ timestamps: false }</code> correctly #7088 #7074 <a href="https://github.com/lineus">lineus</a></li>
<li>docs: fix markdown in options.useCreateIndex documentation #7085 <a href="https://github.com/Cyral">Cyral</a></li>
<li>docs(schema): correct field name in timestamps example #7082 <a href="https://github.com/kizmo04">kizmo04</a></li>
<li>docs(migrating_to_5): correct markdown syntax #7078 <a href="https://github.com/gwuah">gwuah</a></li>
<li>fix(connection): add useFindAndModify option in connect #7059 <a href="https://github.com/NormanPerrin">NormanPerrin</a></li>
<li>fix(document): dont mark single nested path as modified if setting to the same value #7048</li>
<li>fix(populate): use WeakMap to track lean populate models rather than leanPopulateSymbol #7026</li>
<li>fix(mongoose): avoid unhandled rejection when <code>mongoose.connect()</code> errors with a callback #6997</li>
<li>fix(mongoose): isolate Schema.Types between custom Mongoose instances #6933</li>
</ul>
<h1>5.3.1 / 2018-10-02 </h1>
<ul>
<li>fix(ChangeStream): expose driver's <code>close()</code> function #7068 #7022 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(model): avoid printing warning if <code>_id</code> index is set to "hashed" #7053</li>
<li>fix(populate): handle nested populate underneath lean array correctly #7052</li>
<li>fix(update): make timestamps not crash on a null or undefined update #7041</li>
<li>docs(schematypes+validation): clean up links from validation docs to schematypes docs #7040</li>
<li>fix(model): apply timestamps to nested docs in bulkWrite() #7032</li>
<li>docs(populate): rewrite refPath docs to be simpler and more direct #7013</li>
<li>docs(faq): explain why destructuring imports are not supported in FAQ #7009</li>
</ul>
<h1>5.3.0 / 2018-09-28 </h1>
<ul>
<li>feat(mongoose): support &lsquo;mongoose.set('debug&rsquo;, WritableStream)` so you can pipe debug to stderr, file, or network #7018</li>
<li>feat(query): add useNestedStrict option #6973 #5144 <a href="https://github.com/lineus">lineus</a></li>
<li>feat(query): add getPopulatedPaths helper to Query.prototype #6970 #6677 <a href="https://github.com/lineus">lineus</a></li>
<li>feat(model): add <code>createCollection()</code> helper to make transactions easier #6948 #6711 <a href="https://github.com/Fonger">Fonger</a></li>
<li>feat(schema): add ability to do <code>schema.add(otherSchema)</code> to merge hooks, virtuals, etc. #6897</li>
<li>feat(query): add <code>orFail()</code> helper that throws an error if no documents match <code>filter</code> #6841</li>
<li>feat(mongoose): support global toObject and toJSON #6815</li>
<li>feat(connection): add deleteModel() to remove a model from a connection #6813</li>
<li>feat(mongoose): add top-level mongoose.ObjectId, mongoose.Decimal128 for easier schema declarations #6760</li>
<li>feat(aggregate+query): support for/await/of (async iterators) #6737</li>
<li>feat(mongoose): add global <code>now()</code> function that you can stub for testing timestamps #6728</li>
<li>feat(schema): support <code>schema.pre(RegExp, fn)</code> and <code>schema.post(RegExp, fn)</code> #6680</li>
<li>docs(query): add better docs for the <code>mongooseOptions()</code> function #6677</li>
<li>feat(mongoose): add support for global strict object #6858</li>
<li>feat(schema+mongoose): add autoCreate option to automatically create collections #6489</li>
<li>feat(update): update timestamps on nested subdocs when using <code>$set</code> #4412</li>
<li>feat(query+schema): add query <code>remove</code> hook and ability to switch between query <code>remove</code> and document <code>remove</code> middleware #3054</li>
</ul>
<h1>5.2.18 / 2018-09-27 </h1>
<ul>
<li>docs(migrating_to_5): add note about overwriting filter properties #7030</li>
<li>fix(query): correctly handle &lsquo;select(&rsquo;+c')` if c is not in schema #7017</li>
<li>fix(document): check path exists before checking for required #6974</li>
<li>fix(document): retain user-defined key order on initial set with nested docs #6944</li>
<li>fix(populate): handle multiple localFields + foreignFields using <code>localField: function() {}</code> syntax #5704</li>
</ul>
<h1>5.2.17 / 2018-09-21 </h1>
<ul>
<li>docs(guide): clarify that Mongoose only increments versionKey on <code>save()</code> and add a workaround for <code>findOneAndUpdate()</code> #7038</li>
<li>fix(model): correctly handle <code>createIndex</code> option to <code>ensureIndexes()</code> #7036 #6922 <a href="https://github.com/lineus">lineus</a></li>
<li>docs(migrating_to_5): add a note about changing debug output from stderr to stdout #7034 #7018 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(query): add <code>setUpdate()</code> to allow overwriting update without changing op #7024 #7012 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(update): find top-level version key even if there are <code>$</code> operators in the update #7003</li>
<li>docs(model+query): explain which operators <code>count()</code> supports that <code>countDocuments()</code> doesn't #6911</li>
</ul>
<h1>5.2.16 / 2018-09-19 </h1>
<ul>
<li>fix(index): use dynamic require only when needed for better webpack support #7014 #7010 <a href="https://github.com/jaydp17">jaydp17</a></li>
<li>fix(map): handle arrays of mixed maps #6995</li>
<li>fix(populate): leave justOne as null if populating underneath a Mixed type #6985</li>
<li>fix(populate): add justOne option to allow overriding any bugs with justOne #6985</li>
<li>fix(query): add option to skip adding timestamps to an update #6980</li>
<li>docs(model+schematype): improve docs about background indexes and init() #6966</li>
<li>fix: bump mongodb -&gt; 3.1.6 to allow connecting to srv url without credentials #6955 #6881 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(connection): allow specifying <code>useCreateIndex</code> at the connection level, overrides global-level #6922</li>
<li>fix(schema): throw a helpful error if setting <code>ref</code> to an invalid value #6915</li>
</ul>
<h1>5.2.15 / 2018-09-15 </h1>
<ul>
<li>fix(populate): handle virtual justOne correctly if it isn't set #6988</li>
<li>fix(populate): consistently use lowercase <code>model</code> instead of <code>Model</code> so double-populating works with existing docs #6978</li>
<li>fix(model): allow calling <code>Model.init()</code> again after calling <code>dropDatabase()</code> #6967</li>
<li>fix(populate): find correct justOne when double-populating underneath an array #6798</li>
<li>docs(webpack): make webpack docs use es2015 preset for correct libs and use acorn to test output is valid ES5 #6740</li>
<li>fix(populate): add selectPopulatedPaths option to opt out of auto-adding <code>populate()</code>-ed fields to <code>select()</code> #6546</li>
<li>fix(model): set timestamps on bulkWrite <code>insertOne</code> and <code>replaceOne</code> #5708</li>
</ul>
<h1>5.2.14 / 2018-09-09 </h1>
<ul>
<li>docs: fix wording on promise docs to not imply queries only return promises #6983 #6982 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(map): throw TypeError if keys are not string #6956</li>
<li>fix(document): ensure you can <code>validate()</code> a child doc #6931</li>
<li>fix(populate): avoid cast error if refPath points to localFields with 2 different types #6870</li>
<li>fix(populate): handle populating already-populated paths #6839</li>
<li>fix(schematype): make ObjectIds handle refPaths when checking required #6714</li>
<li>fix(model): set timestamps on bulkWrite() updates #5708</li>
</ul>
<h1>5.2.13 / 2018-09-04 </h1>
<ul>
<li>fix(map): throw TypeError if keys are not string #6968 <a href="https://github.com/Fonger">Fonger</a></li>
<li>fix(update): make array op casting work with strict:false and {} #6962 #6952 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(document): add doc.deleteOne(), doc.updateOne(), doc.replaceOne() re: deprecation warnings #6959 #6940 <a href="https://github.com/lineus">lineus</a></li>
<li>docs(faq+schematypes): add note about map keys needing to be strings #6957 #6956 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(schematype): remove unused if statement #6950 #6949 <a href="https://github.com/cacothi">cacothi</a></li>
<li>docs: add /docs/deprecations.html for dealing with MongoDB driver deprecation warnings #6922</li>
<li>fix(populate): handle refPath where first element in array has no refPath #6913</li>
<li>fix(mongoose): allow setting useCreateIndex option after creating a model but before initial connection succeeds #6890</li>
<li>fix(updateValidators): ensure $pull validators always get an array #6889</li>
</ul>
<h1>5.2.12 / 2018-08-30 </h1>
<ul>
<li>fix(document): disallow setting <code>constructor</code> and <code>prototype</code> if strict mode false</li>
</ul>
<h1>4.13.17 / 2018-08-30 </h1>
<ul>
<li>fix(document): disallow setting <code>constructor</code> and <code>prototype</code> if strict mode false</li>
</ul>
<h1>5.2.11 / 2018-08-30 </h1>
<ul>
<li>fix(document): disallow setting <b>proto</b> if strict mode false</li>
<li>fix(document): run document middleware on docs embedded in maps #6945 #6938 <a href="https://github.com/Fonger">Fonger</a></li>
<li>fix(query): make castForQuery return a CastError #6943 #6927 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(query): use correct <code>this</code> scope when casting query with legacy 2dsphere pairs defined in schema #6939 #6937 <a href="https://github.com/Fonger">Fonger</a></li>
<li>fix(document): avoid crash when calling <code>get()</code> on deeply nested subdocs #6929 #6925 <a href="https://github.com/jakemccloskey">jakemccloskey</a></li>
<li>fix(plugins): make saveSubdocs execute child post save hooks <em>after</em> the actual save #6926</li>
<li>docs: add dbName to api docs for .connect() #6923 <a href="https://github.com/p722">p722</a></li>
<li>fix(populate): convert to array when schema specifies array, even if doc doesn't have an array #6908</li>
<li>fix(populate): handle <code>justOne</code> virtual populate underneath array #6867</li>
<li>fix(model): dont set versionKey on upsert if it is already <code>$set</code> #5973</li>
</ul>
<h1>4.13.16 / 2018-08-30 </h1>
<ul>
<li>fix(document): disallow setting <b>proto</b> if strict mode false</li>
<li>feat(error): backport adding modified paths to VersionError #6928 <a href="https://github.com/freewil">freewil</a></li>
</ul>
<h1>5.2.10 / 2018-08-27 </h1>
<ul>
<li>fix: bump mongodb driver -&gt; 3.1.4 #6920 #6903 #6884 #6799 #6741 <a href="https://github.com/Fonger">Fonger</a></li>
<li>fix(model): track <code>session</code> option for <code>save()</code> as the document's <code>$session()</code> #6909</li>
<li>fix(query): add Query.getOptions() helper #6907 <a href="https://github.com/Fonger">Fonger</a></li>
<li>fix(document): ensure array atomics get cleared after save() #6900</li>
<li>fix(aggregate): add missing redact and readConcern helpers #6895 <a href="https://github.com/Fonger">Fonger</a></li>
<li>fix: add global option &lsquo;mongoose.set('useCreateIndex&rsquo;, true)<code>to avoid ensureIndex deprecation warning #6890</code></li>
<li><code>fix(query): use</code>projection<code>option to avoid deprecation warnings #6888 #6880 [Fonger](<a href="https://github.com/Fonger">https://github.com/Fonger</a>)</code></li>
<li><code>fix(query): use</code>findOneAndReplace()<code>internally if using</code>overwrite: true<code>with</code>findOneAndUpdate()` #6888 <a href="https://github.com/Fonger">Fonger</a></li>
<li>fix(document): ensure required cache gets cleared correctly between subsequent saves #6892</li>
<li>fix(aggregate): support session chaining correctly #6886 #6885 <a href="https://github.com/Fonger">Fonger</a></li>
<li>fix(query): use <code>projection</code> instead of <code>fields</code> internally for <code>find()</code> and <code>findOne()</code> to avoid deprecation warning #6880</li>
<li>fix(populate): add <code>getters</code> option to opt in to calling getters on populate #6844</li>
</ul>
<h1>5.2.9 / 2018-08-17 </h1>
<ul>
<li>fix(document): correctly propagate write concern options in save() #6877 <a href="https://github.com/Fonger">Fonger</a></li>
<li>fix: upgrade mongodb driver -&gt; 3.1.3 for numerous fixes #6869 #6843 #6692 #6670 <a href="https://github.com/simllll">simllll</a></li>
<li>fix: correct <code>this</code> scope of default functions for DocumentArray and Array #6868 #6840 <a href="https://github.com/Fonger">Fonger</a></li>
<li>fix(types): support casting JSON form of buffers #6866 #6863 <a href="https://github.com/Fonger">Fonger</a></li>
<li>fix(query): get global runValidators option correctly #6865 #6578</li>
<li>fix(query): add Query.prototype.setQuery() analogous to <code>getQuery()</code> #6855 #6854</li>
<li>docs(connections): add note about the <code>family</code> option for IPv4 vs IPv6 and add port to example URIs #6784</li>
<li>fix(query): get global runValidators option correctly #6578</li>
</ul>
<h1>4.13.15 / 2018-08-14 </h1>
<ul>
<li>fix(mongoose): add global <code>usePushEach</code> option for easier Mongoose 4.x + MongoDB 3.6 #6858</li>
<li>chore: fix flakey tests for 4.x #6853 <a href="https://github.com/Fonger">Fonger</a></li>
<li>feat(error): add version number to VersionError #6852 <a href="https://github.com/freewil">freewil</a></li>
</ul>
<h1>5.2.8 / 2018-08-13 </h1>
<ul>
<li>docs: update <code>execPopulate()</code> code example #6851 <a href="https://github.com/WJakub">WJakub</a></li>
<li>fix(document): allow passing callback to <code>execPopulate()</code> #6851</li>
<li>fix(populate): populate with undefined fields without error #6848 #6845 <a href="https://github.com/Fonger">Fonger</a></li>
<li>docs(migrating_to_5): Add <code>objectIdGetter</code> option docs #6842 <a href="https://github.com/jwalton">jwalton</a></li>
<li>chore: run lint in parallel and only on Node.js v10 #6836 <a href="https://github.com/Fonger">Fonger</a></li>
<li>fix(populate): throw helpful error if refPath excluded in query #6834</li>
<li>docs(migrating_to_5): add note about removing runSettersOnQuery #6832</li>
<li>fix: use safe-buffer to avoid buffer deprecation errors in Node.js 10 #6829 <a href="https://github.com/Fonger">Fonger</a></li>
<li>docs(query): fix broken links #6828 <a href="https://github.com/yaynick">yaynick</a></li>
<li>docs(defaults): clarify that defaults only run on undefined #6827</li>
<li>chore: fix flakey tests #6824 <a href="https://github.com/Fonger">Fonger</a></li>
<li>docs: fix custom inspect function deprecation warning in Node.js 10 #6821 <a href="https://github.com/yelworc">yelworc</a></li>
<li>fix(document): ensure subdocs get set to init state after save() so validators can run again #6818</li>
<li>fix(query): make sure embedded query casting always throws a CastError #6803</li>
<li>fix(document): ensure <code>required</code> function only gets called once when validating #6801</li>
<li>docs(connections): note that you must specify port if using <code>useNewUrlParser: true</code> #6789</li>
<li>fix(populate): support <code>options.match</code> in virtual populate schema definition #6787</li>
<li>fix(update): strip out virtuals from updates if strict: 'throw' rather than returning an error #6731</li>
</ul>
<h1>5.2.7 / 2018-08-06 </h1>
<ul>
<li>fix(model): check <code>expireAfterSeconds</code> option when diffing indexes in syncIndexes() #6820 #6819 <a href="https://github.com/christopherhex">christopherhex</a></li>
<li>chore: fix some common test flakes in travis #6816 <a href="https://github.com/Fonger">Fonger</a></li>
<li>chore: bump eslint and webpack to avoid bad versions of eslint-scope #6814</li>
<li>test(model): add delay to session tests to improve pass rate #6811 <a href="https://github.com/Fonger">Fonger</a></li>
<li>fix(model): support options in <code>deleteMany</code> #6810 <a href="https://github.com/Fonger">Fonger</a></li>
<li>fix(query): don't use $each when pushing an array into an array #6809 <a href="https://github.com/lineus">lineus</a></li>
<li>chore: bump mquery so eslint isn't a prod dependency #6800</li>
<li>fix(populate): correctly get schema type when calling <code>populate()</code> on already populated path #6798</li>
<li>fix(populate): propagate readConcern options in populate from parent query #6792 #6785 <a href="https://github.com/Fonger">Fonger</a></li>
<li>docs(connection): add description of useNewUrlParser option #6789</li>
<li>fix(query): make select('+path') a no-op if no select prop in schema #6785</li>
<li>docs(schematype+validation): document using function syntax for custom validator message #6772</li>
<li>fix(update): throw CastError if updating with <code>$inc: null</code> #6770</li>
<li>fix(connection): throw helpful error when calling <code>createConnection(undefined)</code> #6763</li>
</ul>
<h1>5.2.6 / 2018-07-30 </h1>
<ul>
<li>fix(document): don't double-call deeply nested custom getters when using <code>get()</code> #6779 #6637</li>
<li>fix(query): upgrade mquery for readConcern() helper #6777</li>
<li>docs(schematypes): clean up typos #6773 <a href="https://github.com/sajadtorkamani">sajadtorkamani</a></li>
<li>refactor(browser): fix webpack warnings #6771 #6705</li>
<li>fix(populate): make error reported when no <code>localField</code> specified catchable #6767</li>
<li>docs(connection): use correct form in createConnection example #6766 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(connection): throw helpful error when using legacy <code>mongoose.connect()</code> syntax #6756</li>
<li>fix(document): handle overwriting <code>$session</code> in <code>execPopulate()</code> #6754</li>
<li>fix(query): propagate top-level session down to <code>populate()</code> #6754</li>
<li>fix(aggregate): add <code>session()</code> helper for consistency with query api #6752</li>
<li>fix(map): avoid infinite recursion when update overwrites a map #6750</li>
<li>fix(model): be consistent about passing noop callback to mongoose.model() <code>init()</code> as well as db.model() #6707</li>
</ul>
<h1>5.2.5 / 2018-07-23 </h1>
<ul>
<li>fix(boolean): expose <code>convertToTrue</code> and <code>convertToFalse</code> for custom boolean casting #6758</li>
<li>docs(schematypes): add note about what values are converted to booleans #6758</li>
<li>fix(document): fix(document): report castError when setting single nested doc to array #6753</li>
<li>docs: prefix mongoose.Schema call with new operator #6751 <a href="https://github.com/sajadtorkamani">sajadtorkamani</a></li>
<li>docs(query): add examples and links to schema writeConcern option for writeConcern helpers #6748</li>
<li>docs(middleware): clarify that init middleware is sync #6747</li>
<li>perf(model): create error rather than modifying stack for source map perf #6735</li>
<li>fix(model): throw helpful error when passing object to aggregate() #6732</li>
<li>fix(model): pass Model instance as context to applyGetters when calling getters for virtual populate #6726 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(documentarray): remove <code>isNew</code> and <code>save</code> listeners on CastError because otherwise they never get removed #6723</li>
<li>docs(model+query): clarify when to use <code>countDocuments()</code> vs <code>estimatedDocumentCount()</code> #6713</li>
<li>fix(populate): correctly set virtual nestedSchemaPath when calling populate() multiple times #6644</li>
<li>docs(connections): add note about the <code>family</code> option for IPv4 vs IPv6 and add port to example URIs #6566</li>
</ul>
<h1>5.2.4 / 2018-07-16 </h1>
<ul>
<li>docs: Model.insertMany rawResult option in api docs #6724 <a href="https://github.com/lineus">lineus</a></li>
<li>docs: fix typo on migrating to 5 guide #6722 <a href="https://github.com/iagowp">iagowp</a></li>
<li>docs: update doc about keepalive #6719 #6718 <a href="https://github.com/simllll">simllll</a></li>
<li>fix: ensure debug mode doesn't crash with sessions #6712</li>
<li>fix(document): report castError when setting single nested doc to primitive value #6710</li>
<li>fix(connection): throw helpful error if using <code>new db.model(foo)(bar)</code> #6698</li>
<li>fix(model): throw readable error with better stack trace when non-cb passed to $wrapCallback() #6640</li>
</ul>
<h1>5.2.3 / 2018-07-11 </h1>
<ul>
<li>fix(populate): if a getter is defined on the localField, use it when populating #6702 #6618 <a href="https://github.com/lineus">lineus</a></li>
<li>docs(schema): add example of nested aliases #6671</li>
<li>fix(query): add <code>session()</code> function to queries to avoid positional argument mistakes #6663</li>
<li>docs(transactions): use new session() helper to make positional args less confusing #6663</li>
<li>fix(query+model+schema): add support for <code>writeConcern</code> option and writeConcern helpers #6620</li>
<li>docs(guide): add <code>writeConcern</code> option and re-add description for <code>safe</code> option #6620</li>
<li>docs(schema): fix broken API links #6619</li>
<li>docs(connections): add information re: socketTimeoutMS and connectTimeoutMS #4789</li>
</ul>
<h1>5.2.2 / 2018-07-08 </h1>
<ul>
<li>fix(model+query): add missing estimatedDocumentCount() function #6697</li>
<li>docs(faq): improve array-defaults section #6695 <a href="https://github.com/lineus">lineus</a></li>
<li>docs(model): fix countDocuments() docs, bad copy/paste from count() docs #6694 #6643</li>
<li>fix(connection): add <code>startSession()</code> helper to connection and mongoose global #6689</li>
<li>fix: upgrade mongodb driver -&gt; 3.1.1 for countDocuments() fix #6688 #6666</li>
<li>docs(compatibility): add MongoDB 4 range #6685</li>
<li>fix(populate): add ability to define refPath as a function #6683 <a href="https://github.com/lineus">lineus</a></li>
<li>docs: add rudimentary transactions guide #6672</li>
<li>fix(update): make setDefaultsOnInsert handle nested subdoc updates with deeply nested defaults #6665</li>
<li>docs: use latest acquit-ignore to handle examples that start with acquit:ignore:start #6657</li>
<li>fix(validation): format <code>properties.message</code> as well as <code>message</code> #6621</li>
</ul>
<h1>5.2.1 / 2018-07-03 </h1>
<ul>
<li>fix(connection): allow setting the mongodb driver's useNewUrlParser option, default to false #6656 #6648 #6647</li>
<li>fix(model): only warn on custom _id index if index only has _id key #6650</li>
</ul>
<h1>5.2.0 / 2018-07-02 </h1>
<ul>
<li>feat(model): add <code>countDocuments()</code> #6643</li>
<li>feat(model): make ensureIndexes() fail if specifying an index on _id #6605</li>
<li>feat(mongoose): add <code>objectIdGetter</code> option to remove ObjectId.prototype._id #6588</li>
<li>feat: upgrade mongodb -&gt; 3.1.0 for full MongoDB 4.0 support #6579</li>
<li>feat(query): support <code>runValidators</code> as a global option #6578</li>
<li>perf(schema): use WeakMap instead of array for schema stack #6503</li>
<li>feat(model): decorate unique discriminator indexes with partialFilterExpressions #6347</li>
<li>feat(model): add <code>syncIndexes()</code>, drops indexes that aren't in schema #6281</li>
<li>feat(document): add default getter/setter if virtual doesn't have one #6262</li>
<li>feat(discriminator): support discriminators on nested doc arrays #6202</li>
<li>feat(update): add <code>Query.prototype.set()</code> #5770</li>
</ul>
<h1>5.1.8 / 2018-07-02 </h1>
<ul>
<li>fix: don't throw TypeError if calling save() after original save() failed with push() #6638 <a href="https://github.com/evanhenke">evanhenke</a></li>
<li>fix(query): add explain() helper and don't hydrate explain output #6625</li>
<li>docs(query): fix <code>setOptions()</code> lists #6624</li>
<li>docs: add geojson docs #6607</li>
<li>fix: bump mongodb -&gt; 3.0.11 to avoid cyclic dependency error with retryWrites #6109</li>
</ul>
<h1>5.1.7 / 2018-06-26 </h1>
<ul>
<li>docs: add npm badge to readme #6623 <a href="https://github.com/VFedyk">VFedyk</a></li>
<li>fix(document): don't throw parallel save error if post save hooks in parallel #6614 #6611 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(populate): allow dynamic ref to handle &gt;1 model getModelsMapForPopulate #6613 #6612 <a href="https://github.com/jimmytsao">jimmytsao</a></li>
<li>fix(document): handle <code>push()</code> on triple nested document array #6602</li>
<li>docs(validation): improve update validator doc headers #6577 <a href="https://github.com/joeytwiddle">joeytwiddle</a></li>
<li>fix(document): handle document arrays in <code>modifiedPaths()</code> with includeChildren option #5904</li>
</ul>
<h1>5.1.6 / 2018-06-19 </h1>
<ul>
<li>fix: upgrade mongodb -&gt; 3.0.10</li>
<li>docs(model+document): clarify that <code>save()</code> returns <code>undefined</code> if passed a callback #6604 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(schema): apply alias when adding fields with .add() #6593</li>
<li>docs: add full list of guides and streamline nav #6592</li>
<li>docs(model): add <code>projection</code> option to <code>findOneAndUpdate()</code> #6590 <a href="https://github.com/lineus">lineus</a></li>
<li>docs: supportJSDoc declaration #6584</li>
<li>fix(query): use boolean casting logic for $exists #6581</li>
<li>fix(query): cast all $text options to correct values #6581</li>
<li>fix(model): add support synchronous pre hooks for <code>createModel</code> #6552 <a href="https://github.com/profbiss">profbiss</a></li>
<li>docs: add note about the <code>applyPluginsToDiscriminators</code> option #4965</li>
</ul>
<h1>5.1.5 / 2018-06-11 </h1>
<ul>
<li>docs(guide): rework query helper example #6575 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(populate): handle virtual populate with embedded discriminator under single nested subdoc #6571</li>
<li>docs: add string option to projections that call query select #6563 <a href="https://github.com/lineus">lineus</a></li>
<li>style: use ES6 in collection.js #6560 <a href="https://github.com/l33ds">l33ds</a></li>
<li>fix(populate): add virtual ref function ability getModelsMapForPopulate #6559 #6554 <a href="https://github.com/lineus">lineus</a></li>
<li>docs(queries): fix link #6557 <a href="https://github.com/sun1x">sun1x</a></li>
<li>fix(schema): rename indexes -&gt; getIndexes to avoid webpack duplicate declaration #6547</li>
<li>fix(document): support <code>toString()</code> as custom method #6538</li>
<li>docs: add  for instance methods to be more compliant with JSDoc #6516 <a href="https://github.com/treble-snake">treble-snake</a></li>
<li>fix(populate): avoid converting to map when using mongoose-deep-populate #6460</li>
<li>docs(browser): create new browser docs page #6061</li>
</ul>
<h1>5.1.4 / 2018-06-04 </h1>
<ul>
<li>docs(faq): add hr tags for parallel save error #6550 <a href="https://github.com/lineus">lineus</a></li>
<li>docs(connection): fix broken link #6545 <a href="https://github.com/iblamefish">iblamefish</a></li>
<li>fix(populate): honor subpopulate options #6539 #6528 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(populate): allow population of refpath under array #6537 #6509 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(query): dont treat $set the same as the other ops in update casting #6535 <a href="https://github.com/lineus">lineus</a></li>
<li>fix: bump async -&gt; 2.6.1 #6534 #6505 <a href="https://github.com/lineus">lineus</a></li>
<li>fix: support using a function as validation error message #6530 <a href="https://github.com/lucandrade">lucandrade</a></li>
<li>fix(populate): propagate <code>lean()</code> down to subpopulate #6498 <a href="https://github.com/AbdelrahmanHafez">AbdelrahmanHafez</a></li>
<li>docs(lambda): add info on what happens if database does down between lambda function calls #6409</li>
<li>fix(update): allow updating embedded discriminator path if discriminator key is in filter #5841</li>
</ul>
<h1>5.1.3 / 2018-05-28 </h1>
<ul>
<li>fix(document): support set() on path underneath array embedded discriminator #6526</li>
<li>chore: update lodash and nsp dev dependencies #6514 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>fix(document): throw readable error when saving the same doc instance more than once in parallel #6511 #6456 #4064 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(populate): set correct nestedSchemaPath for virtual underneath embedded discriminator #6501 #6487 <a href="https://github.com/lineus">lineus</a></li>
<li>docs(query): add section on promises and warning about not mixing promises and callbacks #6495</li>
<li>docs(connection): add concrete example of connecting to multiple hosts #6492 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(populate): handle virtual populate under single nested doc under embedded discriminator #6488</li>
<li>fix(schema): collect indexes from embedded discriminators for autoIndex build #6485</li>
<li>fix(document): handle <code>doc.set()</code> underneath embedded discriminator #6482</li>
<li>fix(document): handle set() on path under embedded discriminator with object syntax #6482</li>
<li>fix(document): handle setting nested property to object with only non-schema properties #6436</li>
</ul>
<h1>4.13.14 / 2018-05-25 </h1>
<ul>
<li>fix(model): handle retainKeyOrder option in findOneAndUpdate() #6484</li>
</ul>
<h1>5.1.2 / 2018-05-21 </h1>
<ul>
<li>docs(guide): add missing SchemaTypes #6490 <a href="https://github.com/distancesprinter">distancesprinter</a></li>
<li>fix(map): make MongooseMap.toJSON return a serialized object #6486 #6478 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(query): make CustomQuery inherit from model.Query for hooks #6483 #6455 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(document): prevent default falses from being skipped by $__dirty #6481 #6477 <a href="https://github.com/lineus">lineus</a></li>
<li>docs(connection): document <code>useDb()</code> #6480</li>
<li>fix(model): skip redundant clone in insertMany #6479 <a href="https://github.com/d1manson">d1manson</a></li>
<li>fix(aggregate): let replaceRoot accept objects as well as strings #6475 #6474 <a href="https://github.com/lineus">lineus</a></li>
<li>docs(model): clarify <code>emit()</code> in mapReduce and how map/reduce are run #6465</li>
<li>fix(populate): flatten array to handle multi-level nested <code>refPath</code> #6457</li>
<li>fix(date): cast small numeric strings as years #6444 <a href="https://github.com/AbdelrahmanHafez">AbdelrahmanHafez</a></li>
<li>fix(populate): remove unmatched ids when using virtual populate on already hydrated document #6435</li>
<li>fix(array): use custom array class to avoid clobbered property names #6431</li>
<li>fix(model): handle hooks for custom methods that return promises #6385</li>
</ul>
<h1>4.13.13 / 2018-05-17 </h1>
<ul>
<li>fix(update): stop clobbering $in when casting update #6441 #6339</li>
<li>fix: upgrade async -&gt; 2.6.0 re: security warning</li>
</ul>
<h1>5.1.1 / 2018-05-14 </h1>
<ul>
<li>docs(schema): add notes in api and guide about schema.methods object #6470 #6440 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(error): add modified paths to VersionError #6464 #6433 <a href="https://github.com/paglias">paglias</a></li>
<li>fix(populate): only call populate with full param signature when match is not present #6458 #6451 <a href="https://github.com/lineus">lineus</a></li>
<li>docs: fix geoNear link in migration guide #6450 <a href="https://github.com/kawache">kawache</a></li>
<li>fix(discriminator): throw readable error when <code>create()</code> with a non-existent discriminator key #6434</li>
<li>fix(populate): add <code>retainNullValues</code> option to avoid stripping out null keys #6432</li>
<li>fix(populate): handle populate in embedded discriminators underneath nested paths #6411</li>
<li>docs(model): add change streams and ToC, make terminology more consistent #5888</li>
</ul>
<h1>5.1.0 / 2018-05-10 </h1>
<ul>
<li>feat(ObjectId): add <code>_id</code> getter so you can get a usable id whether or not the path is populated #6415 #6115</li>
<li>feat(model): add Model.startSession() #6362</li>
<li>feat(document): add doc.$session() and set session on doc after query #6362</li>
<li>feat: add Map type that supports arbitrary keys #6287 #681</li>
<li>feat: add <code>cloneSchemas</code> option to mongoose global to opt in to always cloning schemas before use #6274</li>
<li>feat(model): add <code>findOneAndDelete()</code> and <code>findByIdAndDelete()</code> #6164</li>
<li>feat(document): support <code>$ignore()</code> on single nested and array subdocs #6152</li>
<li>feat(document): add warning about calling <code>save()</code> on subdocs #6152</li>
<li>fix(model): make <code>save()</code> use <code>updateOne()</code> instead of <code>update()</code> #6031</li>
<li>feat(error): add version number to VersionError #5966</li>
<li>fix(query): allow <code>[]</code> as a value for <code>$in</code> when casting #5913</li>
<li>fix(document): avoid running validators on single nested paths if only a child path is modified #5885</li>
<li>feat(schema): print warning if method conflicts with mongoose internals #5860</li>
</ul>
<h1>5.0.18 / 2018-05-09 </h1>
<ul>
<li>fix(update): stop clobbering $in when casting update #6441 #6339 <a href="https://github.com/lineus">lineus</a></li>
<li>fix: upgrade mongodb driver -&gt; 3.0.8 to fix session issue #6437 #6357 <a href="https://github.com/simllll">simllll</a></li>
<li>fix: upgrade bson -&gt; 1.0.5 re: <a href="https://snyk.io/vuln/npm:bson:20180225">https://snyk.io/vuln/npm:bson:20180225</a> #6423 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>fix: look for <code>valueOf()</code> when casting to Decimal128 #6419 #6418 <a href="https://github.com/lineus">lineus</a></li>
<li>fix: populate array of objects with space separated paths #6414 <a href="https://github.com/lineus">lineus</a></li>
<li>test: add coverage for <code>mongoose.pluralize()</code> #6412 <a href="https://github.com/FastDeath">FastDeath</a></li>
<li>fix(document): avoid running default functions on init() if path has value #6410</li>
<li>fix(document): allow saving document with <code>null</code> id #6406</li>
<li>fix: prevent casting of populated docs in document.init #6390 <a href="https://github.com/lineus">lineus</a></li>
<li>fix: remove <code>toHexString()</code> helper that was added in 5.0.15 #6359</li>
</ul>
<h1>5.0.17 / 2018-04-30 </h1>
<ul>
<li>docs(migration): certain chars in passwords may cause connection failures #6401 <a href="https://github.com/markstos">markstos</a></li>
<li>fix(document): don't throw when <code>push()</code> on a nested doc array #6398</li>
<li>fix(model): apply hooks to custom methods if specified #6385</li>
<li>fix(schema): support opting out of one timestamp field but not the other for <code>insertMany()</code> #6381</li>
<li>fix(documentarray): handle <code>required: true</code> within documentarray definition #6364</li>
<li>fix(document): ensure <code>isNew</code> is set before default functions run on init #3793</li>
</ul>
<h1>5.0.16 / 2018-04-23 </h1>
<ul>
<li>docs(api): sort api methods based on their string property #6374 <a href="https://github.com/lineus">lineus</a></li>
<li>docs(connection): fix typo in <code>createCollection()</code> #6370 <a href="https://github.com/mattc41190">mattc41190</a></li>
<li>docs(document): remove vestigial reference to <code>numAffected</code> #6367 <a href="https://github.com/ekulabuhov">ekulabuhov</a></li>
<li>docs(schema): fix typo #6366 <a href="https://github.com/dhritzkiv">dhritzkiv</a></li>
<li>docs(schematypes): add missing <code>minlength</code> and <code>maxlength</code> docs #6365 <a href="https://github.com/treble-snake">treble-snake</a></li>
<li>docs(queries): fix formatting #6360 <a href="https://github.com/treble-snake">treble-snake</a></li>
<li>docs(api): add cursors to API docs #6353 #6344 <a href="https://github.com/lineus">lineus</a></li>
<li>docs(aggregate): remove reference to non-existent <code>.select()</code> method #6346</li>
<li>fix(update): handle <code>required</code> array with update validators and $pull #6341</li>
<li>fix(update): avoid setting __v in findOneAndUpdate if it is <code>$set</code> #5973</li>
</ul>
<h1>5.0.15 / 2018-04-16 </h1>
<ul>
<li>fix: add ability for casting from number to decimal128 #6336 #6331 <a href="https://github.com/lineus">lineus</a></li>
<li>docs(middleware): enumerate the ways to error out in a hook #6315</li>
<li>fix(document): respect schema-level depopulate option for toObject() #6313</li>
<li>fix: bump mongodb driver -&gt; 3.0.6 #6310</li>
<li>fix(number): check for <code>valueOf()</code> function to support Decimal.js #6306 #6299 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(query): run array setters on query if input value is an array #6277</li>
<li>fix(versioning): don't require matching version when using array.pull() #6190</li>
<li>fix(document): add <code>toHexString()</code> function so you don't need to check whether a path is populated to get an id #6115</li>
</ul>
<h1>5.0.14 / 2018-04-09 </h1>
<ul>
<li>fix(schema): clone aliases and alternative option syntax correctly</li>
<li>fix(query): call utils.toObject in query.count like in query.find #6325 <a href="https://github.com/lineus">lineus</a></li>
<li>docs(populate): add middleware examples #6320 <a href="https://github.com/BorntraegerMarc">BorntraegerMarc</a></li>
<li>docs(compatibility): fix dead link #6319 <a href="https://github.com/lacivert">lacivert</a></li>
<li>docs(api): fix markdown parsing for parameters #6318 #6314 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(populate): handle space-delimited paths in array populate #6296 #6284 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(populate): support basic virtual populate underneath embedded discriminators #6273</li>
</ul>
<h1>5.0.13 / 2018-04-05 </h1>
<ul>
<li>docs(faq): add middleware to faq arrow function warning #6309 <a href="https://github.com/lineus">lineus</a></li>
<li>docs(schema): add example to loadClass() docs #6308</li>
<li>docs: clean up misc typos #6304 <a href="https://github.com/sfrieson">sfrieson</a></li>
<li>fix(document): apply virtuals when calling <code>toJSON()</code> on a nested path #6294</li>
<li>refactor(connection): use <code>client.db()</code> syntax rather than double-parsing the URI #6292 #6286</li>
<li>docs: document new behavior of required validator for arrays #6288 <a href="https://github.com/daltones">daltones</a></li>
<li>fix(schema): treat set() options as user-provided options #6274</li>
<li>fix(schema): clone discriminators correctly #6274</li>
<li>fix(update): make setDefaultsOnInsert not create subdoc if only default is id #6269</li>
<li>docs(discriminator): clarify 3rd argument to Model.discriminator() #2596</li>
</ul>
<h1>5.0.12 / 2018-03-27 </h1>
<ul>
<li>docs(query): updating model name in query API docs #6280 <a href="https://github.com/lineus">lineus</a></li>
<li>docs: fix typo in tests #6275 <a href="https://github.com/styler">styler</a></li>
<li>fix: add missing <code>.hint()</code> to aggregate #6272 #6251 <a href="https://github.com/lineus">lineus</a></li>
<li>docs(api): add headers to each API docs section for easer nav #6261</li>
<li>fix(query): ensure hooked query functions always run on next tick for chaining #6250</li>
<li>fix(populate): ensure populated array not set to null if it isn't set #6245</li>
<li>fix(connection): set readyState to disconnected if initial connection fails #6244 #6131</li>
<li>docs(model): make <code>create()</code> params show up correctly in docs #6242</li>
<li>fix(model): make error handlers work with MongoDB server errors and <code>insertMany()</code> #6228</li>
<li>fix(browser): ensure browser document builds defaults for embedded arrays correctly #6175</li>
<li>fix(timestamps): set timestamps when using <code>updateOne()</code> and <code>updateMany()</code> #6282 <a href="https://github.com/gualopezb">gualopezb</a></li>
</ul>
<h1>5.0.11 / 2018-03-19 </h1>
<ul>
<li>fix(update): handle $pull with $in in update validators #6240</li>
<li>fix(query): don't convert undefined to null when casting so driver <code>ignoreUndefined</code> option works #6236</li>
<li>docs(middleware): add example of using async/await with middleware #6235</li>
<li>fix(populate): apply justOne option before <code>completeMany()</code> so it works with lean() #6234</li>
<li>fix(query): ensure errors in user callbacks aren't caught in init #6195 #6178</li>
<li>docs(connections): document dbName option for Atlas connections #6179</li>
<li>fix(discriminator): make child schema nested paths overwrite parent schema paths #6076</li>
</ul>
<h1>4.13.12 / 2018-03-13 </h1>
<ul>
<li>fix(document): make virtual get() return undefined instead of null if no getters #6223</li>
<li>docs: fix url in useMongoClient error message #6219 #6217 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(discriminator): don't copy <code>discriminators</code> property from base schema #6122 #6064</li>
</ul>
<h1>5.0.10 / 2018-03-12 </h1>
<ul>
<li>docs(schematype): add notes re: running setters on queries #6209</li>
<li>docs: fix typo #6208 <a href="https://github.com/kamagatos">kamagatos</a></li>
<li>fix(query): only call setters once on query filter props for findOneAndUpdate and findOneAndRemove #6203</li>
<li>docs: elaborate on connection string changes in migration guide #6193</li>
<li>fix(document): skip applyDefaults if subdoc is null #6187</li>
<li>docs: fix schematypes docs and link to them #6176</li>
<li>docs(faq): add FAQs re: array defaults and casting aggregation pipelines #6184 #6176 #6170 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(document): ensure primitive defaults are set and built-in default functions run before setters #6155</li>
<li>fix(query): handle single embedded embedded discriminators in castForQuery #6027</li>
</ul>
<h1>5.0.9 / 2018-03-05 </h1>
<ul>
<li>perf: bump mongodb -&gt; 3.0.4 to fix SSL perf issue #6065</li>
</ul>
<h1>5.0.8 / 2018-03-03 </h1>
<ul>
<li>docs: remove obsolete references to <code>emitIndexErrors</code> #6186 <a href="https://github.com/isaackwan">isaackwan</a></li>
<li>fix(query): don't cast findOne() until exec() so setters don't run twice #6157</li>
<li>fix: remove document_provider.web.js file #6186</li>
<li>fix(discriminator): support custom discriminator model names #6100 <a href="https://github.com/wentout">wentout</a></li>
<li>fix: support caching calls to <code>useDb()</code> #6036 <a href="https://github.com/rocketspacer">rocketspacer</a></li>
<li>fix(query): add omitUndefined option so setDefaultsOnInsert can kick in on undefined #6034</li>
<li>fix: upgrade mongodb -&gt; 3.0.3 for reconnectTries: 0 blocking process exit fix #6028</li>
</ul>
<h1>5.0.7 / 2018-02-23 </h1>
<ul>
<li>fix: support eachAsync options with aggregation cursor #6169 #6168 <a href="https://github.com/vichle">vichle</a></li>
<li>docs: fix link to MongoDB compound indexes docs #6162 <a href="https://github.com/br0p0p">br0p0p</a></li>
<li>docs(aggregate): use eachAsync instead of incorrect <code>each()</code> #6160 <a href="https://github.com/simllll">simllll</a></li>
<li>chore: fix benchmarks #6158 <a href="https://github.com/pradel">pradel</a></li>
<li>docs: remove dead link to old blog post #6154 <a href="https://github.com/markstos">markstos</a></li>
<li>fix: don't convert dates to numbers when updating mixed path #6146 #6145 <a href="https://github.com/s4rbagamble">s4rbagamble</a></li>
<li>feat(aggregate): add replaceRoot, count, sortByCount helpers #6142 <a href="https://github.com/jakesjews">jakesjews</a></li>
<li>fix(document): add includedChildren flag to modifiedPaths() #6134</li>
<li>perf: don't create wrapper function if no hooks specified #6126</li>
<li>fix(schema): allow indexes on single nested subdocs for geoJSON #6113</li>
<li>fix(document): allow depopulating all fields #6073</li>
<li>feat(mongoose): add support for <code>useFindAndModify</code> option on singleton #5616</li>
</ul>
<h1>5.0.6 / 2018-02-15 </h1>
<ul>
<li>refactor(query.castUpdate): avoid creating error until necessary #6137</li>
<li>docs(api): fix missing api docs #6136 <a href="https://github.com/lineus">lineus</a></li>
<li>fix(schema): copy virtuals when using <code>clone()</code> #6133</li>
<li>fix(update): avoid digging into buffers with upsert and replaceOne #6124</li>
<li>fix(schema): support <code>enum</code> on arrays of strings #6102</li>
<li>fix(update): cast <code><dl class="section rcs"><dt>addToSet</dt><dd>[1, 2] -&gt; <code></code></dd></dl>
addToSet: { $each: [1, 2] }</code> #6086</li>
</ul>
<h1>5.0.5 / 2018-02-13 </h1>
<ul>
<li>docs: make &gt; show up correctly in API docs #6114</li>
<li>fix(query): support <code>where()</code> overwriting primitive with object #6097</li>
<li>fix(schematype): don't run internal <code>resetId</code> setter on queries with _id #6093</li>
<li>fix(discriminator): don't copy <code>discriminators</code> property from base schema #6064</li>
<li>fix(utils): respect <code>valueOf()</code> when merging object for update #6059</li>
<li>docs(validation): fix typo 'maxLength' #4720</li>
<li>fix(document): apply defaults after setting initial value so default functions don't see empty doc #3781</li>
</ul>
<h1>5.0.4 / 2018-02-08 </h1>
<ul>
<li>docs: add lambda guide #6107</li>
<li>fix(connection): add <code>dbName</code> option to work around <code>mongodb+srv</code> not supporting db name in URI #6106</li>
<li>fix(schematype): fix regexp typo in ObjectId #6098 <a href="https://github.com/JoshuaWise">JoshuaWise</a></li>
<li>perf(document): re-use the modifiedPaths list #6092 <a href="https://github.com/tarun1793">tarun1793</a></li>
<li>fix: use console.info() instead of console.error() for debug output #6088 <a href="https://github.com/yuristsepaniuk">yuristsepaniuk</a></li>
<li>docs(validation): clean up runValidators and isAsync options docs for 5.x #6083</li>
<li>docs(model): use array instead of spread consistently for aggregate() #6070</li>
<li>fix(schema): make aliases handle mongoose-lean-virtuals #6069</li>
<li>docs(layout): add link to subdocs guide #6056</li>
<li>fix(query): make strictQuery: true strip out fields that aren't in the schema #6032</li>
<li>docs(guide): add notes for <code>strictQuery</code> option #6032</li>
</ul>
<h1>4.13.11 / 2018-02-07 </h1>
<ul>
<li>docs: fix links in 4.x docs #6081</li>
<li>chore: add release script that uses &ndash;tag for npm publish for 4.x releases #6063</li>
</ul>
<h1>5.0.3 / 2018-01-31 </h1>
<ul>
<li>fix: consistently use process.nextTick() to avoid sinon.useFakeTimers() causing ops to hang #6074</li>
<li>docs(aggregate): fix typo #6072 <a href="https://github.com/adursun">adursun</a></li>
<li>chore: add return type to <code>mongoose.model()</code> docs <a href="https://github.com/bryant1410">bryant1410</a></li>
<li>fix(document): depopulate push()-ed docs when saving #6048</li>
<li>fix: upgrade mongodb -&gt; 3.0.2 #6019</li>
</ul>
<h1>5.0.2 / 2018-01-28 </h1>
<ul>
<li>fix(schema): do not overwrite default values in schema when nested timestamps are provided #6024 <a href="https://github.com/cdeveas">cdeveas</a></li>
<li>docs: fix syntax highlighting in models.jade, schematypes.jade, subdocs.jade #6058 <a href="https://github.com/lineus">lineus</a></li>
<li>fix: use lazy loading so we can build mongoose with webpack #5993 #5842</li>
<li>docs(connections): clarify multi-mongos with useMongoClient for 4.x docs #5984</li>
<li>fix(populate): handle populating embedded discriminator paths #5970</li>
</ul>
<h1>4.13.10 / 2018-01-28 </h1>
<ul>
<li>docs(model+query): add lean() option to Model helpers #5996 <a href="https://github.com/aguyinmontreal">aguyinmontreal</a></li>
<li>fix: use lazy loading so we can build mongoose with webpack #5993 #5842</li>
<li>docs(connections): clarify multi-mongos with useMongoClient for 4.x docs #5984</li>
<li>fix(populate): handle populating embedded discriminator paths #5970</li>
<li>docs(query+aggregate): add more detail re: maxTimeMS #4066</li>
</ul>
<h1>5.0.1 / 2018-01-19 </h1>
<ul>
<li>fix(document): make validate() not resolve to document #6014</li>
<li>fix(model): make save() not return DocumentNotFoundError if using fire-and-forget writes #6012</li>
<li>fix(aggregate): make options() work as advertised #6011 <a href="https://github.com/spederiva">spederiva</a></li>
<li>docs(queries): fix code samples #6008</li>
</ul>
<h1>5.0.0 / 2018-01-17 </h1>
<ul>
<li>test: refactor tests to use start fewer connections #5985 <a href="https://github.com/fenanquin">fenanquin</a></li>
<li>feat: add global bufferCommands option #5879</li>
<li>docs: new docs site and build system #5976</li>
<li>test: increase timeout on slow test cases #5968 <a href="https://github.com/fenanquin">fenanquin</a></li>
<li>fix: avoid casting out array filter elements #5965</li>
<li>feat: add Model.watch() wrapper #5964</li>
<li>chore: replace istanbul with nyc #5962 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
</ul>
<h1>4.13.9 / 2018-01-07 </h1>
<ul>
<li>chore: update marked (dev dependency) re: security vulnerability #5951 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>fix: upgrade mongodb -&gt; 2.2.34 for ipv6 and autoReconnect fixes #5794 #5760</li>
<li>docs: use useMongooseAggCursor for aggregate docs #2955</li>
</ul>
<h1>5.0.0-rc2 / 2018-01-04 </h1>
<ul>
<li>fix: add cleaner warning about no longer needing <code>useMongoClient</code> in 5.x #5961</li>
<li>chore: update acquit -&gt; 0.5.1 for minor security patch #5961 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>docs: add docs for mongoose 4.x at <a href="http://mongoosejs.com/docs/4.x">http://mongoosejs.com/docs/4.x</a> #5959</li>
<li>docs: add link to migration guide #5957</li>
<li>chore: update eslint to version 4.14.0 #5955 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>chore: update mocha to version 4.1.0 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
</ul>
<h1>5.0.0-rc1 / 2018-01-02 </h1>
<ul>
<li>fix(index): use pluralize correctly for <code>mongoose.model()</code> #5958</li>
<li>fix: make mquery use native promises by default #5945</li>
<li>fix(connection): ensure 'joined' and 'left' events get bubbled up #5944</li>
</ul>
<h1>5.0.0-rc0 / 2017-12-28 </h1>
<ul>
<li>BREAKING CHANGE: always use mongoose aggregation cursor when using <code>.aggregate().cursor()</code> #5941</li>
<li>BREAKING CHANGE: attach query middleware when compiling model #5939</li>
<li>BREAKING CHANGE: <code>emitIndexErrors</code> is on by default, failing index build will throw uncaught error if not handled #5910</li>
<li>BREAKING CHANGE: remove precompiled browser bundle #5895</li>
<li>feat: add <code>mongoose.pluralize()</code> function #5877</li>
<li>BREAKING CHANGE: remove <code>passRawResult</code> option for <code>findOneAndUpdate</code>, use <code>rawResult</code> #5869</li>
<li>BREAKING CHANGE: implicit async validators (based on number of function args) are removed, return a promise instead #5824</li>
<li>BREAKING CHANGE: fail fast if user sets a unique index on <code>_id</code> #5820 <a href="https://github.com/varunjayaraman">varunjayaraman</a></li>
<li>BREAKING CHANGE: mapReduce resolves to an object with 2 keys rather than 2 separate args #5816</li>
<li>BREAKING CHANGE: <code>mongoose.connect()</code> returns a promise, removed MongooseThenable #5796</li>
<li>BREAKING CHANGE: query stream removed, use <code>cursor()</code> instead #5795</li>
<li>BREAKING CHANGE: connection <code>open()</code> and <code>openSet()</code> removed, use <code>openUri()</code> instead #5795</li>
<li>BREAKING CHANGE: use MongoDB driver 3.0.0, drop support for MongoDB server &lt; 3.0.0 #5791 #4740</li>
<li>BREAKING CHANGE: remove support for <code>$pushAll</code>, remove <code>usePushEach</code> option #5670</li>
<li>BREAKING CHANGE: make date casting use native Date #5395 <a href="https://github.com/varunjayaraman">varunjayaraman</a></li>
<li>BREAKING CHANGE: remove <code>runSettersOnQuery</code>, always run setters on query #5340</li>
<li>BREAKING CHANGE: array of length 0 now satisfies <code>required: true</code> for arays #5139 <a href="https://github.com/wlingke">wlingke</a></li>
<li>BREAKING CHANGE: remove <code>saveErrorIfNotFound</code>, always error out if <code>save()</code> did not update a document #4973</li>
<li>BREAKING CHANGE: don't execute getters in reverse order #4835</li>
<li>BREAKING CHANGE: make boolean casting more strict #4245</li>
<li>BREAKING CHANGE: <code>toObject()</code> and <code>toJSON()</code> option parameter merges with defaults rather than overwriting #4131</li>
<li>feat: allow setting <code>default</code> on <code>_id</code> #4069</li>
<li>BREAKING CHANGE: <code>deleteX()</code> and <code>remove()</code> promise resolves to the write object result #4013</li>
<li>feat: support returning a promise from middleware functions #3779</li>
<li>BREAKING CHANGE: don't return a promise if callback specified #3670</li>
<li>BREAKING CHANGE: only cast <code>update()</code>, <code>updateX()</code>, <code>replaceOne()</code>, <code>remove()</code>, <code>deleteX()</code> in exec #3529</li>
<li>BREAKING CHANGE: sync errors in middleware functions are now handled #3483</li>
<li>BREAKING CHANGE: post hooks get flow control #3232</li>
<li>BREAKING CHANGE: deduplicate hooks when merging discriminator schema #2945</li>
<li>BREAKING CHANGE: use native promises by default, remove support for mpromise #2917</li>
<li>BREAKING CHANGE: remove <code>retainKeyOrder</code>, always use forward order when iterating through objects #2749</li>
<li>BREAKING CHANGE: <code>aggregate()</code> no longer accepts a spread #2716</li>
</ul>
<h1>4.13.8 / 2017-12-27 </h1>
<ul>
<li>docs(guide): use more up-to-date syntax for autoIndex example #5933</li>
<li>docs: fix grammar #5927 <a href="https://github.com/abagh0703">abagh0703</a></li>
<li>fix: propagate lean options to child schemas #5914</li>
<li>fix(populate): use correct model with discriminators + nested populate #5858</li>
</ul>
<h1>4.13.7 / 2017-12-11 </h1>
<ul>
<li>docs(schematypes): fix typo #5889 <a href="https://github.com/gokaygurcan">gokaygurcan</a></li>
<li>fix(cursor): handle <code>reject(null)</code> with eachAsync callback #5875 #5874 <a href="https://github.com/ZacharyRSmith">ZacharyRSmith</a></li>
<li>fix: disallow setting <code>mongoose.connection</code> to invalid values #5871 <a href="https://github.com/jinasonlin">jinasonlin</a></li>
<li>docs(middleware): suggest using <code>return next()</code> to stop middleware execution #5866</li>
<li>docs(connection): improve connection string query param docs #5864</li>
<li>fix(document): run validate hooks on array subdocs even if not directly modified #5861</li>
<li>fix(discriminator): don't treat $meta as defining projection when querying #5859</li>
<li>fix(types): handle Decimal128 when using bson-ext on server side #5850</li>
<li>fix(document): ensure projection with only $slice isn't treated as inclusive for discriminators #4991</li>
<li>fix(model): throw error when passing non-object to create() #2037</li>
</ul>
<h1>4.13.6 / 2017-12-02 </h1>
<ul>
<li>fix(schema): support strictBool option in schema #5856 <a href="https://github.com/ekulabuhov">ekulabuhov</a></li>
<li>fix(update): make upsert option consistently handle truthy values, not just booleans, for updateOne() #5839</li>
<li>refactor: remove unnecessary constructor check #2057</li>
<li>docs(query): correct function signature for .mod() helper #1806</li>
<li>fix(query): report ObjectParameterError when passing non-object as filter to find() and findOne() #1698</li>
</ul>
<h1>4.13.5 / 2017-11-24 </h1>
<ul>
<li>fix(model): handle update cast errors correctly with bulkWrite #5845 <a href="https://github.com/Michael77">Michael77</a></li>
<li>docs: add link to bufferCommands option #5844 <a href="https://github.com/ralphite">ralphite</a></li>
<li>fix(model): allow virtual ref function to return arrays #5834 <a href="https://github.com/brunohcastro">brunohcastro</a></li>
<li>fix(query): don't throw uncaught error if query filter too big #5812</li>
<li>fix(document): if setting unselected nested path, don't overwrite nested path #5800</li>
<li>fix(document): support calling <code>populate()</code> on nested document props #5703</li>
<li>fix: add <code>strictBool</code> option for schema type boolean #5344 #5211 #4245</li>
<li>docs(faq): add faq re: typeKey #1886</li>
<li>docs(query): add more detailed docs re: options #1702</li>
</ul>
<h1>4.13.4 / 2017-11-17 </h1>
<ul>
<li>fix(aggregate): add chainable .option() helper for setting arbitrary options #5829</li>
<li>fix(aggregate): add <code>.pipeline()</code> helper to get the current pipeline #5825</li>
<li>docs: grammar fixes for <code>unique</code> FAQ #5823 <a href="https://github.com/mfluehr">mfluehr</a></li>
<li>chore: add node 9 to travis #5822 <a href="https://github.com/superheri">superheri</a></li>
<li>fix(model): fix infinite recursion with recursive embedded discriminators #5821 <a href="https://github.com/Faibk">Faibk</a></li>
</ul>
<h1>4.13.3 / 2017-11-15 </h1>
<ul>
<li>chore: add node 8 to travis #5818 <a href="https://github.com/superheri">superheri</a></li>
<li>fix(document): don't apply transforms to nested docs when updating already saved doc #5807</li>
</ul>
<h1>4.13.2 / 2017-11-11 </h1>
<ul>
<li>feat(buffer): add support for subtype prop #5530</li>
</ul>
<h1>4.13.1 / 2017-11-08 </h1>
<ul>
<li>fix: accept multiple paths or array of paths to depopulate #5798 #5797 <a href="https://github.com/adamreisnz">adamreisnz</a></li>
<li>fix(document): pass default array as actual array rather than taking first element #5780</li>
<li>fix(model): increment version when $set-ing it in a save() that requires a version bump #5779</li>
<li>fix(query): don't explicitly project in discriminator key if user projected in parent path #5775 #5754</li>
<li>fix(model): cast query option to geoNear() #5765</li>
<li>fix(query): don't treat projection with just $slice as inclusive #5737</li>
<li>fix(discriminator): defer applying embedded discriminator hooks until top-level model is compiled #5706</li>
<li>docs(discriminator): add warning to always attach hooks before calling discriminator() #5706</li>
</ul>
<h1>4.13.0 / 2017-11-02 </h1>
<ul>
<li>feat(aggregate): add $addFields helper #5740 <a href="https://github.com/AyushG3112">AyushG3112</a></li>
<li>feat(connection): add connection-level bufferCommands #5720</li>
<li>feat(connection): add createCollection() helper #5712</li>
<li>feat(populate): support setting localField and foreignField to functions #5704 #5602</li>
<li>feat(query): add multipleCastError option for aggregating cast errors when casting update #5609</li>
<li>feat(populate): allow passing a function to virtual ref #5602</li>
<li>feat(schema): add excludeIndexes option to optionally prevent collecting indexes from nested schemas #5575</li>
<li>feat(model): report validation errors from <code>insertMany()</code> if using <code>ordered: false</code> and <code>rawResult: true</code> #5337</li>
<li>feat(aggregate): add pre/post aggregate middleware #5251</li>
<li>feat(schema): allow using <code>set</code> as a schema path #1939</li>
</ul>
<h1>4.12.6 / 2017-11-01 </h1>
<ul>
<li>fix(schema): make clone() copy query helpers correctly #5752</li>
<li>fix: undeprecate <code>ensureIndex()</code> and use it by default #3280</li>
</ul>
<h1>4.12.5 / 2017-10-29 </h1>
<ul>
<li>fix(query): correctly handle <code>$in</code> and required for $pull and update validators #5744</li>
<li>feat(aggegate): add $addFields pipeline operator #5740 <a href="https://github.com/AyushG3112">AyushG3112</a></li>
<li>fix(document): catch sync errors in document pre hooks and report as error #5738</li>
<li>fix(populate): handle slice projections correctly when automatically selecting populated fields #5737</li>
<li>fix(discriminator): fix hooks for embedded discriminators #5706 <a href="https://github.com/wlingke">wlingke</a></li>
<li>fix(model): throw sane error when customer calls <code>mongoose.Model()</code> over <code>mongoose.model()</code> #2005</li>
</ul>
<h1>4.12.4 / 2017-10-21 </h1>
<ul>
<li>test(plugins): add coverage for idGetter with id as a schema property #5713 <a href="https://github.com/wlingke">wlingke</a></li>
<li>fix(model): avoid copying recursive $$context object when creating discriminator after querying #5721</li>
<li>fix(connection): ensure connection promise helpers are removed before emitting 'connected' #5714</li>
<li>docs(schema): add notes about runSettersOnQuery to schema setters #5705</li>
<li>fix(collection): ensure queued operations run on the next tick #5562</li>
</ul>
<h1>4.12.3 / 2017-10-16 </h1>
<ul>
<li>fix(connection): emit 'reconnect' event as well as 'reconnected' for consistency with driver #5719</li>
<li>fix: correctly bubble up left/joined events for replica set #5718</li>
<li>fix(connection): allow passing in <code>autoIndex</code> as top-level option rather than requiring <code>config.autoIndex</code> #5711</li>
<li>docs(connection): improve docs regarding reconnectTries, autoReconnect, and bufferMaxEntries #5711</li>
<li>fix(query): handle null with addToSet/push/pull/pullAll update validators #5710</li>
<li>fix(model): handle setDefaultsOnInsert option for bulkWrite updateOne and updateMany #5708</li>
<li>fix(query): avoid infinite recursion edge case when cloning a buffer #5702</li>
</ul>
<h1>4.12.2 / 2017-10-14 </h1>
<ul>
<li>docs(faq): add FAQ about using arrow functions for getters/setters, virtuals, and methods #5700</li>
<li>docs(schema): document the childSchemas property and add to public API #5695</li>
<li>fix(query): don't project in populated field if parent field is already projected in #5669</li>
<li>fix: bump mongodb -&gt; 2.2.33 for issue with autoReconnect #4513</li>
</ul>
<h1>4.12.1 / 2017-10-08 </h1>
<ul>
<li>fix(document): create new doc when setting single nested, no more set() on copy of priorVal #5693</li>
<li>fix(model): recursively call applyMethods on child schemas for global plugins #5690</li>
<li>docs: fix bad promise lib example on home page #5686</li>
<li>fix(query): handle false when checking for inclusive/exclusive projection #5685</li>
<li>fix(discriminator): allow reusing child schema #5684</li>
<li>fix: make addToSet() on empty array with subdoc trigger manual population #5504</li>
</ul>
<h1>4.12.0 / 2017-10-02 </h1>
<ul>
<li>docs(validation): add docs coverage for ValidatorError.reason #5681</li>
<li>feat(discriminator): always add discriminatorKey to base schema to allow updating #5613</li>
<li>fix(document): make nested docs no longer inherit parent doc's schema props #5586 #5546 #5470</li>
<li>feat(query): run update validators on $pull and $pullAll #5555</li>
<li>feat(query): add .error() helper to query to error out in pre hooks #5520</li>
<li>feat(connection): add dropCollection() helper #5393</li>
<li>feat(schema): add schema-level collation option #5295</li>
<li>feat(types): add <code>discriminator()</code> function for single nested subdocs #5244</li>
<li>feat(document): add $isDeleted() getter/setter for better support for soft deletes #4428</li>
<li>feat(connection): bubble up reconnectFailed event when driver gives up reconnecting #4027</li>
<li>fix(query): report error if passing array or other non-object as filter to update query #3677</li>
<li>fix(collection): use createIndex() instead of deprecated ensureIndex() #3280</li>
</ul>
<h1>4.11.14 / 2017-09-30 </h1>
<ul>
<li>chore: add nsp check to the CI build #5679 <a href="https://github.com/hairyhenderson">hairyhenderson</a></li>
<li>fix: bump mquery because of security issue with debug package #5677 #5675 <a href="https://github.com/jonathanprl">jonathanprl</a></li>
<li>fix(populate): automatically select() populated()-ed fields #5669</li>
<li>fix(connection): make force close work as expected #5664</li>
<li>fix(document): treat $elemMatch as inclusive projection #5661</li>
<li>docs(model/query): clarify which functions fire which middleware #5654</li>
<li>fix(model): make <code>init()</code> public and return a promise that resolves when indexes are done building #5563</li>
</ul>
<h1>4.11.13 / 2017-09-24 </h1>
<ul>
<li>fix(query): correctly run replaceOne with update validators #5665 <a href="https://github.com/sime1">sime1</a></li>
<li>fix(schema): replace mistype in setupTimestamp method #5656 <a href="https://github.com/zipp3r">zipp3r</a></li>
<li>fix(query): avoid throwing cast error for strict: throw with nested id in query #5640</li>
<li>fix(model): ensure class gets combined schema when using class syntax with discriminators #5635</li>
<li>fix(document): handle setting doc array to array of top-level docs #5632</li>
<li>fix(model): handle casting findOneAndUpdate() with overwrite and upsert #5631</li>
<li>fix(update): correctly handle $ in updates #5628</li>
<li>fix(types): handle manual population consistently for unshift() and splice() #5504</li>
</ul>
<h1>4.11.12 / 2017-09-18 </h1>
<ul>
<li>docs(model): asterisk should not render as markdown bullet #5644 <a href="https://github.com/timkinnane">timkinnane</a></li>
<li>docs: use useMongoClient in connection example #5627 <a href="https://github.com/GabrielNicolasAvellaneda">GabrielNicolasAvellaneda</a></li>
<li>fix(connection): call callback when initial connection failed #5626</li>
<li>fix(query): apply select correctly if a given nested schema is used for 2 different paths #5603</li>
<li>fix(document): add graceful fallback for setting a doc array value and <code>pull()</code>-ing a doc #3511</li>
</ul>
<h1>4.11.11 / 2017-09-10 </h1>
<ul>
<li>fix(connection): properly set readyState in response to driver 'close' and 'reconnect' events #5604</li>
<li>fix(document): ensure single embedded doc setters only get called once, with correct value #5601</li>
<li>fix(timestamps): allow enabling updatedAt without createdAt #5598</li>
<li>test: improve unique validator test by making create run before ensureIndex #5595 #5562</li>
<li>fix(query): ensure find callback only gets called once when post init hook throws error #5592</li>
</ul>
<h1>4.11.10 / 2017-09-03 </h1>
<ul>
<li>docs: add KeenIO tracking #5612</li>
<li>fix(schema): ensure validators declared with <code>.validate()</code> get copied with clone() #5607</li>
<li>fix: remove unnecessary jest warning #5480</li>
<li>fix(discriminator): prevent implicit discriminator schema id from clobbering base schema custom id #5591</li>
<li>fix(schema): hide schema objectid warning for non-hex strings of length 24 #5587</li>
<li>docs(populate): use story schema defined key author instead of creator #5578 <a href="https://github.com/dmric">dmric</a></li>
<li>docs(document): describe usage of <code>.set()</code> #5576</li>
<li>fix(document): ensure correct scope in single nested validators #5569</li>
<li>fix(populate): don't mark path as populated until populate() is done #5564</li>
<li>fix(document): make push()-ing a doc onto an empty array act as manual population #5504</li>
<li>fix(connection): emit timeout event on socket timeout #4513</li>
</ul>
<h1>4.11.9 / 2017-08-27 </h1>
<ul>
<li>fix(error): avoid using arguments.callee because that breaks strict mode #5572</li>
<li>docs(schematypes): fix spacing #5567</li>
<li>fix(query): enforce binary subtype always propagates to mongodb #5551</li>
<li>fix(query): only skip castForQuery for mongoose arrays #5536</li>
<li>fix(browser): rely on browser entrypoint to decide whether to use BrowserDocument or NodeDocument #5480</li>
</ul>
<h1>4.11.8 / 2017-08-23 </h1>
<ul>
<li>feat: add warning about using schema ObjectId as type ObjectId #5571 <a href="https://github.com/efkan">efkan</a></li>
<li>fix(schema): allow setting <code>id</code> property after schema was created #5570 #5548</li>
<li>docs(populate): remove confusing _ from populate docs #5560</li>
<li>fix(connection): expose parsed uri fields (host, port, dbname) when using openUri() #5556</li>
<li>docs: added type boolean to options documentation #5547 <a href="https://github.com/ndabAP">ndabAP</a></li>
<li>test: add test coverage for stopping/starting server #5524</li>
<li>fix(aggregate): pull read preference from schema by default #5522</li>
</ul>
<h1>4.11.7 / 2017-08-14 </h1>
<ul>
<li>fix: correct properties when calling toJSON() on populated virtual #5544 #5442 <a href="https://github.com/davidwu226">davidwu226</a></li>
<li>docs: fix spelling #5535 <a href="https://github.com/et">et</a></li>
<li>fix(error): always set name before stack #5533</li>
<li>fix: add warning about running jest in jsdom environment #5532 #5513 #4943</li>
<li>fix(document): ensure overwriting a doc array cleans out individual docs #5523</li>
<li>fix(schema): handle creating arrays of single nested using type key #5521</li>
<li>fix: upgrade mongodb -&gt; 2.2.31 to support user/pass options #5419</li>
</ul>
<h1>4.11.6 / 2017-08-07 </h1>
<ul>
<li>fix: limiting number of async operations per time in insertMany #5529 <a href="https://github.com/andresattler">andresattler</a></li>
<li>fix: upgrade mongodb -&gt; 2.2.30 #5517</li>
<li>fix(browserDocument): prevent stack overflow caused by double-wrapping embedded doc save() in jest #5513</li>
<li>fix(document): clear single nested doc when setting to empty object #5506</li>
<li>fix(connection): emit reconnected and disconnected events correctly with useMongoClient #5498</li>
<li>fix(populate): ensure nested virtual populate gets set even if top-level property is null #5431</li>
</ul>
<h1>4.11.5 / 2017-07-30 </h1>
<ul>
<li>docs: fix link to $lookup #5516 <a href="https://github.com/TalhaAwan">TalhaAwan</a></li>
<li>fix: better parallelization for eachAsync #5502 <a href="https://github.com/lchenay">lchenay</a></li>
<li>docs(document): copy docs for save from model to doc #5493</li>
<li>fix(document): handle dotted virtuals in toJSON output #5473</li>
<li>fix(populate): restore user-provided limit after mutating so cursor() works with populate limit #5468</li>
<li>fix(query): don't throw StrictModeError if geo query with upsert #5467</li>
<li>fix(populate): propagate readPreference from query to populate queries by default #5460</li>
<li>docs: warn not to use arrow functions for statics and methods #5458</li>
<li>fix(query): iterate over all condition keys for setDefaultsOnInsert #5455</li>
<li>docs(connection): clarify server/replset/mongos option deprecation with useMongoClient #5442</li>
</ul>
<h1>4.11.4 / 2017-07-23 </h1>
<ul>
<li>fix: handle next() errors in <code>eachAsync()</code> #5486 <a href="https://github.com/lchenay">lchenay</a></li>
<li>fix(schema): propagate runSettersOnQuery option to implicitly created schemas #5479 [<a href="https://github.com/ValYouW">https://github.com/ValYouW</a>]</li>
<li>fix(query): run castConditions() correctly in update ops #5477</li>
<li>fix(query): ensure castConditions called for findOne and findOneAnd* #5477</li>
<li>docs: clarify relationship between $lookup and populate #5475 <a href="https://github.com/TalhaAwan">TalhaAwan</a></li>
<li>test: add coverage for arrays of arrays <a href="https://github.com/zbjornson">zbjornson</a></li>
<li>fix(middleware): ensure that error handlers for save get doc as 2nd param #5466</li>
<li>fix: handle strict: false correctly #5454 #5453 <a href="https://github.com/wookieb">wookieb</a></li>
<li>fix(query): apply schema excluded paths if only projection is a $slice #5450</li>
<li>fix(query): correct discriminator handling for schema <code>select: false</code> fields in schema #5448</li>
<li>fix(cursor): call next() in series when parallel option used #5446</li>
<li>chore: load bundled driver first to avoid packaging problem #5443 <a href="https://github.com/prototypeme">prototypeme</a></li>
<li>fix(query): defer condition casting until final exec #5434</li>
<li>fix(aggregate): don't rely on mongodb aggregate to put a cursor in the callback #5394</li>
<li>docs(aggregate): add useMongooseAggCursor docs #5394</li>
<li>docs(middleware): clarify context for document, query, and model middleware #5381</li>
</ul>
<h1>4.11.3 / 2017-07-14 </h1>
<ul>
<li>fix(connection): remove .then() before resolving to prevent infinite recursion #5471</li>
</ul>
<h1>4.11.2 / 2017-07-13 </h1>
<ul>
<li>docs: fix comment typo in connect example #5435 <a href="https://github.com/ConnorMcF">ConnorMcF</a></li>
<li>fix(update): correctly cast document array in update validators with exec() #5430</li>
<li>fix(connection): handle autoIndex with useMongoClient #5423</li>
<li>fix(schema): handle <code>type: [Array]</code> in schemas #5416</li>
<li>fix(timestamps): if overwrite is set and there's a $set, use $set instead of top-level update #5413</li>
<li>fix(document): don't double-validate deeply nested doc array elements #5411</li>
<li>fix(schematype): clone default objects so default not shared across object instances unless <code>shared</code> specified #5407</li>
<li>fix(document): reset down the nested subdocs when resetting parent doc #5406</li>
<li>fix: don't pass error arg twice to error handlers #5405</li>
<li>fix(connection): make openUri() return connection decorated with then() and catch() #5404</li>
<li>fix: enforce $set on an array must be an array #5403</li>
<li>fix(document): don't crash if calling <code>validateSync()</code> after overwriting doc array index #5389</li>
<li>fix(discriminator): ensure discriminator key doesn't count as user-selected field for projection #4629</li>
</ul>
<h1>4.11.1 / 2017-07-02 </h1>
<ul>
<li>docs: populate virtuals fix justOne description #5427 <a href="https://github.com/fredericosilva">fredericosilva</a><ul>
<li>fix(connection): make sure to call onOpen in openUri() #5404</li>
<li>docs(query): justOne is actually single, and it default to false #5402 <a href="https://github.com/zbjornson">zbjornson</a></li>
<li>docs: fix small typo in lib/schema.js #5398 #5396 <a href="https://github.com/pjo336">pjo336</a></li>
<li>fix: emit remove on single nested subdocs when removing parent #5388</li>
<li>fix(update): handle update with defaults and overwrite but no update validators #5384</li>
<li>fix(populate): handle undefined refPath values in middle of array #5377</li>
<li>fix(document): ensure consistent setter context for single nested #5363</li>
<li>fix(query): support runSettersOnQuery as query option #5350</li>
</ul>
</li>
</ul>
<h1>4.11.0 / 2017-06-25 </h1>
<ul>
<li>feat(query): execute setters with query as context for <code>runSettersOnQuery</code> #5339</li>
<li>feat(model): add translateAliases function #5338 <a href="https://github.com/rocketspacer">rocketspacer</a></li>
<li>feat(connection): add <code>useMongoClient</code> and <code>openUri</code> functions, deprecate current connect logic #5304</li>
<li>refactor(schema): make id virtual not access doc internals #5279</li>
<li>refactor: handle non-boolean lean #5279</li>
<li>feat(cursor): add addCursorFlag() support to query and agg cursors #4814</li>
<li>feat(cursor): add parallel option to eachAsync #4244</li>
<li>feat(schema): allow setting custom error constructor for custom validators #4009</li>
</ul>
<h1>4.10.8 / 2017-06-21 </h1>
<ul>
<li>docs: fix small formatting typo on schematypes #5374 <a href="https://github.com/gianpaj">gianpaj</a></li>
<li>fix(model): allow null as an _id #5370</li>
<li>fix(populate): don't throw async uncaught exception if model not found in populate #5364</li>
<li>fix: correctly cast decimals in update #5361</li>
<li>fix(error): don't use custom getter for ValidationError message #5359</li>
<li>fix(query): handle runSettersOnQuery in built-in _id setter #5351</li>
<li>fix(document): ensure consistent context for nested doc custom validators #5347</li>
</ul>
<h1>4.10.7 / 2017-06-18 </h1>
<ul>
<li>docs(validation): show overriding custom validator error with 2nd cb arg #5358</li>
<li>fix: <code>parseOption</code> mutates user passed option map #5357 <a href="https://github.com/igwejk">igwejk</a></li>
<li>docs: fix guide.jade typo #5356 <a href="https://github.com/CalebAnderson2014">CalebAnderson2014</a></li>
<li>fix(populate): don't set populate virtual to ids when match fails #5336</li>
<li>fix(query): callback with cast error if remove and delete* args have a cast error #5323</li>
</ul>
<h1>4.10.6 / 2017-06-12 </h1>
<ul>
<li>fix(cursor): handle custom model option for populate #5334</li>
<li>fix(populate): handle empty virtual populate with Model.populate #5331</li>
<li>fix(model): make ensureIndexes() run with autoIndex: false unless called internally #5328 #5324 #5317</li>
<li>fix: wait for all connections to close before resolving disconnect() promise #5316</li>
<li>fix(document): handle setting populated path with custom typeKey in schema #5313</li>
<li>fix(error): add toJSON helper to ValidationError so <code>message</code> shows up with JSON.stringify #5309</li>
<li>feat: add <code>getPromiseConstructor()</code> to prevent need for <code>mongoose.Promise.ES6</code> #5305</li>
<li>fix(document): handle conditional required with undefined props #5296</li>
<li>fix(model): clone options before inserting in save() #5294</li>
<li>docs(populate): clarify that multiple populate() calls on same path overwrite #5274</li>
</ul>
<h1>4.10.5 / 2017-06-06 </h1>
<ul>
<li>chore: improve contrib guide for building docs #5312</li>
<li>fix(populate): handle init-ing nested virtuals properly #5311</li>
<li>fix(update): report update validator error if required path under single nested doc not set</li>
<li>fix(schema): remove default validate pre hook that was causing issues with jest #4943</li>
</ul>
<h1>4.10.4 / 2017-05-29 </h1>
<ul>
<li>chore: dont store test data in same directory #5303</li>
<li>chore: add data dirs to npmignore #5301 <a href="https://github.com/Starfox64">Starfox64</a></li>
<li>docs(query): add docs about runSettersOnQuery #5300</li>
</ul>
<h1>4.10.3 / 2017-05-27 </h1>
<ul>
<li>docs: correct inconsistent references to updateOne and replaceOne #5297 <a href="https://github.com/dhritzkiv">dhritzkiv</a></li>
<li>docs: fix dropdowns in docs #5292 <a href="https://github.com/nathanallen">nathanallen</a></li>
<li>docs: add description of alias option #5287</li>
<li>fix(document): prevent infinite loop if validating nested array #5282</li>
<li>fix(schema): correctly handle ref ObjectIds from different mongoose libs #5259</li>
<li>fix(schema): load child class methods after base class methods to allow override #5227</li>
</ul>
<h1>4.10.2 / 2017-05-22 </h1>
<ul>
<li>fix: bump ms -&gt; 2.0.0 and mquery -&gt; 2.3.1 for minor security vulnerability #5275</li>
</ul>
<h1>4.10.1 / 2017-05-21 </h1>
<ul>
<li>fix(aggregate): handle sorting by text score correctly #5258</li>
<li>fix(populate): handle doc.populate() with virtuals #5240</li>
<li>fix(schema): enforce that <code>_id</code> is never null #5236</li>
</ul>
<h1>4.10.0 / 2017-05-18 </h1>
<ul>
<li>fix(schema): update clone method to include indexes #5268 <a href="https://github.com/clozanosanchez">clozanosanchez</a></li>
<li>feat(schema): support aliases #5184 <a href="https://github.com/rocketspacer">rocketspacer</a></li>
<li>feat(aggregate): add mongoose-specific aggregation cursor option #5145</li>
<li>refactor(model): make sharding into a plugin instead of core #5105</li>
<li>fix(document): make nested doc mongoose internals not enumerable again #5078</li>
<li>feat(model): pass params to pre hooks #5064</li>
<li>feat(timestamps): support already defined timestamp paths in schema #4868</li>
<li>feat(query): add runSettersOnQuery option #4569</li>
<li>fix(query): add strictQuery option that throws when not querying on field not in schema #4136</li>
<li>fix(update): more complete handling for overwrite option with update validators #3556</li>
<li>feat: support <code>unique: true</code> in arrays via the mongoose-unique-array plugin #3347</li>
<li>fix(model): always emit 'index', even if no indexes #3347</li>
<li>fix(schema): set unique indexes on primitive arrays #3347</li>
<li>feat(validation): include failed paths in error message and inspect output #3064 #2135</li>
<li>fix(model): return saved docs when create() fails #2190</li>
</ul>
<h1>4.9.10 / 2017-05-17 </h1>
<ul>
<li>fix(connection): ensure callback arg to openSet() is handled properly #5249</li>
<li>docs: remove dead plugins repo and add content links #5247</li>
<li>fix(model): skip index build if connecting after model init and autoIndex false #5176</li>
</ul>
<h1>4.9.9 / 2017-05-13 </h1>
<ul>
<li>docs: correct value for Query::regex() #5230</li>
<li>fix(connection): don't throw if .catch() on open() promise #5229</li>
<li>fix(schema): allow update with $currentDate for updatedAt to succeed #5222</li>
<li>fix(model): versioning doesn't fail if version key undefined #5221 <a href="https://github.com/basileos">basileos</a></li>
<li>fix(document): don't emit model error if callback specified for consistency with docs #5216</li>
<li>fix(document): handle errors in subdoc pre validate #5215</li>
</ul>
<h1>4.9.8 / 2017-05-07 </h1>
<ul>
<li>docs(subdocs): rewrite subdocs guide #5217</li>
<li>fix(document): avoid circular JSON if error in doc array under single nested subdoc #5208</li>
<li>fix(document): set intermediate empty objects for deeply nested undefined paths before path itself #5206</li>
<li>fix(schema): throw error if first param to schema.plugin() is not a function #5201</li>
<li>perf(document): major speedup in validating subdocs (50x in some cases) #5191</li>
</ul>
<h1>4.9.7 / 2017-04-30 </h1>
<ul>
<li>docs: fix typo #5204 <a href="https://github.com/phutchins">phutchins</a></li>
<li>fix(schema): ensure correct path for deeply nested schema indexes #5199</li>
<li>fix(schema): make remove a reserved name #5197</li>
<li>fix(model): handle Decimal type in insertMany correctly #5190</li>
<li>fix: upgrade kareem to handle async pre hooks correctly #5188</li>
<li>docs: add details about unique not being a validator #5179</li>
<li>fix(validation): handle returning a promise with isAsync: true #5171</li>
</ul>
<h1>4.9.6 / 2017-04-23 </h1>
<ul>
<li>fix: update <code>parentArray</code> references when directly assigning document arrays #5192 <a href="https://github.com/jhob">jhob</a></li>
<li>docs: improve schematype validator docs #5178 <a href="https://github.com/milesbarr">milesbarr</a></li>
<li>fix(model): modify discriminator() class in place #5175</li>
<li>fix(model): handle bulkWrite updateMany casting #5172 <a href="https://github.com/tzellman">tzellman</a></li>
<li>docs(model): fix replaceOne example for bulkWrite #5168</li>
<li>fix(document): don't create a new array subdoc when creating schema array #5162</li>
<li>fix(model): merge query hooks from discriminators #5147</li>
<li>fix(document): add parent() function to subdocument to match array subdoc #5134</li>
</ul>
<h1>4.9.5 / 2017-04-16 </h1>
<ul>
<li>fix(query): correct $pullAll casting of null #5164 <a href="https://github.com/Sebmaster">Sebmaster</a></li>
<li>docs: add advanced schemas docs for loadClass #5157</li>
<li>fix(document): handle null/undefined gracefully in applyGetters() #5143</li>
<li>fix(model): add resolveToObject option for mapReduce with ES6 promises #4945</li>
</ul>
<h1>4.9.4 / 2017-04-09 </h1>
<ul>
<li>fix(schema): clone query middleware correctly #5153 #5141 <a href="https://github.com/clozanosanchez">clozanosanchez</a></li>
<li>docs(aggregate): fix typo #5142</li>
<li>fix(query): cast .$ update to underlying array type #5130</li>
<li>fix(populate): don't mutate populate result in place #5128</li>
<li>fix(query): handle $setOnInsert consistent with $set #5126</li>
<li>docs(query): add strict mode option for findOneAndUpdate #5108</li>
</ul>
<h1>4.9.3 / 2017-04-02 </h1>
<ul>
<li>docs: document.js fixes for functions prepended with <code>$</code> #5131 <a href="https://github.com/krmannix">krmannix</a></li>
<li>fix: Avoid exception on constructor check #5129 <a href="https://github.com/monkbroc">monkbroc</a></li>
<li>docs(schematype): explain how to use <code>isAsync</code> with validate() #5125</li>
<li>docs(schematype): explain custom message with required function #5123</li>
<li>fix(populate): only apply refPath duplicate id optimization if not array #5114</li>
<li>fix(document): copy non-objects to doc when init() #5111</li>
<li>perf(populate): dont clone whole options every time #5103</li>
<li>feat(document): add isDirectSelected() to minimize isSelected() changes #5063</li>
<li>docs(schematypes): explain some subtleties with arrays #5059</li>
</ul>
<h1>4.9.2 / 2017-03-26 </h1>
<ul>
<li>fix(discriminator): handle class names consistently #5104</li>
<li>fix(schema): make clone() work with reusing discriminator schemas #5098</li>
<li>fix(querycursor): run pre find hooks with .cursor() #5096</li>
<li>fix(connection): throw error if username:password includes @ or : #5091</li>
<li>fix(timestamps): handle overwriting createdAt+updatedAt consistently #5088</li>
<li>fix(document): ensure subdoc post save runs after parent save #5085</li>
<li>docs(model): improve update docs #5076 <a href="https://github.com/bertolo1988">bertolo1988</a></li>
</ul>
<h1>4.9.1 / 2017-03-19 </h1>
<ul>
<li>fix(query): handle $type for arrays #5080 #5079 <a href="https://github.com/zoellner">zoellner</a></li>
<li>fix(model): handle ordered param for <code>insertMany</code> validation errors #5072 <a href="https://github.com/sjorssnoeren">sjorssnoeren</a></li>
<li>fix(populate): avoid duplicate ids in dynref queries #5054</li>
<li>fix(timestamps): dont set timestamps in update if user set it #5045</li>
<li>fix(update): dont double-call setters on arrays #5041</li>
<li>fix: upgrade driver -&gt; 2.2.25 for jest fix #5033</li>
<li>fix(model): get promise each time save() is called rather than once #5030</li>
<li>fix(connection): make connect return value consistent #5006</li>
</ul>
<h1>4.9.0 / 2017-03-13 </h1>
<ul>
<li>feat(document): return this from <code>depopulate()</code> #5027</li>
<li>fix(drivers): stop emitting timeouts as errors #5026</li>
<li>feat(schema): add a clone() function for schemas #4983</li>
<li>feat(query): add rawResult option to replace passRawResult, deprecate passRawResult #4977 #4925</li>
<li>feat(schematype): support isAsync validator option and handle returning promises from validators, deprecate implicit async validators #4290</li>
<li>feat(query): add <code>replaceOne()</code>, <code>deleteOne()</code>, <code>deleteMany()</code> #3998</li>
<li>feat(model): add <code>bulkWrite()</code> #3998</li>
</ul>
<h1>4.8.7 / 2017-03-12 </h1>
<ul>
<li>fix(model): if last arg in spread is falsy, treat it as a callback #5061</li>
<li>fix(document): use $hook instead of hook to enable 'hook' as a path name #5047</li>
<li>fix(populate): dont select foreign field if parent field is selected #5037</li>
<li>fix(populate): handle passing no args to query.populate #5036</li>
<li>fix(update): use correct method for casting nested arrays #5032</li>
<li>fix(discriminator): handle array discriminators when casting $push #5009</li>
</ul>
<h1>4.8.6 / 2017-03-05 </h1>
<ul>
<li>docs(document): remove text that implies that transform is false by default #5023</li>
<li>fix(applyHooks): dont wrap a function if it is already wrapped #5019</li>
<li>fix(document): ensure nested docs' toObject() clones #5008</li>
</ul>
<h1>4.8.5 / 2017-02-25 </h1>
<ul>
<li>fix: check for empty schemaPath before accessing property $isMongooseDocumentArray #5017 [<a href="https://github.com/randyhoulahan">https://github.com/randyhoulahan</a>](randyhoulahan)</li>
<li>fix(discriminators): handle create() and push() for embedded discriminators #5001</li>
<li>fix(querycursor): ensure close emitted after last data event #4998</li>
<li>fix(discriminators): remove fields not selected in child when querying by base model #4991</li>
</ul>
<h1>4.8.4 / 2017-02-19 </h1>
<ul>
<li>docs(discriminators): explain embedded discriminators #4997</li>
<li>fix(query): fix TypeError when findOneAndUpdate errors #4990</li>
<li>fix(update): handle nested single embedded in update validators correctly #4989</li>
<li>fix(browser): make browser doc constructor not crash #4987</li>
</ul>
<h1>4.8.3 / 2017-02-15 </h1>
<ul>
<li>chore: upgrade mongodb driver -&gt; 2.2.24</li>
<li>docs(connections): addd some details about callbacks #4986</li>
<li>fix: ensure class is created with new keyword #4972 #4947 <a href="https://github.com/benhjames">benhjames</a></li>
<li>fix(discriminator): add applyPluginsToDiscriminators option #4965</li>
<li>fix(update): properly cast array subdocs when casting update #4960</li>
<li>fix(populate): ensure foreign field is selected for virtual populate #4959</li>
<li>docs(query): document some query callback params #4949</li>
<li>fix(document): ensure errors in validators get caught #2185</li>
</ul>
<h1>4.8.2 / 2017-02-10 </h1>
<ul>
<li>fix(update): actually run validators on addToSet #4953</li>
<li>fix(update): improve buffer error handling #4944 <a href="https://github.com/ValYouW">ValYouW</a></li>
<li>fix(discriminator): handle subclassing with loadClass correctly #4942</li>
<li>fix(query): allow passing Map to sort() #4941</li>
<li>fix(document): handle setting discriminator doc #4935</li>
<li>fix(schema): return correct value from pre init hook #4928</li>
<li>fix(query): ensure consistent params in error handlers if pre hook errors #4927</li>
</ul>
<h1>4.8.1 / 2017-01-30 </h1>
<ul>
<li>fix(query): handle $exists for arrays and embedded docs #4937</li>
<li>fix(query): handle passing string to hint() #4931</li>
</ul>
<h1>4.8.0 / 2017-01-28 </h1>
<ul>
<li>feat(schema): add saveErrorIfNotFound option and $where property #4924 #4004</li>
<li>feat(query): add $in implicitly if passed an array #4912 <a href="https://github.com/QuotableWater7">QuotableWater7</a></li>
<li>feat(aggregate): helper for $facet #4904 <a href="https://github.com/varunjayaraman">varunjayaraman</a></li>
<li>feat(query): add collation method #4839</li>
<li>feat(schema): propogate strict option to implicit array subschemas #4831 <a href="https://github.com/dkrosso">dkrosso</a></li>
<li>feat(aggregate): add helper for graphLookup #4819 <a href="https://github.com/varunjayaraman">varunjayaraman</a></li>
<li>feat(types): support Decimal128 #4759</li>
<li>feat(aggregate): add eachAsync() to aggregate cursor #4300</li>
<li>feat(query): add updateOne and updateMany #3997</li>
<li>feat(model): support options for insertMany #3893</li>
<li>fix(document): run validation on single nested docs if not directly modified #3884</li>
<li>feat(model): use discriminator constructor based on discriminatorKey in create() #3624</li>
<li>feat: pass collection as context to debug function #3261</li>
<li>feat(query): support push and addToSet for update validators #2933</li>
<li>perf(document): refactor registerHooksFromSchema so hooks are defined on doc prototype #2754</li>
<li>feat(types): add discriminator() function to doc arrays #2723 #1856</li>
<li>fix(populate): return an error if sorting underneath a doc array #2202</li>
</ul>
<h1>4.7.9 / 2017-01-27 </h1>
<ul>
<li>fix(query): handle casting $exists under $not #4933</li>
<li>chore: upgrade mongodb -&gt; 2.2.22 re: #4931</li>
</ul>
<h1>4.7.8 / 2017-01-23 </h1>
<ul>
<li>fix(populate): better handling for virtual populate under arrays #4923</li>
<li>docs: upgrade contributors count #4918 <a href="https://github.com/AdamZaczek">AdamZaczek</a></li>
<li>fix(query): don't set nested path default if setting parent path #4911</li>
<li>docs(promise): add missing bracket #4907</li>
<li>fix(connection): ensure error handling is consistently async #4905</li>
<li>fix: handle authMechanism in query string #4900</li>
<li>fix(document): ensure error handlers run for validate #4885</li>
</ul>
<h1>4.7.7 / 2017-01-15 </h1>
<ul>
<li>fix(utils): don't crash if to[key] is null #4881</li>
<li>fix: upgrade mongodb -&gt; 2.2.21 #4867</li>
<li>fix: add a toBSON to documents for easier querying #4866</li>
<li>fix: suppress bluebird warning #4854 <a href="https://github.com/davidwu226">davidwu226</a></li>
<li>fix(populate): handle nested virtuals in virtual populate #4851</li>
</ul>
<h1>4.7.6 / 2017-01-02 </h1>
<ul>
<li>fix(model): allow passing non-array to insertMany #4846</li>
<li>fix(populate): use base model name if no discriminator for backwards compat #4843</li>
<li>fix: allow internal validate callback to be optional #4842 <a href="https://github.com/arciisine">arciisine</a></li>
<li>fix(document): don't skip pointCut if save not defined (like in browser doc) #4841</li>
<li>chore: improve benchmarks #4838 <a href="https://github.com/billouboq">billouboq</a></li>
<li>perf: remove some unused parameters #4837 <a href="https://github.com/billouboq">billouboq</a></li>
<li>fix(query): don't call error handler if passRawResult is true and no error occurred #4836</li>
</ul>
<h1>4.7.5 / 2016-12-26 </h1>
<ul>
<li>docs(model): fix spelling mistake #4828 <a href="https://github.com/paulinoj">paulinoj</a></li>
<li>fix(aggregate): remove unhandled rejection when using aggregate.then() #4824</li>
<li>perf: remove try/catch that kills optimizer #4821</li>
<li>fix(model): handles populating with discriminators that may not have a ref #4817</li>
<li>fix(document): handle setting array of discriminators #3575</li>
</ul>
<h1>4.7.4 / 2016-12-21 </h1>
<ul>
<li>docs: fix typo #4810 <a href="https://github.com/GEEKIAM">GEEKIAM</a></li>
<li>fix(query): timestamps with $push + $each #4805</li>
<li>fix(document): handle buffers correctly in minimize #4800</li>
<li>fix: don't disallow overwriting default and cast fns #4795 <a href="https://github.com/pdspicer">pdspicer</a></li>
<li>fix(document): don't convert single nested docs to POJOs #4793</li>
<li>fix(connection): handle reconnect to replica set correctly #4972 <a href="https://github.com/gfzabarino">gfzabarino</a></li>
</ul>
<h1>4.7.3 / 2016-12-16 </h1>
<ul>
<li>fix: upgrade mongodb driver -&gt; 2.2.16 for several bug fixes and 3.4 support #4799</li>
<li>fix(model): ensure discriminator key is correct for child schema on discriminator #4790</li>
<li>fix(document): handle mark valid in subdocs correctly #4778</li>
<li>fix(query): check for objects consistently #4775</li>
</ul>
<h1>4.7.2 / 2016-12-07 </h1>
<ul>
<li>test(populate): fix justOne test #4772 <a href="https://github.com/cblanc">cblanc</a></li>
<li>chore: fix benchmarks #4769 <a href="https://github.com/billouboq">billouboq</a></li>
<li>fix(document): handle setting subdoc to null after setting parent doc #4766</li>
<li>fix(query): support passRawResult with lean #4762 #4761 <a href="https://github.com/mhfrantz">mhfrantz</a></li>
<li>fix(query): throw StrictModeError if upsert with nonexisting field in condition #4757</li>
<li>test: fix a couple of sort tests #4756 <a href="https://github.com/japod">japod</a></li>
<li>chore: upgrade mongodb driver -&gt; 2.2.12 #4753 <a href="https://github.com/mdlavin">mdlavin</a></li>
<li>fix(query): handle update with upsert and overwrite correctly #4749</li>
</ul>
<h1>4.7.1 / 2016-11-30 </h1>
<ul>
<li>fix(schema): throw error if you use prototype as a schema path #4746</li>
<li>fix(schema): throw helpful error if you define a virtual with the same path as a real path #4744</li>
<li>fix(connection): make createConnection not throw rejected promises #4742</li>
<li>fix(populate): allow specifiying options in model schema #4741</li>
<li>fix(document): handle selected nested elements with defaults #4739</li>
<li>fix(query): add model to cast error if possible #4729</li>
<li>fix(query): handle timestamps with overwrite #4054</li>
</ul>
<h1>4.7.0 / 2016-11-23 </h1>
<ul>
<li>docs: clean up schematypes #4732 <a href="https://github.com/kidlj">kidlj</a></li>
<li>perf: only get stack when necessary with VersionError #4726 <a href="https://github.com/Sebmaster">Sebmaster</a></li>
<li>fix(query): ensure correct casting when setting array element #4724</li>
<li>fix(connection): ensure db name gets set when you pass 4 params #4721</li>
<li>fix: prevent TypeError in node v7 #4719 #4706</li>
<li>feat(document): support .set() on virtual subpaths #4716</li>
<li>feat(populate): support populate virtuals on nested schemas #4715</li>
<li>feat(querycursor): support transform option and .map() #4714 #4705 <a href="https://github.com/cblanc">cblanc</a></li>
<li>fix(document): dont set defaults on not-selected nested paths #4707</li>
<li>fix(populate): don't throw if empty string passed to populate #4702</li>
<li>feat(model): add <code>loadClass()</code> function for importing schema from ES6 class #4668 <a href="https://github.com/rockmacaca">rockmacaca</a></li>
</ul>
<h1>4.6.8 / 2016-11-14 </h1>
<ul>
<li>fix(querycursor): clear stack when iterating onto next doc #4697</li>
<li>fix: handle null keys in validation error #4693 #4689 <a href="https://github.com/arciisine">arciisine</a></li>
<li>fix(populate): handle pre init middleware correctly with populate virtuals #4683</li>
<li>fix(connection): ensure consistent return value for open and openSet #4659</li>
<li>fix(schema): handle falsy defaults for arrays #4620</li>
</ul>
<h1>4.6.7 / 2016-11-10 </h1>
<ul>
<li>fix(document): only invalidate in subdoc if using update validators #4681</li>
<li>fix(document): don't create subdocs when excluded in projection #4669</li>
<li>fix(document): ensure single embedded schema validator runs with correct context #4663</li>
<li>fix(document): make sure to depopulate top level for sharding #4658</li>
<li>fix(connection): throw more helpful error when .model() called incorrectly #4652</li>
<li>fix(populate): throw more descriptive error when trying to populate a virtual that doesn't have proper options #4602</li>
<li>fix(document): ensure subtype gets set properly when saving with a buffer id #4506</li>
<li>fix(query): handle setDefaultsOnInsert with defaults on doc arrays #4456</li>
<li>fix(drivers): make debug output better by calling toBSON() #4356</li>
</ul>
<h1>4.6.6 / 2016-11-03 </h1>
<ul>
<li>chore: upgrade deps #4674 <a href="https://github.com/TrejGun">TrejGun</a></li>
<li>chore: run tests on node v7 #4673 <a href="https://github.com/TrejGun">TrejGun</a></li>
<li>perf: make setDefaultsOnInsert more efficient if upsert is off #4672 <a href="https://github.com/CamHenlin">CamHenlin</a></li>
<li>fix(populate): ensure document array is returned #4656</li>
<li>fix(query): cast doc arrays with positionals correctly for update #4655</li>
<li>fix(document): ensure single nested doc validators run with correct context #4654</li>
<li>fix: handle reconnect failed error in new version of driver #4653 <a href="https://github.com/loris">loris</a></li>
<li>fix(populate): if setting a populated doc, take its id #4632</li>
<li>fix(populate): handle populated virtuals in init #4618</li>
</ul>
<h1>4.6.5 / 2016-10-23 </h1>
<ul>
<li>docs: fix grammar issues #4642 #4640 #4639 <a href="https://github.com/silvermanj7">silvermanj7</a></li>
<li>fix(populate): filter out nonexistant values for dynref #4637</li>
<li>fix(query): handle $type as a schematype operator #4632</li>
<li>fix(schema): better handling for uppercase: false and lowercase: false #4622</li>
<li>fix(query): don't run transforms on updateForExec() #4621</li>
<li>fix(query): handle id = 0 in findById #4610</li>
<li>fix(query): handle buffers in mergeClone #4609</li>
<li>fix(document): handle undefined with conditional validator for validateSync #4607</li>
<li>fix: upgrade to mongodb driver 2.2.11 #4581</li>
<li>docs(schematypes): clarify schema.path() #4518</li>
<li>fix(query): ensure path is defined before checking in timestamps #4514</li>
<li>fix(model): set version key in upsert #4505</li>
<li>fix(document): never depopulate top-level doc #3057</li>
<li>refactor: ensure sync for setting non-capped collections #2690</li>
</ul>
<h1>4.6.4 / 2016-10-16 </h1>
<ul>
<li>fix(query): cast $not correctly #4616 #4592 <a href="https://github.com/prssn">prssn</a></li>
<li>fix: address issue with caching global plugins #4608 #4601 <a href="https://github.com/TrejGun">TrejGun</a></li>
<li>fix(model): make sure to depopulate in insertMany #4590</li>
<li>fix(model): buffer autoIndex if bufferCommands disabled #4589</li>
<li>fix(populate): copy ids array before modifying #4585</li>
<li>feat(schema): add retainKeyOrder prop #4542</li>
<li>fix(document): return isModified true for children of direct modified paths #4528</li>
<li>fix(connection): add dropDatabase() helper #4490</li>
<li>fix(model): add usePushEach option for schemas #4455</li>
<li>docs(connections): add some warnings about buffering #4413</li>
<li>fix: add ability to set promise implementation in browser #4395</li>
</ul>
<h1>4.6.3 / 2016-10-05 </h1>
<ul>
<li>fix(document): ensure single nested docs get initialized correctly when setting nested paths #4578</li>
<li>fix: turn off transforms when writing nested docs to db #4574</li>
<li>fix(document): don't set single nested subdocs to null when removing parent doc #4566</li>
<li>fix(model): ensure versionKey gets set in insertMany #4561</li>
<li>fix(schema): handle typeKey in arrays #4548</li>
<li>feat(schema): set $implicitlyCreated on schema if created by interpretAsType #4443</li>
</ul>
<h1>4.6.2 / 2016-09-30 </h1>
<ul>
<li>chore: upgrade to async 2.0.1 internally #4579 <a href="https://github.com/billouboq">billouboq</a></li>
<li>fix(types): ensure nested single doc schema errors reach update validators #4557 #4519</li>
<li>fix(connection): handle rs names with leading numbers (muri 1.1.1) #4556</li>
<li>fix(model): don't throw if method name conflicts with Object.prototype prop #4551</li>
<li>docs: fix broken link #4544 <a href="https://github.com/VFedyk">VFedyk</a></li>
<li>fix: allow overwriting model on mongoose singleton #4541 <a href="https://github.com/Nainterceptor">Nainterceptor</a></li>
<li>fix(document): don't use init: true when building doc defaults #4540</li>
<li>fix(connection): use replSet option if replset not specified #4535</li>
<li>fix(query): cast $not objects #4495</li>
</ul>
<h1>4.6.1 / 2016-09-20 </h1>
<ul>
<li>fix(query): improve handling of $not with $elemMatch #4531 #3719 <a href="https://github.com/timbowhite">timbowhite</a></li>
<li>fix: upgrade mongodb -&gt; 2.2.10 #4517</li>
<li>chore: fix webpack build issue #4512 <a href="https://github.com/saiichihashimoto">saiichihashimoto</a></li>
<li>fix(query): emit error on next tick when exec callback errors #4500</li>
<li>test: improve test case #4496 <a href="https://github.com/isayme">isayme</a></li>
<li>fix(schema): use same check for array types and top-level types #4493</li>
<li>style: fix indentation in docs #4489 <a href="https://github.com/dhurlburtusa">dhurlburtusa</a></li>
<li>fix(schema): expose original object passed to constructor #4486</li>
<li>fix(query): handle findOneAndUpdate with array of arrays #4484 #4470 <a href="https://github.com/fedotov">fedotov</a></li>
<li>feat(document): add $ignore to make a path ignored #4480</li>
<li>fix(query): properly handle setting single embedded in update #4475 #4466 #4465</li>
<li>fix(updateValidators): handle single nested schema subpaths correctly #4479</li>
<li>fix(model): throw handy error when method name conflicts with property name #4475</li>
<li>fix(schema): handle .set() with array field #4472</li>
<li>fix(query): check nested path when avoiding double-validating Mixed #4441</li>
<li>fix(schema): handle calling path.trim() with no args correctly #4042</li>
</ul>
<h1>4.6.0 / 2016-09-02 </h1>
<ul>
<li>docs(document): clarify the findById and findByIdAndUpdate examples #4471 <a href="https://github.com/mdcanham">mdcanham</a></li>
<li>docs(schematypes): add details re: options #4452</li>
<li>docs(middleware): add docs for insertMany hooks #4451</li>
<li>fix(schema): create new array when copying from existing object to preserve change tracking #4449</li>
<li>docs: fix typo in index.jade #4448</li>
<li>fix(query): allow array for populate options #4446</li>
<li>fix(model): create should not cause unhandle reject promise #4439</li>
<li>fix: upgrade to mongodb driver 2.2.9 #4363 #4341 #4311 (see <a href="https://github.com/mongodb/js-bson/commit/aa0b54597a0af28cce3530d2144af708e4b66bf0#commitcomment-18850498">comments here</a> if you use node 0.10)</li>
</ul>
<h1>4.5.10 / 2016-08-23 </h1>
<ul>
<li>docs: fix typo on documents.jade #4444 <a href="https://github.com/Gabri3l">Gabri3l</a></li>
<li>chore: upgrade mocha to 3.0.2 #4437 <a href="https://github.com/TrejGun">TrejGun</a></li>
<li>fix: subdocuments causing error with parent timestamp on update #4434 <a href="https://github.com/dyang108">dyang108</a></li>
<li>fix(query): don't crash if timestamps on and update doesn't have a path #4425 #4424 #4418</li>
<li>fix(query): ensure single nested subdoc is hydrated when running update validators #4420</li>
<li>fix(query): cast non-$geometry operators for $geoWithin #4419</li>
<li>docs: update contributor count #4415 <a href="https://github.com/AdamZaczek">AdamZaczek</a></li>
<li>docs: add more clarification re: the index event #4410</li>
<li>fix(document): only skip modifying subdoc path if parent is direct modified #4405</li>
<li>fix(schema): throw cast error if provided date invalid #4404</li>
<li>feat(error): use util.inspect() so CastError never prints "[object Object]" #4398</li>
<li>fix(model): dont error if the discriminator key is unchanged #4387</li>
<li>fix(query): don't throw unhandled rejection with bluebird when using cbs #4379</li>
</ul>
<h1>4.5.9 / 2016-08-14 </h1>
<ul>
<li>docs: add mixed schema doc for Object literal #4400 <a href="https://github.com/Kikobeats">Kikobeats</a></li>
<li>fix(query): cast $geoWithin and convert mongoose objects to POJOs before casting #4392</li>
<li>fix(schematype): dont cast defaults without parent doc #4390</li>
<li>fix(query): disallow passing empty string to findOne() #4378</li>
<li>fix(document): set single nested doc isNew correctly #4369</li>
<li>fix(types): checks field name correctly with nested arrays and populate #4365</li>
<li>fix(drivers): make debug output copy-pastable into mongodb shell #4352</li>
<li>fix(services): run update validators on nested paths #4332</li>
<li>fix(model): handle typeKey with discriminators #4339</li>
<li>fix(query): apply timestamps to child schemas when explicitly specified in update #4049</li>
<li>fix(schema): set prefix as nested path with add() #1730</li>
</ul>
<h1>4.5.8 / 2016-08-01 </h1>
<ul>
<li>fix(model): make changing the discriminator key cause a cast error #4374</li>
<li>fix(query): pass projection fields to cursor #4371 #4342 <a href="https://github.com/Corei13">Corei13</a></li>
<li>fix(document): support multiple paths for isModified #4370 <a href="https://github.com/adambuczynski">adambuczynski</a></li>
<li>fix(querycursor): always cast fields before returning cursor #4355</li>
<li>fix(query): support projection as alias for fields in findOneAndUpdate #4315</li>
<li>fix(schema): treat index false + unique false as no index #4304</li>
<li>fix(types): dont mark single nested subpath as modified if whole doc already modified #4224</li>
</ul>
<h1>4.5.7 / 2016-07-25 </h1>
<ul>
<li>fix(document): ensure no unhandled rejections if callback specified for save #4364</li>
</ul>
<h1>4.5.6 / 2016-07-23 </h1>
<ul>
<li>fix(schema): don't overwrite createdAt if it isn't selected #4351 <a href="https://github.com/tusbar">tusbar</a></li>
<li>docs(api): fix link to populate() and add a new one from depopulate() #4345 <a href="https://github.com/Delapouite">Delapouite</a></li>
<li>fix(types): ownerDocument() works properly with single nested docs #4344 <a href="https://github.com/vichle">vichle</a></li>
<li>fix(populate): dont use findOne when justOne option set #4329</li>
<li>fix(document): dont trigger .then() deprecated warning when calling doc.remove() #4291</li>
<li>docs(connection): add promiseLibrary option #4280</li>
<li>fix(plugins): apply global plugins to subschemas #4271</li>
<li>fix(model): ensure <code>ensureIndex()</code> never calls back in the same tick #4246</li>
<li>docs(schema): improve post hook docs on schema #4238</li>
</ul>
<h1>4.5.5 / 2016-07-18 </h1>
<ul>
<li>fix(document): handle setting root to empty obj if minimize false #4337</li>
<li>fix: downgrade to mongodb 2.1.18 #4335 #4334 #4328 #4323</li>
<li>perf(types): remove defineProperty usage in documentarray #4333</li>
<li>fix(query): correctly pass model in .toConstructor() #4318</li>
<li>fix(services): avoid double-validating mixed types with update validators #4305</li>
<li>docs(middleware): add docs describing error handling middleware #4229</li>
<li>fix(types): throw correct error when invalidating doc array #3602</li>
</ul>
<h1>4.5.4 / 2016-07-11 </h1>
<ul>
<li>fix(types): fix removing embedded documents #4309 <a href="https://github.com/RoCat">RoCat</a></li>
<li>docs: various docs improvements #4302 #4294 <a href="https://github.com/simonxca">simonxca</a></li>
<li>fix: upgrade mongodb -&gt; 2.1.21 #4295 #4202 <a href="https://github.com/RoCat">RoCat</a></li>
<li>fix(populate): convert single result to array for virtual populate because of lean #4288</li>
<li>fix(populate): handle empty results for populate virtuals properly #4285 #4284</li>
<li>fix(query): dont cast $inc to number if type is long #4283</li>
<li>fix(types): allow setting single nested doc to null #4281</li>
<li>fix(populate): handle deeply nested virtual populate #4278</li>
<li>fix(document): allow setting empty obj if strict mode is false #4274</li>
<li>fix(aggregate): allow passing obj to .unwind() #4239</li>
<li>docs(document): add return statements to transform examples #1963</li>
</ul>
<h1>4.5.3 / 2016-06-30 </h1>
<ul>
<li>fix(query): pass correct options to QueryCursor #4277 #4266</li>
<li>fix(querycursor): handle lean option correctly #4276 <a href="https://github.com/gchudnov">gchudnov</a></li>
<li>fix(document): fix error handling when no error occurred #4275</li>
<li>fix(error): use strict mode for version error #4272</li>
<li>docs(populate): fix crashing compilation for populate.jade #4267</li>
<li>fix(populate): support <code>justOne</code> option for populate virtuals #4263</li>
<li>fix(populate): ensure model param gets used for populate virtuals #4261 #4243</li>
<li>fix(querycursor): add ability to properly close the cursor #4258</li>
<li>docs(model): correct link to Document #4250</li>
<li>docs(populate): correct path for refPath populate #4240</li>
<li>fix(document): support validator.isEmail as validator #4064</li>
</ul>
<h1>4.5.2 / 2016-06-24 </h1>
<ul>
<li>fix(connection): add checks for collection presence for <code>onOpen</code> and <code>onClose</code> #4259 <a href="https://github.com/nodkz">nodkz</a></li>
<li>fix(cast): allow strings for $type operator #4256</li>
<li>fix(querycursor): support lean() #4255 <a href="https://github.com/pyramation">pyramation</a></li>
<li>fix(aggregate): allow setting noCursorTimeout option #4241</li>
<li>fix(document): handle undefined for Array.pull #4222 <a href="https://github.com/Sebmaster">Sebmaster</a></li>
<li>fix(connection): ensure promise.catch() catches initial connection error #4135</li>
<li>fix(document): show additional context for VersionError #2633</li>
</ul>
<h1>4.5.1 / 2016-06-18 </h1>
<ul>
<li>fix(model): ensure wrapped insertMany() returns a promise #4237</li>
<li>fix(populate): dont overwrite populateVirtuals when populating multiple paths #4234</li>
<li>docs(model): clarify relationship between create() and save() #4233</li>
<li>fix(types): handle option param in subdoc remove() #4231 <a href="https://github.com/tdebarochez">tdebarochez</a></li>
<li>fix(document): dedupe modified paths #4226 #4223 <a href="https://github.com/adambuczynski">adambuczynski</a></li>
<li>fix(model): don't modify user-provided options object #4221</li>
<li>fix(document): handle setting nested path to empty object #4218 #4182</li>
<li>fix(document): clean subpaths when removing single nested #4216</li>
<li>fix(document): don't force transform on subdocs with inspect #4213</li>
<li>fix(error): allow setting .messages object #4207</li>
</ul>
<h1>4.5.0 / 2016-06-13 </h1>
<ul>
<li>feat(query): added Query.prototype.catch() #4215 #4173 <a href="https://github.com/adambuczynski">adambuczynski</a></li>
<li>feat(query): add Query.prototype.cursor() as a .stream() alternative #4117 #3637 #1907</li>
<li>feat(document): add markUnmodified() function #4092 <a href="https://github.com/vincentcr">vincentcr</a></li>
<li>feat(aggregate): convert aggregate object to a thenable #3995 #3946 <a href="https://github.com/megagon">megagon</a></li>
<li>perf(types): remove defineProperties call for array (<b>Note:</b> Because of this, a mongoose array will no longer <code>assert.deepEqual()</code> a plain old JS array) #3886</li>
<li>feat(model): add hooks for insertMany() #3846</li>
<li>feat(schema): add support for custom query methods #3740 #2372</li>
<li>feat(drivers): emit error on 'serverClosed' because that means that reconnect failed #3615</li>
<li>feat(model): emit error event when callback throws exception #3499</li>
<li>feat(model): inherit options from discriminator base schema #3414 #1818</li>
<li>feat(populate): expose mongoose-populate-virtuals inspired populate API #2562</li>
<li>feat(document): trigger remove hooks on subdocs when removing parent #2348</li>
<li>feat(schema): add support for express-style error handling middleware #2284</li>
<li>fix(model): disallow setting discriminator key #2041</li>
<li>feat(schema): add support for nested arrays #1361</li>
</ul>
<h1>4.4.20 / 2016-06-05 </h1>
<ul>
<li>docs: clarify command buffering when using driver directly #4195</li>
<li>fix(promise): correct broken mpromise .catch() #4189</li>
<li>fix(document): clean modified subpaths when set path to empty obj #4182</li>
<li>fix(query): support minDistance with query casting and <code>.near()</code> #4179</li>
<li>fix(model): remove unnecessary .save() promise #4177</li>
<li>fix(schema): cast all valid ObjectId strings to object ids #3365</li>
<li>docs: remove unclear "unsafe" term in query docs #3282</li>
</ul>
<h1>4.4.19 / 2016-05-21 </h1>
<ul>
<li>fix(model): handle insertMany if timestamps not set #4171</li>
</ul>
<h1>4.4.18 / 2016-05-21 </h1>
<ul>
<li>docs: add missing period #4170 <a href="https://github.com/gitname">gitname</a></li>
<li>docs: change build badge to svg #4158 <a href="https://github.com/a0viedo">a0viedo</a></li>
<li>fix(model): update timestamps when setting <code>createdAt</code> #4155</li>
<li>fix(utils): make sure to require in document properly #4152</li>
<li>fix(model): throw overwrite error when discriminator name conflicts #4148</li>
</ul>
<h1>4.4.17 / 2016-05-13 </h1>
<ul>
<li>docs: remove repetition in QueryStream docs #4147 <a href="https://github.com/hugoabonizio">hugoabonizio</a></li>
<li>fix(document): dont double-validate doc array elements #4145</li>
<li>fix(document): call required function with correct scope #4142 <a href="https://github.com/JedWatson">JedWatson</a></li>
</ul>
<h1>4.4.16 / 2016-05-09 </h1>
<ul>
<li>refactor(document): use function reference #4133 <a href="https://github.com/dciccale">dciccale</a></li>
<li>docs(querystream): clarify <code>destroy()</code> and close event #4126 <a href="https://github.com/AnthonyCC">AnthonyCC</a></li>
<li>test: make before hook fail fast if it can't connect #4121</li>
<li>docs: add description of CastError constructor params #4120</li>
<li>fix(schematype): ensure single embedded defaults have $parent #4115</li>
<li>fix(document): mark nested paths for validation #4111</li>
<li>fix(schema): make sure element is always a subdoc in doc array validation #3816</li>
</ul>
<h1>4.4.15 / 2016-05-06 </h1>
<ul>
<li>fix(schema): support overwriting array default #4109</li>
<li>fix(populate): assign values when resolving each populate #4104</li>
<li>fix(aggregate): dont send async option to server #4101</li>
<li>fix(model): ensure isNew set to false after insertMany #4099</li>
<li>fix(connection): emit on error if listeners and no callback #4098</li>
<li>fix(document): treat required fn that returns false as required: false #4094</li>
</ul>
<h1>4.4.14 / 2016-04-27 </h1>
<ul>
<li>fix: upgrade mongodb -&gt; 2.1.18 #4102</li>
<li>feat(connection): allow setting mongos as a uri query param #4093 #4035 <a href="https://github.com/burtonjc">burtonjc</a></li>
<li>fix(populate): make sure to use correct assignment order for each model #4073</li>
<li>fix(schema): add complete set of geospatial operators for single embedded subdocs #4014</li>
</ul>
<h1>3.8.40 / 2016-04-24 </h1>
<ul>
<li>upgraded; mquery -&gt; 1.10.0 #3989</li>
</ul>
<h1>4.4.13 / 2016-04-21 </h1>
<ul>
<li>docs: add docs favicons #4082 <a href="https://github.com/robertjustjones">robertjustjones</a></li>
<li>docs(model): correct Model.remove() return value #4075 <a href="https://github.com/Jokero">Jokero</a></li>
<li>fix(query): add $geoWithin query casting for single embedded docs #4044</li>
<li>fix(schema): handle setting trim option to falsy #4042</li>
<li>fix(query): handle setDefaultsOnInsert with empty update #3835</li>
</ul>
<h1>4.4.12 / 2016-04-08 </h1>
<ul>
<li>docs(query): document context option for update and findOneAndUpdate #4055</li>
<li>docs(query): correct link to $geoWithin docs #4050</li>
<li>fix(project): upgrade to mongodb driver 2.1.16 #4048 <a href="https://github.com/schmalliso">schmalliso</a></li>
<li>docs(validation): fix validation docs #4028</li>
<li>fix(types): improve .id() check for document arrays #4011</li>
<li>fix(query): remove premature return when using $rename #3171</li>
<li>docs(connection): clarify relationship between models and connections #2157</li>
</ul>
<h1>4.4.11 / 2016-04-03 </h1>
<ul>
<li>fix: upgrade to mongodb driver 2.1.14 #4036 #4030 #3945</li>
<li>fix(connection): allow connecting with { mongos: true } to handle query params #4032 <a href="https://github.com/burtonjc">burtonjc</a></li>
<li>docs(connection): add autoIndex example #4026 <a href="https://github.com/tilleps">tilleps</a></li>
<li>fix(query): handle passRawResult option when zero results #4023</li>
<li>fix(populate): clone options before modifying #4022</li>
<li>docs: add missing whitespace #4019 <a href="https://github.com/chenxsan">chenxsan</a></li>
<li>chore: upgrade to ESLint 2.4.0 #4015 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>fix(types): single nested subdocs get ids by default #4008</li>
<li>chore(project): add dependency status badge #4007 <a href="http://github.com/Maheshkumar-Kakade">Maheshkumar-Kakade</a></li>
<li>fix: make sure timestamps don't trigger unnecessary updates #4005 #3991 <a href="https://github.com/tommarien">tommarien</a></li>
<li>fix(document): inspect inherits schema options #4001</li>
<li>fix(populate): don't mark populated path as modified if setting to object w/ same id #3992</li>
<li>fix(document): support kind argument to invalidate #3965</li>
</ul>
<h1>4.4.10 / 2016-03-24 </h1>
<ul>
<li>fix(document): copy isNew when copying a document #3982</li>
<li>fix(document): don't override defaults with undefined keys #3981</li>
<li>fix(populate): merge multiple deep populate options for the same path #3974</li>
</ul>
<h1>4.4.9 / 2016-03-22 </h1>
<ul>
<li>fix: upgrade mongodb -&gt; 2.1.10 re <a href="https://jira.mongodb.org/browse/NODE-679">https://jira.mongodb.org/browse/NODE-679</a> #4010</li>
<li>docs: add syntax highlighting for acquit examples #3975</li>
</ul>
<h1>4.4.8 / 2016-03-18 </h1>
<ul>
<li>docs(aggregate): clarify promises #3990 <a href="https://github.com/megagon">megagon</a></li>
<li>fix: upgrade mquery -&gt; 1.10 #3988 <a href="https://github.com/matskiv">matskiv</a></li>
<li>feat(connection): 'all' event for repl sets #3986 <a href="https://github.com/xizhibei">xizhibei</a></li>
<li>docs(types): clarify Array.pull #3985 <a href="https://github.com/seriousManual">seriousManual</a></li>
<li>feat(query): support array syntax for .sort() via mquery 1.9 #3980</li>
<li>fix(populate): support &gt; 3 level nested populate #3973</li>
<li>fix: MongooseThenable exposes connection correctly #3972</li>
<li>docs(connection): add note about reconnectTries and reconnectInterval #3969</li>
<li>feat(document): invalidate returns the new validationError #3964</li>
<li>fix(query): .eq() as shorthand for .equals #3953 <a href="https://github.com/Fonger">Fonger</a></li>
<li>docs(connection): clarify connection string vs passed options #3941</li>
<li>docs(query): select option for findOneAndUpdate #3933</li>
<li>fix(error): ValidationError.properties no longer enumerable #3925</li>
<li>docs(validation): clarify how required validators work with nested schemas #3915</li>
<li>fix: upgrade mongodb driver -&gt; 2.1.8 to make partial index errors more sane #3864</li>
</ul>
<h1>4.4.7 / 2016-03-11 </h1>
<ul>
<li>fix(query): stop infinite recursion caused by merging a mongoose buffer #3961</li>
<li>fix(populate): handle deep populate array -&gt; array #3954</li>
<li>fix(schema): allow setting timestamps with .set() #3952 #3951 #3907 <a href="https://github.com/Fonger">Fonger</a></li>
<li>fix: MongooseThenable doesn't overwrite constructors #3940</li>
<li>fix(schema): don't cast boolean to date #3935</li>
<li>fix(drivers): support sslValidate in connection string #3929</li>
<li>fix(types): correct markModified() for single nested subdocs #3910</li>
<li>fix(drivers): catch and report any errors that occur in driver methods #3906</li>
<li>fix(populate): get subpopulate model correctly when array under nested #3904</li>
<li>fix(document): allow fields named 'pre' and 'post' #3902</li>
<li>docs(query): clarify runValidators and setDefaultsOnInsert options #3892</li>
<li>docs(validation): show how to use custom required messages in schema #2616</li>
</ul>
<h1>4.4.6 / 2016-03-02 </h1>
<ul>
<li>fix: upgrade mongodb driver to 2.1.7 #3938</li>
<li>docs: fix plugins link #3917 #3909 <a href="https://github.com/fbertone">fbertone</a></li>
<li>fix(query): sort+select with count works #3914</li>
<li>fix(query): improve mergeUpdate's ability to handle nested docs #3890</li>
</ul>
<h1>4.4.5 / 2016-02-24 </h1>
<ul>
<li>fix(query): ability to select a length field (upgrade to mquery 1.7.0) #3903</li>
<li>fix: include nested CastError as reason for array CastError #3897 <a href="https://github.com/kotarou3">kotarou3</a></li>
<li>fix(schema): check for doc existence before taking fields #3889</li>
<li>feat(schema): useNestedStrict option to take nested strict mode for update #3883</li>
<li>docs(validation): clarify relationship between required and checkRequired #3822</li>
<li>docs(populate): dynamic reference docs #3809</li>
<li>docs: expand dropdown when clicking on file name #3807</li>
<li>docs: plugins.mongoosejs.io is up #3127</li>
<li>fix(schema): ability to add a virtual with same name as removed path #2398</li>
</ul>
<h1>4.4.4 / 2016-02-17 </h1>
<ul>
<li>fix(schema): handle field selection when casting single nested subdocs #3880</li>
<li>fix(populate): populating using base model with multiple child models in result #3878</li>
<li>fix: ability to properly use return value of <code>mongoose.connect()</code> #3874</li>
<li>fix(populate): dont hydrate populated subdoc if lean option set #3873</li>
<li>fix(connection): dont re-auth if already connected with useDb #3871</li>
<li>docs: cover how to set underlying driver's promise lib #3869</li>
<li>fix(document): handle conflicting names in validation errors with subdocs #3867</li>
<li>fix(populate): set undefined instead of null consistently when populate couldn't find results #3859</li>
<li>docs: link to <code>execPopulate()</code> in <code>doc.populate()</code> docs #3836</li>
<li>docs(plugin): link to the <code>mongoose.plugin()</code> function #3732</li>
</ul>
<h1>4.4.3 / 2016-02-09 </h1>
<ul>
<li>fix: upgrade to mongodb 2.1.6 to remove kerberos log output #3861 #3860 <a href="https://github.com/cartuchogl">cartuchogl</a></li>
<li>fix: require('mongoose') is no longer a pseudo-promise #3856</li>
<li>fix(query): update casting for single nested docs #3820</li>
<li>fix(populate): deep populating multiple paths with same options #3808</li>
<li>docs(middleware): clarify save/validate hook order #1149</li>
</ul>
<h1>4.4.2 / 2016-02-05 </h1>
<ul>
<li>fix(aggregate): handle calling .cursor() with no options #3855</li>
<li>fix: upgrade mongodb driver to 2.1.5 for GridFS memory leak fix #3854</li>
<li>docs: fix schematype.html conflict #3853 #3850 #3843</li>
<li>fix(model): bluebird unhandled rejection with ensureIndexes() on init #3837</li>
<li>docs: autoIndex option for createConnection #3805</li>
</ul>
<h1>4.4.1 / 2016-02-03 </h1>
<ul>
<li>fix: linting broke some cases where we use <code>== null</code> as shorthand #3852</li>
<li>docs: fix up schematype.html conflict #3848 #3843 <a href="https://github.com/mynameiscoffey">mynameiscoffey</a></li>
<li>fix: backwards breaking change with <code>.connect()</code> return value #3847</li>
<li>docs: downgrade dox and highlight.js to fix docs build #3845</li>
<li>docs: clean up typo #3842 <a href="https://github.com/Flash-">Flash-</a></li>
<li>fix(document): storeShard handles undefined values #3841</li>
<li>chore: more linting #3838 <a href="https://github.com/TrejGun">TrejGun</a></li>
<li>fix(schema): handle <code>text: true</code> as a way to declare a text index #3824</li>
</ul>
<h1>4.4.0 / 2016-02-02 </h1>
<ul>
<li>docs: fix expireAfterSeconds index option name #3831 <a href="https://github.com/Flash-">Flash-</a></li>
<li>chore: run lint after test #3829 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>chore: use power-assert instead of assert #3828 <a href="https://github.com/TrejGun">TrejGun</a></li>
<li>chore: stricter lint #3827 <a href="https://github.com/TrejGun">TrejGun</a></li>
<li>feat(types): casting moment to date #3813 <a href="https://github.com/TrejGun">TrejGun</a></li>
<li>chore: comma-last lint for test folder #3810 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>fix: upgrade async mpath, mpromise, muri, and sliced #3801 <a href="https://github.com/TrejGun">TrejGun</a></li>
<li>fix(query): geo queries now return proper ES2015 promises #3800 <a href="https://github.com/TrejGun">TrejGun</a></li>
<li>perf(types): use <code>Object.defineProperties()</code> for array #3799 <a href="https://github.com/TrejGun">TrejGun</a></li>
<li>fix(model): mapReduce, ensureIndexes, remove, and save properly return ES2015 promises #3795 #3628 #3595 <a href="https://github.com/TrejGun">TrejGun</a></li>
<li>docs: fixed dates in History.md #3791 <a href="https://github.com/Jokero">Jokero</a></li>
<li>feat: connect, open, openSet, and disconnect return ES2015 promises #3790 #3622 <a href="https://github.com/TrejGun">TrejGun</a></li>
<li>feat: custom type for int32 via mongoose-int32 npm package #3652 #3102</li>
<li>feat: basic custom schema type API #995</li>
<li>feat(model): <code>insertMany()</code> for more performant bulk inserts #723</li>
</ul>
<h1>4.3.7 / 2016-01-23 </h1>
<ul>
<li>docs: grammar fix in timestamps docs #3786 <a href="https://github.com/zclancy">zclancy</a></li>
<li>fix(document): setting nested populated docs #3783 <a href="https://github.com/slamuu">slamuu</a></li>
<li>fix(document): don't call post save hooks twice for pushed docs #3780</li>
<li>fix(model): handle <code>_id=0</code> correctly #3776</li>
<li>docs(middleware): async post hooks #3770</li>
<li>docs: remove confusing sentence #3765 <a href="https://github.com/marcusmellis89">marcusmellis89</a></li>
</ul>
<h1>3.8.39 / 2016-01-15 </h1>
<ul>
<li>fixed; casting a number to a buffer #3764</li>
<li>fixed; enumerating virtual property with nested objects #3743 <a href="https://github.com/kusold">kusold</a></li>
</ul>
<h1>4.3.6 / 2016-01-15 </h1>
<ul>
<li>fix(types): casting a number to a buffer #3764</li>
<li>fix: add "listener" to reserved keywords #3759</li>
<li>chore: upgrade uglify #3757 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>fix: broken execPopulate() in 4.3.5 #3755 #3753</li>
<li>fix: ability to remove() a single embedded doc #3754</li>
<li>style: comma-last in test folder #3751 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>docs: clarify versionKey option #3747</li>
<li>fix: improve colorization for arrays #3744 <a href="https://github.com/TrejGun">TrejGun</a></li>
<li>fix: webpack build #3713</li>
</ul>
<h1>4.3.5 / 2016-01-09 </h1>
<ul>
<li>fix(query): throw when 4th parameter to update not a function #3741 <a href="https://github.com/kasselTrankos">kasselTrankos</a></li>
<li>fix(document): separate error type for setting an object to a primitive #3735</li>
<li>fix(populate): Model.populate returns ES6 promise #3734</li>
<li>fix(drivers): re-register event handlers after manual reconnect #3729</li>
<li>docs: broken links #3727</li>
<li>fix(validation): update validators run array validation #3724</li>
<li>docs: clarify the need to use markModified with in-place date ops #3722</li>
<li>fix(document): mark correct path as populated when manually populating array #3721</li>
<li>fix(aggregate): support for array pipeline argument to append #3718 <a href="https://github.com/dbkup">dbkup</a></li>
<li>docs: clarify <code>.connect()</code> callback #3705</li>
<li>fix(schema): properly validate nested single nested docs #3702</li>
<li>fix(types): handle setting documentarray of wrong type #3701</li>
<li>docs: broken links #3700</li>
<li>fix(drivers): debug output properly displays '0' #3689</li>
</ul>
<h1>3.8.38 / 2016-01-07 </h1>
<ul>
<li>fixed; aggregate.append an array #3730 <a href="https://github.com/dbkup">dbkup</a></li>
</ul>
<h1>4.3.4 / 2015-12-23 </h1>
<ul>
<li>fix: upgrade mongodb driver to 2.1.2 for repl set error #3712 <a href="https://github.com/sansmischevia">sansmischevia</a></li>
<li>docs: validation docs typo #3709 <a href="https://github.com/ivanmaeder">ivanmaeder</a></li>
<li>style: remove unused variables #3708 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>fix(schema): duck-typing for schemas #3703 <a href="https://github.com/mgcrea">mgcrea</a></li>
<li>docs: connection sample code issue #3697</li>
<li>fix(schema): duck-typing for schemas #3693 <a href="https://github.com/mgcrea">mgcrea</a></li>
<li>docs: clarify id schema option #3638</li>
</ul>
<h1>4.3.3 / 2015-12-18 </h1>
<ul>
<li>fix(connection): properly support 'replSet' as well as 'replset' #3688 <a href="https://github.com/taxilian">taxilian</a></li>
<li>fix(document): single nested doc pre hooks called before nested doc array #3687 <a href="https://github.com/aliatsis">aliatsis</a></li>
</ul>
<h1>4.3.2 / 2015-12-17 </h1>
<ul>
<li>fix(document): .set() into single nested schemas #3686</li>
<li>fix(connection): support 'replSet' as well as 'replset' option #3685</li>
<li>fix(document): bluebird unhandled rejection when validating doc arrays #3681</li>
<li>fix(document): hooks for doc arrays in single nested schemas #3680</li>
<li>fix(document): post hooks for single nested schemas #3679</li>
<li>fix: remove unused npm module #3674 <a href="https://github.com/sybarite">sybarite</a></li>
<li>fix(model): don't swallow exceptions in nested doc save callback #3671</li>
<li>docs: update keepAlive info #3667 <a href="https://github.com/ChrisZieba">ChrisZieba</a></li>
<li>fix(document): strict 'throw' throws a specific mongoose error #3662</li>
<li>fix: flakey test #3332</li>
<li>fix(query): more robust check for RegExp #2969</li>
</ul>
<h1>4.3.1 / 2015-12-11 </h1>
<ul>
<li>feat(aggregate): <code>.sample()</code> helper #3665</li>
<li>fix(query): bitwise query operators with buffers #3663</li>
<li>docs(migration): clarify <code>new</code> option and findByIdAndUpdate #3661</li>
</ul>
<h1>4.3.0 / 2015-12-09 </h1>
<ul>
<li>feat(query): support for mongodb 3.2 bitwise query operators #3660</li>
<li>style: use comma-last style consistently #3657 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>feat: upgrade mongodb driver to 2.1.0 for full MongoDB 3.2 support #3656</li>
<li>feat(aggregate): <code>.lookup()</code> helper #3532</li>
</ul>
<h1>4.2.10 / 2015-12-08 </h1>
<ul>
<li>fixed; upgraded marked #3653 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>docs; cross-db populate #3648</li>
<li>docs; update mocha URL #3646 <a href="https://github.com/ojhaujjwal">ojhaujjwal</a></li>
<li>fixed; call close callback asynchronously #3645</li>
<li>docs; virtuals.html issue #3644 <a href="https://github.com/Psarna94">Psarna94</a></li>
<li>fixed; single embedded doc casting on init #3642</li>
<li>docs; validation docs improvements #3640</li>
</ul>
<h1>4.2.9 / 2015-12-02 </h1>
<ul>
<li>docs; defaults docs #3625</li>
<li>fix; nested numeric keys causing an embedded document crash #3623</li>
<li>fix; apply path getters before virtual getters #3618</li>
<li>fix; casting for arrays in single nested schemas #3616</li>
</ul>
<h1>4.2.8 / 2015-11-25 </h1>
<ul>
<li>docs; clean up README links #3612 <a href="https://github.com/ReadmeCritic">ReadmeCritic</a></li>
<li>fix; ESLint improvements #3605 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>fix; assigning single nested subdocs #3601</li>
<li>docs; describe custom logging functions in <code>mongoose.set()</code> docs #3557</li>
</ul>
<h1>4.2.7 / 2015-11-20 </h1>
<ul>
<li>fixed; readPreference connection string option #3600</li>
<li>fixed; pulling from manually populated arrays #3598 #3579</li>
<li>docs; FAQ about OverwriteModelError #3597 <a href="https://github.com/stcruy">stcruy</a></li>
<li>fixed; setting single embedded schemas to null #3596</li>
<li>fixed; indexes for single embedded schemas #3594</li>
<li>docs; clarify projection for <code>findOne()</code> #3593 <a href="https://github.com/gunar">gunar</a></li>
<li>fixed; .ownerDocument() method on single embedded schemas #3589</li>
<li>fixed; properly throw casterror for query on single embedded schema #3580</li>
<li>upgraded; mongodb driver -&gt; 2.0.49 for reconnect issue fix #3481</li>
</ul>
<h1>4.2.6 / 2015-11-16 </h1>
<ul>
<li>fixed; ability to manually populate an array #3575</li>
<li>docs; clarify <code>isAsync</code> parameter to hooks #3573</li>
<li>fixed; use captureStackTrace if possible instead #3571</li>
<li>fixed; crash with buffer and update validators #3565 <a href="https://github.com/johnpeb">johnpeb</a></li>
<li>fixed; update casting with operators overwrite: true #3564</li>
<li>fixed; validation with single embedded docs #3562</li>
<li>fixed; inline docs inherit parents $type key #3560</li>
<li>docs; bad grammar in populate docs #3559 <a href="https://github.com/amaurymedeiros">amaurymedeiros</a></li>
<li>fixed; properly handle populate option for find() #2321</li>
</ul>
<h1>3.8.37 / 2015-11-16 </h1>
<ul>
<li>fixed; use retainKeyOrder for cloning update op #3572</li>
</ul>
<h1>4.2.5 / 2015-11-09 </h1>
<ul>
<li>fixed; handle setting fields in pre update hooks with exec #3549</li>
<li>upgraded; ESLint #3547 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>fixed; bluebird unhandled rejections with cast errors and .exec #3543</li>
<li>fixed; min/max validators handling undefined #3539</li>
<li>fixed; standalone mongos connections #3537</li>
<li>fixed; call <code>.toObject()</code> when setting a single nested doc #3535</li>
<li>fixed; single nested docs now have methods #3534</li>
<li>fixed; single nested docs with .create() #3533 #3521 <a href="https://github.com/tusbar">tusbar</a></li>
<li>docs; deep populate docs #3528</li>
<li>fixed; deep populate schema ref handling #3507</li>
<li>upgraded; mongodb driver -&gt; 2.0.48 for sort overflow issue #3493</li>
<li>docs; clarify default ids for discriminators #3482</li>
<li>fixed; properly support .update(doc) #3221</li>
</ul>
<h1>4.2.4 / 2015-11-02 </h1>
<ul>
<li>fixed; upgraded <code>ms</code> package for security vulnerability #3524 <a href="https://github.com/fhemberger">fhemberger</a></li>
<li>fixed; ESlint rules #3517 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>docs; typo in aggregation docs #3513 <a href="https://github.com/rafakato">rafakato</a></li>
<li>fixed; add <code>dontThrowCastError</code> option to .update() for promises #3512</li>
<li>fixed; don't double-cast buffers in node 4.x #3510 #3496</li>
<li>fixed; population with single embedded schemas #3501</li>
<li>fixed; pre('set') hooks work properly #3479</li>
<li>docs; promises guide #3441</li>
</ul>
<h1>4.2.3 / 2015-10-26 </h1>
<ul>
<li>docs; remove unreferenced function in middleware.jade #3506</li>
<li>fixed; handling auth with no username/password #3500 #3498 #3484 <a href="https://github.com/mleanos">mleanos</a></li>
<li>fixed; more ESlint rules #3491 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>fixed; swallowing exceptions in save callback #3478</li>
<li>docs; fixed broken links in subdocs guide #3477</li>
<li>fixed; casting booleans to numbers #3475</li>
<li>fixed; report CastError for subdoc arrays in findOneAndUpdate #3468</li>
<li>fixed; geoNear returns ES6 promise #3458</li>
</ul>
<h1>4.2.2 / 2015-10-22 </h1>
<ul>
<li>fixed; go back to old pluralization code #3490</li>
</ul>
<h1>4.2.1 / 2015-10-22 </h1>
<ul>
<li>fixed; pluralization issues #3492 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
</ul>
<h1>4.2.0 / 2015-10-22 </h1>
<ul>
<li>added; support for skipVersioning for document arrays #3467 <a href="https://github.com/chazmo03">chazmo03</a></li>
<li>added; ability to customize schema 'type' key #3459 #3245</li>
<li>fixed; writeConcern for index builds #3455</li>
<li>added; emit event when individual index build starts #3440 <a href="https://github.com/objectiveSee">objectiveSee</a></li>
<li>added; 'context' option for update validators #3430</li>
<li>refactor; pluralization now in separate pluralize-mongoose npm module #3415 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>added; customizable error validation messages #3406 <a href="https://github.com/geronime">geronime</a></li>
<li>added; support for passing 'minimize' option to update #3381</li>
<li>added; ability to customize debug logging format #3261</li>
<li>added; baseModelName property for discriminator models #3202</li>
<li>added; 'emitIndexErrors' option #3174</li>
<li>added; 'async' option for aggregation cursor to support buffering #3160</li>
<li>added; ability to skip validation for individual save() calls #2981</li>
<li>added; single embedded schema support #2689 #585</li>
<li>added; depopulate function #2509</li>
</ul>
<h1>4.1.12 / 2015-10-19 </h1>
<ul>
<li>docs; use readPreference instead of slaveOk for Query.setOptions docs #3471 <a href="https://github.com/buunguyen">buunguyen</a></li>
<li>fixed; more helpful error when regexp contains null bytes #3456</li>
<li>fixed; x509 auth issue #3454 <a href="https://github.com/NoxHarmonium">NoxHarmonium</a></li>
</ul>
<h1>3.8.36 / 2015-10-18 </h1>
<ul>
<li>fixed; Make array props non-enumerable #3461 <a href="https://github.com/boblauer">boblauer</a></li>
</ul>
<h1>4.1.11 / 2015-10-12 </h1>
<ul>
<li>fixed; update timestamps for update() if they're enabled #3450 <a href="https://github.com/isayme">isayme</a></li>
<li>fixed; unit test error on node 0.10 #3449 <a href="https://github.com/isayme">isayme</a></li>
<li>docs; timestamp option docs #3448 <a href="https://github.com/isayme">isayme</a></li>
<li>docs; fix unexpected indent #3443 <a href="https://github.com/isayme">isayme</a></li>
<li>fixed; use ES6 promises for Model.prototype.remove() #3442</li>
<li>fixed; don't use unused 'safe' option for index builds #3439</li>
<li>fixed; elemMatch casting bug #3437 #3435 <a href="https://github.com/DefinitelyCarter">DefinitelyCarter</a></li>
<li>docs; schema.index docs #3434</li>
<li>fixed; exceptions in save() callback getting swallowed on mongodb 2.4 #3371</li>
</ul>
<h1>4.1.10 / 2015-10-05 </h1>
<ul>
<li>docs; improve virtuals docs to explain virtuals schema option #3433 <a href="https://github.com/zoyaH">zoyaH</a></li>
<li>docs; MongoDB server version compatibility guide #3427</li>
<li>docs; clarify that findById and findByIdAndUpdate fire hooks #3422</li>
<li>docs; clean up Model.save() docs #3420</li>
<li>fixed; properly handle projection with just id #3407 #3412</li>
<li>fixed; infinite loop when database document is corrupted #3405</li>
<li>docs; clarify remove middleware #3388</li>
</ul>
<h1>4.1.9 / 2015-09-28 </h1>
<ul>
<li>docs; minlength and maxlength string validation docs #3368 #3413 <a href="https://github.com/cosmosgenius">cosmosgenius</a></li>
<li>fixed; linting for infix operators #3397 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>fixed; proper casting for $all #3394</li>
<li>fixed; unhandled rejection warnings with .create() #3391</li>
<li>docs; clarify update validators on paths that aren't explicitly set #3386</li>
<li>docs; custom validator examples #2778</li>
</ul>
<h1>4.1.8 / 2015-09-21 </h1>
<ul>
<li>docs; fixed typo in example #3390 <a href="https://github.com/kmctown">kmctown</a></li>
<li>fixed; error in toObject() #3387 <a href="https://github.com/guumaster">guumaster</a></li>
<li>fixed; handling for casting null dates #3383 <a href="https://github.com/alexmingoia">alexmingoia</a></li>
<li>fixed; passing composite ids to <code>findByIdAndUpdate</code> #3380</li>
<li>fixed; linting #3376 #3375 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>fixed; added NodeJS v4 to Travis #3374 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>fixed; casting $elemMatch inside of $not #3373 <a href="https://github.com/gaguirre">gaguirre</a></li>
<li>fixed; handle case where $slice is 0 #3369</li>
<li>fixed; avoid running getters if path is populated #3357</li>
<li>fixed; cast documents to objects when setting to a nested path #3346</li>
</ul>
<h1>4.1.7 / 2015-09-14 </h1>
<ul>
<li>docs; typos in SchemaType documentation #3367 <a href="https://github.com/jasson15">jasson15</a></li>
<li>fixed; MONGOOSE_DRIVER_PATH env variable again #3360</li>
<li>docs; added validateSync docs #3353</li>
<li>fixed; set findOne op synchronously in query #3344</li>
<li>fixed; handling for <code>.pull()</code> on a documentarray without an id #3341</li>
<li>fixed; use natural order for cloning update conditions #3338</li>
<li>fixed; issue with strict mode casting for mixed type updates #3337</li>
</ul>
<h1>4.1.6 / 2015-09-08 </h1>
<ul>
<li>fixed; MONGOOSE_DRIVER_PATH env variable #3345 <a href="https://github.com/g13013">g13013</a></li>
<li>docs; global autoIndex option #3335 <a href="https://github.com/albertorestifo">albertorestifo</a></li>
<li>docs; model documentation typos #3330</li>
<li>fixed; report reason for CastError #3320</li>
<li>fixed; .populate() no longer returns true after re-assigning #3308</li>
<li>fixed; discriminators with aggregation geoNear #3304</li>
<li>docs; discriminator docs #2743</li>
</ul>
<h1>4.1.5 / 2015-09-01 </h1>
<ul>
<li>fixed; document.remove() removing all docs #3326 #3325</li>
<li>fixed; connect() checks for rs_name in options #3299</li>
<li>docs; examples for schema.set() #3288</li>
<li>fixed; checkKeys issue with bluebird #3286 <a href="https://github.com/gregthegeek">gregthegeek</a></li>
</ul>
<h1>4.1.4 / 2015-08-31 </h1>
<ul>
<li>fixed; ability to set strict: false for update #3305</li>
<li>fixed; .create() properly uses ES6 promises #3297</li>
<li>fixed; pre hooks on nested subdocs #3291 #3284 <a href="https://github.com/aliatsis">aliatsis</a></li>
<li>docs; remove unclear text in .remove() docs #3282</li>
<li>fixed; pre hooks called twice for 3rd-level nested doc #3281</li>
<li>fixed; nested transforms #3279</li>
<li>upgraded; mquery -&gt; 1.6.3 #3278 #3272</li>
<li>fixed; don't swallow callback errors by default #3273 #3222</li>
<li>fixed; properly get nested paths from nested schemas #3265</li>
<li>fixed; remove() with id undefined deleting all docs #3260 <a href="https://github.com/thanpolas">thanpolas</a></li>
<li>fixed; handling for non-numeric projections #3256</li>
<li>fixed; findById with id undefined returning first doc #3255</li>
<li>fixed; use retainKeyOrder for update #3215</li>
<li>added; passRawResult option to findOneAndUpdate for backwards compat #3173</li>
</ul>
<h1>4.1.3 / 2015-08-16 </h1>
<ul>
<li>fixed; getUpdate() in pre update hooks #3520 <a href="https://github.com/gregthegeek">gregthegeek</a></li>
<li>fixed; handleArray() ensures arg is an array #3238 <a href="https://github.com/jloveridge">jloveridge</a></li>
<li>fixed; refresh required path cache when recreating docs #3199</li>
<li>fixed; $ operator on unwind aggregation helper #3197</li>
<li>fixed; findOneAndUpdate() properly returns raw result as third arg to callback #3173</li>
<li>fixed; querystream with dynamic refs #3108</li>
</ul>
<h1>3.8.35 / 2015-08-14 </h1>
<ul>
<li>fixed; handling for minimize on nested objects #2930</li>
<li>fixed; don't crash when schema.path.options undefined #1824</li>
</ul>
<h1>4.1.2 / 2015-08-10 </h1>
<ul>
<li>fixed; better handling for Jade templates #3241 <a href="https://github.com/kbadk">kbadk</a></li>
<li>added; ESlint trailing spaces #3234 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>added; ESlint #3191 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>fixed; properly emit event on disconnect #3183</li>
<li>fixed; copy options properly using Query.toConstructor() #3176</li>
<li>fixed; setMaxListeners() issue in browser build #3170</li>
<li>fixed; node driver -&gt; 2.0.40 to not store undefined keys as null #3169</li>
<li>fixed; update validators handle positional operator #3167</li>
<li>fixed; handle $all + $elemMatch query casting #3163</li>
<li>fixed; post save hooks don't swallow extra args #3155</li>
<li>docs; spelling mistake in index.jade #3154</li>
<li>fixed; don't crash when toObject() has no fields #3130</li>
<li>fixed; apply toObject() recursively for find and update queries #3086 <a href="https://github.com/naoina">naoina</a></li>
</ul>
<h1>4.1.1 / 2015-08-03 </h1>
<ul>
<li>fixed; aggregate exec() crash with no callback #3212 #3198 <a href="https://github.com/jpgarcia">jpgarcia</a></li>
<li>fixed; pre init hooks now properly synchronous #3207 <a href="https://github.com/burtonjc">burtonjc</a></li>
<li>fixed; updateValidators doesn't flatten dates #3206 #3194 <a href="https://github.com/victorkohl">victorkohl</a></li>
<li>fixed; default fields don't make document dirty between saves #3205 <a href="https://github.com/burtonjc">burtonjc</a></li>
<li>fixed; save passes 0 as numAffected rather than undefined when no change #3195 <a href="https://github.com/burtonjc">burtonjc</a></li>
<li>fixed; better handling for positional operator in update #3185</li>
<li>fixed; use Travis containers #3181 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
<li>fixed; leaked variable #3180 <a href="https://github.com/ChristianMurphy">ChristianMurphy</a></li>
</ul>
<h1>4.1.0 / 2015-07-24 </h1>
<ul>
<li>added; <code>schema.queue()</code> now public #3193</li>
<li>added; raw result as third parameter to findOneAndX callback #3173</li>
<li>added; ability to run validateSync() on only certain fields #3153</li>
<li>added; subPopulate #3103 <a href="https://github.com/timbur">timbur</a></li>
<li>added; $isDefault function on documents #3077</li>
<li>added; additional properties for built-in validator messages #3063 <a href="https://github.com/KLicheR">KLicheR</a></li>
<li>added; getQuery() and getUpdate() functions for Query #3013</li>
<li>added; export DocumentProvider #2996</li>
<li>added; ability to remove path from schema #2993 <a href="https://github.com/JohnnyEstilles">JohnnyEstilles</a></li>
<li>added; .explain() helper for aggregate #2714</li>
<li>added; ability to specify which ES6-compatible promises library mongoose uses #2688</li>
<li>added; export Aggregate #1910</li>
</ul>
<h1>4.0.8 / 2015-07-20 </h1>
<ul>
<li>fixed; assignment with document arrays #3178 <a href="https://github.com/rosston">rosston</a></li>
<li>docs; remove duplicate paragraph #3164 <a href="https://github.com/rhmeeuwisse">rhmeeuwisse</a></li>
<li>docs; improve findOneAndXYZ parameter descriptions #3159 <a href="https://github.com/rhmeeuwisse">rhmeeuwisse</a></li>
<li>docs; add findOneAndRemove to list of supported middleware #3158</li>
<li>docs; clarify ensureIndex #3156</li>
<li>fixed; refuse to save/remove document without id #3118</li>
<li>fixed; hooks next() no longer accidentally returns promise #3104</li>
<li>fixed; strict mode for findOneAndUpdate #2947</li>
<li>added; .min.js.gz file for browser component #2806</li>
</ul>
<h1>3.8.34 / 2015-07-20 </h1>
<ul>
<li>fixed; allow using $rename #3171</li>
<li>fixed; no longer modifies update arguments #3008</li>
</ul>
<h1>4.0.7 / 2015-07-11 </h1>
<ul>
<li>fixed; documentarray id method when using object id #3157 <a href="https://github.com/siboulet">siboulet</a></li>
<li>docs; improve findById docs #3147</li>
<li>fixed; update validators handle null properly #3136 <a href="https://github.com/odeke-em">odeke-em</a></li>
<li>docs; jsdoc syntax errors #3128 <a href="https://github.com/rhmeeuwisse">rhmeeuwisse</a></li>
<li>docs; fix typo #3126 <a href="https://github.com/rhmeeuwisse">rhmeeuwisse</a></li>
<li>docs; proper formatting in queries.jade #3121 <a href="https://github.com/rhmeeuwisse">rhmeeuwisse</a></li>
<li>docs; correct example for string maxlength validator #3111 <a href="https://github.com/rhmeeuwisse">rhmeeuwisse</a></li>
<li>fixed; setDefaultsOnInsert with arrays #3107</li>
<li>docs; LearnBoost -&gt; Automattic in package.json #3099</li>
<li>docs; pre update hook example #3094 <a href="https://github.com/danpe">danpe</a></li>
<li>docs; clarify query middleware example #3051</li>
<li>fixed; ValidationErrors in strict mode #3046</li>
<li>fixed; set findOneAndUpdate properties before hooks run #3024</li>
</ul>
<h1>3.8.33 / 2015-07-10 </h1>
<ul>
<li>upgraded; node driver -&gt; 1.4.38</li>
<li>fixed; dont crash when <code>match</code> validator undefined</li>
</ul>
<h1>4.0.6 / 2015-06-21 </h1>
<ul>
<li>upgraded; node driver -&gt; 2.0.34 #3087</li>
<li>fixed; apply setters on addToSet, etc #3067 <a href="https://github.com/victorkohl">victorkohl</a></li>
<li>fixed; missing semicolons #3065 <a href="https://github.com/sokolikp">sokolikp</a></li>
<li>fixed; proper handling for async doc hooks #3062 <a href="https://github.com/gregthegeek">gregthegeek</a></li>
<li>fixed; dont set failed populate field to null if other docs are successfully populated #3055 <a href="https://github.com/eloytoro">eloytoro</a></li>
<li>fixed; setDefaultsOnInsert with document arrays #3034 <a href="https://github.com/taxilian">taxilian</a></li>
<li>fixed; setters fired on array items #3032</li>
<li>fixed; stop validateSync() on first error #3025 <a href="https://github.com/victorkohl">victorkohl</a></li>
<li>docs; improve query docs #3016</li>
<li>fixed; always exclude _id when its deselected #3010</li>
<li>fixed; enum validator kind property #3009</li>
<li>fixed; mquery collection names #3005</li>
<li>docs; clarify mongos option #3000</li>
<li>docs; clarify that query builder has a .then() #2995</li>
<li>fixed; race condition in dynamic ref #2992</li>
</ul>
<h1>3.8.31 / 2015-06-20 </h1>
<ul>
<li>fixed; properly handle text search with discriminators and $meta #2166</li>
</ul>
<h1>4.0.5 / 2015-06-05 </h1>
<ul>
<li>fixed; ObjectIds and buffers when mongodb driver is a sibling dependency #3050 #3048 #3040 #3031 #3020 #2988 #2951</li>
<li>fixed; warn user when 'increment' is used in schema #3039</li>
<li>fixed; setDefaultsOnInsert with array in schema #3035</li>
<li>fixed; dont use default Object toString to cast to string #3030</li>
<li>added; npm badge #3020 <a href="https://github.com/odeke-em">odeke-em</a></li>
<li>fixed; proper handling for calling .set() with a subdoc #2782</li>
<li>fixed; dont throw cast error when using $rename on non-string path #1845</li>
</ul>
<h1>3.8.30 / 2015-06-05 </h1>
<ul>
<li>fixed; enable users to set all options with tailable() #2883</li>
</ul>
<h1>4.0.4 / 2015-05-28 </h1>
<ul>
<li>docs; findAndModify new parameter correct default value #3012 <a href="https://github.com/JonForest">JonForest</a></li>
<li>docs; clarify pluralization rules #2999 <a href="https://github.com/anonmily">anonmily</a></li>
<li>fix; discriminators with schema methods #2978</li>
<li>fix; make <code>isModified</code> a schema reserved keyword #2975</li>
<li>fix; properly fire setters when initializing path with object #2943</li>
<li>fix; can use <code>setDefaultsOnInsert</code> without specifying <code>runValidators</code> #2938</li>
<li>fix; always set validation errors <code>kind</code> property #2885</li>
<li>upgraded; node driver -&gt; 2.0.33 #2865</li>
</ul>
<h1>3.8.29 / 2015-05-27 </h1>
<ul>
<li>fixed; Handle JSON.stringify properly for nested docs #2990</li>
</ul>
<h1>4.0.3 / 2015-05-13 </h1>
<ul>
<li>upgraded; mquery -&gt; 1.5.1 #2983</li>
<li>docs; clarify context for query middleware #2974</li>
<li>docs; fix missing type -&gt; kind rename in History.md #2961</li>
<li>fixed; broken ReadPreference include on Heroku #2957</li>
<li>docs; correct form for cursor aggregate option #2955</li>
<li>fixed; sync post hooks now properly called after function #2949 #2925</li>
<li>fixed; fix sub-doc validate() function #2929</li>
<li>upgraded; node driver -&gt; 2.0.30 #2926</li>
<li>docs; retainKeyOrder for save() #2924</li>
<li>docs; fix broken class names #2913</li>
<li>fixed; error when using node-clone on a doc #2909</li>
<li>fixed; no more hard references to bson #2908 #2906</li>
<li>fixed; dont overwrite array values #2907 <a href="https://github.com/naoina">naoina</a></li>
<li>fixed; use readPreference=primary for findOneAndUpdate #2899 #2823</li>
<li>docs; clarify that update validators only run on $set and $unset #2889</li>
<li>fixed; set kind consistently for built-in validators #2885</li>
<li>docs; single field populated documents #2884</li>
<li>fixed; nested objects are now enumerable #2880 <a href="https://github.com/toblerpwn">toblerpwn</a></li>
<li>fixed; properly populate field when ref, lean, stream used together #2841</li>
<li>docs; fixed migration guide jade error #2807</li>
</ul>
<h1>3.8.28 / 2015-05-12 </h1>
<ul>
<li>fixed; proper handling for toJSON options #2910</li>
<li>fixed; dont attach virtuals to embedded docs in update() #2046</li>
</ul>
<h1>4.0.2 / 2015-04-23 </h1>
<ul>
<li>fixed; error thrown when calling .validate() on subdoc not in an array #2902</li>
<li>fixed; rename define() to play nice with webpack #2900 <a href="https://github.com/jspears">jspears</a></li>
<li>fixed; pre validate called twice with discriminators #2892</li>
<li>fixed; .inspect() on mongoose.Types #2875</li>
<li>docs; correct callback params for Model.update #2872</li>
<li>fixed; setDefaultsOnInsert now works when runValidators not specified #2870</li>
<li>fixed; Document now wraps EventEmitter.addListener #2867</li>
<li>fixed; call non-hook functions in schema queue #2856</li>
<li>fixed; statics can be mocked out for tests #2848 <a href="https://github.com/ninelb">ninelb</a></li>
<li>upgraded; mquery 1.4.0 for bluebird bug fix #2846</li>
<li>fixed; required validators run first #2843</li>
<li>docs; improved docs for new option to findAndMody #2838</li>
<li>docs; populate example now uses correct field #2837 <a href="https://github.com/swilliams">swilliams</a></li>
<li>fixed; pre validate changes causing VersionError #2835</li>
<li>fixed; get path from correct place when setting CastError #2832</li>
<li>docs; improve docs for Model.update() function signature #2827 <a href="https://github.com/irnc">irnc</a></li>
<li>fixed; populating discriminators #2825 <a href="https://github.com/chetverikov">chetverikov</a></li>
<li>fixed; discriminators with nested schemas #2821</li>
<li>fixed; CastErrors with embedded docs #2819</li>
<li>fixed; post save hook context #2816</li>
<li>docs; 3.8.x -&gt; 4.x migration guide #2807</li>
<li>fixed; proper _distinct copying for query #2765 <a href="https://github.com/cdelauder">cdelauder</a></li>
</ul>
<h1>3.8.27 / 2015-04-22 </h1>
<ul>
<li>fixed; dont duplicate db calls on Q.ninvoke() #2864</li>
<li>fixed; Model.find arguments naming in docs #2828</li>
<li>fixed; Support ipv6 in connection strings #2298</li>
</ul>
<h1>3.8.26 / 2015-04-07 </h1>
<ul>
<li>fixed; TypeError when setting date to undefined #2833</li>
<li>fixed; handle CastError properly in distinct() with no callback #2786</li>
<li>fixed; broken links in queries docs #2779</li>
<li>fixed; dont mark buffer as modified when setting type initially #2738</li>
<li>fixed; dont crash when using slice with populate #1934</li>
</ul>
<h1>4.0.1 / 2015-03-28 </h1>
<ul>
<li>fixed; properly handle empty cast doc in update() with promises #2796</li>
<li>fixed; unstable warning #2794</li>
<li>fixed; findAndModify docs now show new option is false by default #2793</li>
</ul>
<h1>4.0.0 / 2015-03-25 </h1>
<ul>
<li>fixed; on-the-fly schema docs typo #2783 <a href="https://github.com/artiifix">artiifix</a></li>
<li>fixed; cast error validation handling #2775 #2766 #2678</li>
<li>fixed; discriminators with populate() #2773 #2719 <a href="https://github.com/chetverikov">chetverikov</a></li>
<li>fixed; increment now a reserved path #2709</li>
<li>fixed; avoid sending duplicate object ids in populate() #2683</li>
<li>upgraded; mongodb to 2.0.24 to properly emit reconnect event multiple times #2656</li>
</ul>
<h1>4.0.0-rc4 / 2015-03-14 </h1>
<ul>
<li>fixed; toObject virtuals schema option handled properly #2751</li>
<li>fixed; update validators work on document arrays #2733</li>
<li>fixed; check for cast errors on $set #2729</li>
<li>fixed; instance field set for all schema types #2727 <a href="https://github.com/csdco">csdco</a></li>
<li>fixed; dont run other validators if required fails #2725</li>
<li>fixed; custom getters execute on ref paths #2610</li>
<li>fixed; save defaults if they were set when doc was loaded from db #2558</li>
<li>fixed; pre validate now runs before pre save #2462</li>
<li>fixed; no longer throws errors with &ndash;use_strict #2281</li>
</ul>
<h1>3.8.25 / 2015-03-13 </h1>
<ul>
<li>fixed; debug output reverses order of aggregation keys #2759</li>
<li>fixed; $eq is a valid query selector in 3.0 #2752</li>
<li>fixed; upgraded node driver to 1.4.32 for handling non-numeric poolSize #2682</li>
<li>fixed; update() with overwrite sets _id for nested docs #2658</li>
<li>fixed; casting for operators in $elemMatch #2199</li>
</ul>
<h1>4.0.0-rc3 / 2015-02-28 </h1>
<ul>
<li>fixed; update() pre hooks run before validators #2706</li>
<li>fixed; setters not called on arrays of refs #2698 <a href="https://github.com/brandom">brandom</a></li>
<li>fixed; use node driver 2.0.18 for nodejs 0.12 support #2685</li>
<li>fixed; comments reference file that no longer exists #2681</li>
<li>fixed; populated() returns _id of manually populated doc #2678</li>
<li>added; ability to exclude version key in toObject() #2675</li>
<li>fixed; dont allow setting nested path to a string #2592</li>
<li>fixed; can cast objects with _id field to ObjectIds #2581</li>
<li>fixed; on-the-fly schema getters #2360</li>
<li>added; strict option for findOneAndUpdate() #1967</li>
</ul>
<h1>3.8.24 / 2015-02-25 </h1>
<ul>
<li>fixed; properly apply child schema transforms #2691</li>
<li>fixed; make copy of findOneAndUpdate options before modifying #2687</li>
<li>fixed; apply defaults when parent path is selected #2670 #2629</li>
<li>fixed; properly get ref property for nested paths #2665</li>
<li>fixed; node driver makes copy of authenticate options before modifying them #2619</li>
<li>fixed; dont block process exit when auth fails #2599</li>
<li>fixed; remove redundant clone in update() #2537</li>
</ul>
<h1>4.0.0-rc2 / 2015-02-10 </h1>
<ul>
<li>added; io.js to travis build</li>
<li>removed; browser build dependencies not installed by default</li>
<li>added; dynamic refpaths #2640 <a href="https://github.com/chetverikov">chetverikov</a></li>
<li>fixed; dont call child schema transforms on parent #2639 <a href="https://github.com/chetverikov">chetverikov</a></li>
<li>fixed; get rid of remove option if new is set in findAndModify #2598</li>
<li>fixed; aggregate all document array validation errors #2589</li>
<li>fixed; custom setters called when setting value to undefined #1892</li>
</ul>
<h1>3.8.23 / 2015-02-06 </h1>
<ul>
<li>fixed; unset opts.remove when upsert is true #2519</li>
<li>fixed; array saved as object when path is object in array #2442</li>
<li>fixed; inline transforms #2440</li>
<li>fixed; check for callback in count() #2204</li>
<li>fixed; documentation for selecting fields #1534</li>
</ul>
<h1>4.0.0-rc1 / 2015-02-01 </h1>
<ul>
<li>fixed; use driver 2.0.14</li>
<li>changed; use transform: true by default #2245</li>
</ul>
<h1>4.0.0-rc0 / 2015-01-31 </h1>
<ul>
<li>fixed; wrong order for distinct() params #2628</li>
<li>fixed; handling no query argument to remove() #2627</li>
<li>fixed; createModel and discriminators #2623 <a href="https://github.com/ashaffer">ashaffer</a></li>
<li>added; pre('count') middleware #2621</li>
<li>fixed; double validation calls on document arrays #2618</li>
<li>added; validate() catches cast errors #2611</li>
<li>fixed; respect replicaSet parameter in connection string #2609</li>
<li>added; can explicitly exclude paths from versioning #2576 <a href="https://github.com/csabapalfi">csabapalfi</a></li>
<li>upgraded; driver to 2.0.15 #2552</li>
<li>fixed; save() handles errors more gracefully in ES6 #2371</li>
<li>fixed; undefined is now a valid argument to findOneAndUpdate #2272</li>
<li>changed; <code>new</code> option to findAndModify ops is false by default #2262</li>
</ul>
<h1>3.8.22 / 2015-01-24 </h1>
<ul>
<li>upgraded; node-mongodb-native to 1.4.28 #2587 <a href="https://github.com/Climax777">Climax777</a></li>
<li>added; additional documentation for validators #2449</li>
<li>fixed; stack overflow when creating massive arrays #2423</li>
<li>fixed; undefined is a valid id for queries #2411</li>
<li>fixed; properly create nested schema index when same schema used twice #2322</li>
<li>added; link to plugin generator in docs #2085 <a href="https://github.com/huei90">huei90</a></li>
<li>fixed; optional arguments documentation for findOne() #1971 <a href="https://github.com/nachinius">nachinius</a></li>
</ul>
<h1>3.9.7 / 2014-12-19 </h1>
<ul>
<li>added; proper cursors for aggregate #2539 <a href="https://github.com/changyy">changyy</a></li>
<li>added; min/max built-in validators for dates #2531 <a href="https://github.com/bshamblen">bshamblen</a></li>
<li>fixed; save and validate are now reserved keywords #2380</li>
<li>added; basic documentation for browser component #2256</li>
<li>added; find and findOne hooks (query middleware) #2138</li>
<li>fixed; throw a DivergentArrayError when saving positional operator queries #2031</li>
<li>added; ability to use options as a document property #1416</li>
<li>fixed; document no longer inherits from event emitter and so domain and _events are no longer reserved #1351</li>
<li>removed; setProfiling #1349</li>
</ul>
<h1>3.8.21 / 2014-12-18 </h1>
<ul>
<li>fixed; syntax in index.jade #2517 <a href="https://github.com/elderbas">elderbas</a></li>
<li>fixed; writable statics #2510 #2528</li>
<li>fixed; overwrite and explicit $set casting #2515</li>
</ul>
<h1>3.9.6 / 2014-12-05 </h1>
<ul>
<li>added; correctly run validators on each element of array when entire array is modified #661 #1227</li>
<li>added; castErrors in validation #1013 <a href="https://github.com/jondavidjohn">jondavidjohn</a></li>
<li>added; specify text indexes in schema fields #1401 <a href="https://github.com/sr527">sr527</a></li>
<li>added; ability to set field with validators to undefined #1594 <a href="https://github.com/alabid">alabid</a></li>
<li>added; .create() returns an array when passed an array #1746 <a href="https://github.com/alabid">alabid</a></li>
<li>added; test suite and docs for use with co and yield #2177 #2474</li>
<li>fixed; subdocument toObject() transforms #2447 <a href="https://github.com/chmanie">chmanie</a></li>
<li>fixed; Model.create() with save errors #2484</li>
<li>added; pass options to .save() and .remove() #2494 <a href="https://github.com/jondavidjohn">jondavidjohn</a></li>
</ul>
<h1>3.8.20 / 2014-12-01 </h1>
<ul>
<li>fixed; recursive readPref #2490 <a href="https://github.com/kjvalencik">kjvalencik</a></li>
<li>fixed; make sure to copy parameters to update() before modifying #2406 <a href="https://github.com/alabid">alabid</a></li>
<li>fixed; unclear documentation about query callbacks #2319</li>
<li>fixed; setting a schema-less field to an empty object #2314 <a href="https://github.com/alabid">alabid</a></li>
<li>fixed; registering statics and methods for discriminators #2167 <a href="https://github.com/alabid">alabid</a></li>
</ul>
<h1>3.9.5 / 2014-11-10 </h1>
<ul>
<li>added; ability to disable autoIndex on a per-connection basis #1875 <a href="https://github.com/sr527">sr527</a></li>
<li>fixed; <code>geoNear()</code> no longer enforces legacy coordinate pairs - supports GeoJSON #1987 <a href="https://github.com/alabid">alabid</a></li>
<li>fixed; browser component works when minified with mangled variable names #2302</li>
<li>fixed; <code>doc.errors</code> now cleared before <code>validate()</code> called #2302</li>
<li>added; <code>execPopulate()</code> function to make <code>doc.populate()</code> compatible with promises #2317</li>
<li>fixed; <code>count()</code> no longer throws an error when used with <code>sort()</code> #2374</li>
<li>fixed; <code>save()</code> no longer recursively calls <code>save()</code> on populated fields #2418</li>
</ul>
<h1>3.8.19 / 2014-11-09 </h1>
<ul>
<li>fixed; make sure to not override subdoc _ids on find #2276 <a href="https://github.com/alabid">alabid</a></li>
<li>fixed; exception when comparing two documents when one lacks _id #2333 <a href="https://github.com/slawo">slawo</a></li>
<li>fixed; getters for properties with non-strict schemas #2439 <a href="https://github.com/alabid">alabid</a></li>
<li>fixed; inconsistent URI format in docs #2414 <a href="https://github.com/sr527">sr527</a></li>
</ul>
<h1>3.9.4 / 2014-10-25 </h1>
<ul>
<li>fixed; statics no longer can be overwritten #2343 <a href="https://github.com/chetverikov">nkcmr</a></li>
<li>added; ability to set single populated paths to documents #1530</li>
<li>added; setDefaultsOnInsert and runValidator options for findOneAndUpdate() #860</li>
</ul>
<h1>3.8.18 / 2014-10-22 </h1>
<ul>
<li>fixed; Dont use all toObject options in save #2340 <a href="https://github.com/chetverikov">chetverikov</a></li>
</ul>
<h1>3.9.3 / 2014-10-01 </h1>
<ul>
<li>added; support for virtuals that return objects #2294</li>
<li>added; ability to manually hydrate POJOs into mongoose objects #2292</li>
<li>added; setDefaultsOnInsert and runValidator options for update() #860</li>
</ul>
<h1>3.8.17 / 2014-09-29 </h1>
<ul>
<li>fixed; use schema options retainKeyOrder in save() #2274</li>
<li>fixed; fix skip in populate when limit is set #2252</li>
<li>fixed; fix stack overflow when passing MongooseArray to findAndModify #2214</li>
<li>fixed; optimize .length usage in populate #2289</li>
</ul>
<h1>3.9.2 / 2014-09-08 </h1>
<ul>
<li>added; test coverage for browser component #2255</li>
<li>added; in-order execution of validators #2243</li>
<li>added; custom fields for validators #2132</li>
<li>removed; exception thrown when find() used with count() #1950</li>
</ul>
<h1>3.8.16 / 2014-09-08 </h1>
<ul>
<li>fixed; properly remove modified array paths if array has been overwritten #1638</li>
<li>fixed; key check errors #1884</li>
<li>fixed; make sure populate on an array always returns a Mongoose array #2214</li>
<li>fixed; SSL connections with node 0.11 #2234</li>
<li>fixed; return sensible strings for promise errors #2239</li>
</ul>
<h1>3.9.1 / 2014-08-17 </h1>
<ul>
<li>added; alpha version of browser-side schema validation #2254</li>
<li>added; support passing a function to schemas <code>required</code> field #2247</li>
<li>added; support for setting updatedAt and createdAt timestamps #2227</li>
<li>added; document.validate() returns a promise #2131</li>
</ul>
<h1>3.8.15 / 2014-08-17 </h1>
<ul>
<li>fixed; Replica set connection string example in docs #2246</li>
<li>fixed; bubble up parseError event #2229</li>
<li>fixed; removed buggy populate cache #2176</li>
<li>fixed; dont $inc versionKey if its being $set #1933</li>
<li>fixed; cast $or and $and in $pull #1932</li>
<li>fixed; properly cast to schema in stream() #1862</li>
<li>fixed; memory leak in nested objects #1565 #2211 <a href="https://github.com/devongovett">devongovett</a></li>
</ul>
<h1>3.8.14 / 2014-07-26 </h1>
<ul>
<li>fixed; stringifying MongooseArray shows nested arrays #2002</li>
<li>fixed; use populated doc schema in toObject and toJSON by default #2035</li>
<li>fixed; dont crash on arrays containing null #2140</li>
<li>fixed; model.update w/ upsert has same return values on .exec and promise #2143</li>
<li>fixed; better handling for populate limit with multiple documents #2151</li>
<li>fixed; dont prevent users from adding weights to text index #2183</li>
<li>fixed; helper for aggregation cursor #2187</li>
<li>updated; node-mongodb-native to 1.4.7</li>
</ul>
<h1>3.8.13 / 2014-07-15 </h1>
<ul>
<li>fixed; memory leak with isNew events #2159</li>
<li>fixed; docs for overwrite option for update() #2144</li>
<li>fixed; storeShard() handles dates properly #2127</li>
<li>fixed; sub-doc changes not getting persisted to db after save #2082</li>
<li>fixed; populate with _id: 0 actually removes _id instead of setting to undefined #2123</li>
<li>fixed; save versionKey on findOneAndUpdate w/ upsert #2122</li>
<li>fixed; fix typo in 2.8 docs #2120 <a href="https://github.com/shakirullahi">shakirullahi</a></li>
<li>fixed; support maxTimeMs #2102 <a href="https://github.com/yuukinajima">yuukinajima</a></li>
<li>fixed; support $currentDate #2019</li>
<li>fixed; $addToSet handles objects without _ids properly #1973</li>
<li>fixed; dont crash on invalid nearSphere query #1874</li>
</ul>
<h1>3.8.12 / 2014-05-30 </h1>
<ul>
<li>fixed; single-server reconnect event fires #1672</li>
<li>fixed; sub-docs not saved when pushed into populated array #1794</li>
<li>fixed; .set() sometimes converts embedded docs to pojos #1954 <a href="https://github.com/archangel-irk">archangel-irk</a></li>
<li>fixed; sub-doc changes not getting persisted to db after save #2082</li>
<li>fixed; custom getter might cause mongoose to mistakenly think a path is dirty #2100 <a href="https://github.com/pgherveou">pgherveou</a></li>
<li>fixed; chainable helper for allowDiskUse option in aggregation #2114</li>
</ul>
<h1>3.9.0 (unstable) / 2014-05-22 </h1>
<ul>
<li>changed; added <code>domain</code> to reserved keywords #1338 #2052 <a href="https://github.com/antoinepairet">antoinepairet</a></li>
<li>added; asynchronous post hooks #1977 #2081 <a href="https://github.com/chopachom">chopachom</a> <a href="https://github.com/JasonGhent">JasonGhent</a></li>
<li>added; using model for population, cross-db populate <a href="https://github.com/mihai-chiorean">mihai-chiorean</a></li>
<li>added; can define a type for schema validators</li>
<li>added; <code>doc.remove()</code> returns a promise #1619 <a href="https://github.com/refack">refack</a></li>
<li>added; internal promises for hooks, pre-save hooks run in parallel #1732 <a href="https://github.com/refack">refack</a></li>
<li>fixed; geoSearch hanging when no results returned #1846 <a href="https://github.com/ghartnett">ghartnett</a></li>
<li>fixed; do not set .type property on ValidationError, use .kind instead #1323</li>
</ul>
<h1>3.8.11 / 2014-05-22 </h1>
<ul>
<li>updated; node-mongodb-native to 1.4.5</li>
<li>reverted; #2052, fixes #2097</li>
</ul>
<h1>3.8.10 / 2014-05-20 </h1>
<ul>
<li>updated; node-mongodb-native to 1.4.4</li>
<li>fixed; _.isEqual false negatives bug in js-bson #2070</li>
<li>fixed; missing check for schema.options #2014</li>
<li>fixed; missing support for $position #2024</li>
<li>fixed; options object corruption #2049</li>
<li>fixed; improvements to virtuals docs #2055</li>
<li>fixed; added <code>domain</code> to reserved keywords #2052 #1338</li>
</ul>
<h1>3.8.9 / 2014-05-08 </h1>
<ul>
<li>updated; mquery to 0.7.0</li>
<li>updated; node-mongodb-native to 1.4.3</li>
<li>fixed; $near failing against MongoDB 2.6</li>
<li>fixed; relying on .options() to determine if collection exists</li>
<li>fixed; $out aggregate helper</li>
<li>fixed; all test failures against MongoDB 2.6.1, with caveat #2065</li>
</ul>
<h1>3.8.8 / 2014-02-22 </h1>
<ul>
<li>fixed; saving Buffers #1914</li>
<li>updated; expose connection states for user-land #1926 <a href="https://github.com/yorkie">yorkie</a></li>
<li>updated; mquery to 0.5.3</li>
<li>updated; added get / set to reserved path list #1903 <a href="https://github.com/tstrimple">tstrimple</a></li>
<li>docs; README code highlighting, syntax fixes #1930 <a href="https://github.com/IonicaBizau">IonicaBizau</a></li>
<li>docs; fixes link in the doc at #1925 <a href="https://github.com/kapeels">kapeels</a></li>
<li>docs; add a missed word 'hook' for the description of the post-hook api #1924 <a href="https://github.com/ipoval">ipoval</a></li>
</ul>
<h1>3.8.7 / 2014-02-09 </h1>
<ul>
<li>fixed; sending safe/read options in Query::exec #1895</li>
<li>fixed; findOneAnd..() with sort #1887</li>
</ul>
<h1>3.8.6 / 2014-01-30 </h1>
<ul>
<li>fixed; setting readPreferences #1895</li>
</ul>
<h1>3.8.5 / 2014-01-23 </h1>
<ul>
<li>fixed; ssl setting when using URI #1882</li>
<li>fixed; findByIdAndUpdate now respects the overwrite option #1809 <a href="https://github.com/owenallenaz">owenallenaz</a></li>
</ul>
<h1>3.8.4 / 2014-01-07 </h1>
<ul>
<li>updated; mongodb driver to 1.3.23</li>
<li>updated; mquery to 0.4.1</li>
<li>updated; mpromise to 0.4.3</li>
<li>fixed; discriminators now work when selecting fields #1820 <a href="https://github.com/daemon1981">daemon1981</a></li>
<li>fixed; geoSearch with no results timeout #1846 <a href="https://github.com/ghartnett">ghartnett</a></li>
<li>fixed; infitite recursion in ValidationError #1834 <a href="https://github.com/chetverikov">chetverikov</a></li>
</ul>
<h1>3.8.3 / 2013-12-17 </h1>
<ul>
<li>fixed; setting empty array with model.update #1838</li>
<li>docs; fix url</li>
</ul>
<h1>3.8.2 / 2013-12-14 </h1>
<ul>
<li>fixed; enum validation of multiple values #1778 <a href="https://github.com/heroicyang">heroicyang</a></li>
<li>fixed; global var leak #1803</li>
<li>fixed; post remove now fires on subdocs #1810</li>
<li>fixed; no longer set default empty array for geospatial-indexed fields #1668 <a href="https://github.com/shirish87">shirish87</a></li>
<li>fixed; model.stream() not hydrating discriminators correctly #1792 <a href="https://github.com/j">j</a></li>
<li>docs: Stablility -&gt; Stability <a href="https://github.com/nikmartin">nikmartin</a></li>
<li>tests; improve shard error handling</li>
</ul>
<h1>3.8.1 / 2013-11-19 </h1>
<ul>
<li>fixed; mishandling of Dates with minimize/getters #1764</li>
<li>fixed; Normalize bugs.email, so <code>npm</code> will shut up #1769 <a href="https://github.com/refack">refack</a></li>
<li>docs; Improve the grammar where "lets us" was used #1777 <a href="https://github.com/alexyoung">alexyoung</a></li>
<li>docs; Fix some grammatical issues in the documentation #1777 <a href="https://github.com/alexyoung">alexyoung</a></li>
<li>docs; fix Query api exposure</li>
<li>docs; fix return description</li>
<li>docs; Added Notes on findAndUpdate() #1750 <a href="https://github.com/sstadelman">sstadelman</a></li>
<li>docs; Update version number in README #1762 <a href="https://github.com/Fodi69">Fodi69</a></li>
</ul>
<h1>3.8.0 / 2013-10-31 </h1>
<ul>
<li>updated; warn when using an unstable version</li>
<li>updated; error message returned in doc.save() #1595</li>
<li>updated; mongodb driver to 1.3.19 (fix error swallowing behavior)</li>
<li>updated; mquery to 0.3.2</li>
<li>updated; mocha to 1.12.0</li>
<li>updated; mpromise 0.3.0</li>
<li>updated; sliced 0.0.5</li>
<li>removed; mongoose.Error.DocumentError (never used)</li>
<li>removed; namedscope (undocumented and broken) #679 #642 #455 #379</li>
<li>changed; no longer offically supporting node 0.6.x</li>
<li>changed; query.within getter is now a method -&gt; query.within()</li>
<li>changed; query.intersects getter is now a method -&gt; query.intersects()</li>
<li>added; custom error msgs for built-in validators #747</li>
<li>added; discriminator support #1647 #1003 <a href="https://github.com/j">j</a></li>
<li>added; support disabled collection name pluralization #1350 #1707 <a href="https://github.com/refack">refack</a></li>
<li>added; support for GeoJSON to Query::near <a href="https://github.com/ebensing">ebensing</a></li>
<li>added; stand-alone base query support - query.toConstructor() <a href="https://github.com/ebensing">ebensing</a></li>
<li>added; promise support to geoSearch #1614 <a href="https://github.com/ebensing">ebensing</a></li>
<li>added; promise support for geoNear #1614 <a href="https://github.com/ebensing">ebensing</a></li>
<li>added; connection.useDb() #1124 <a href="https://github.com/ebensing">ebensing</a></li>
<li>added; promise support to model.mapReduce()</li>
<li>added; promise support to model.ensureIndexes()</li>
<li>added; promise support to model.populate()</li>
<li>added; benchmarks <a href="https://github.com/ebensing">ebensing</a></li>
<li>added; publicly exposed connection states #1585</li>
<li>added; $geoWithin support #1529 $1455 <a href="https://github.com/ebensing">ebensing</a></li>
<li>added; query method chain validation</li>
<li>added; model.update <code>overwrite</code> option</li>
<li>added; model.geoNear() support #1563 <a href="https://github.com/ebensing">ebensing</a></li>
<li>added; model.geoSearch() support #1560 <a href="https://github.com/ebensing">ebensing</a></li>
<li>added; MongooseBuffer::subtype()</li>
<li>added; model.create() now returns a promise #1340</li>
<li>added; support for <code>awaitdata</code> query option</li>
<li>added; pass the doc to doc.remove() callback #1419 <a href="https://github.com/JoeWagner">JoeWagner</a></li>
<li>added; aggregation query builder #1404 <a href="https://github.com/njoyard">njoyard</a></li>
<li>fixed; document.toObject when using <code>minimize</code> and <code>getters</code> options #1607 <a href="https://github.com/JedWatson">JedWatson</a></li>
<li>fixed; Mixed types can now be required #1722 <a href="https://github.com/Reggino">Reggino</a></li>
<li>fixed; do not pluralize model names not ending with letters #1703 <a href="https://github.com/refack">refack</a></li>
<li>fixed; repopulating modified populated paths #1697</li>
<li>fixed; doc.equals() when _id option is set to false #1687</li>
<li>fixed; strict mode warnings #1686</li>
<li>fixed; $near GeoJSON casting #1683</li>
<li>fixed; nearSphere GeoJSON query builder</li>
<li>fixed; population field selection w/ strings #1669</li>
<li>fixed; setters not firing on null values #1445 <a href="https://github.com/ebensing">ebensing</a></li>
<li>fixed; handle another versioning edge case #1520</li>
<li>fixed; excluding subdocument fields #1280 <a href="https://github.com/ebensing">ebensing</a></li>
<li>fixed; allow array properties to be set to null with findOneAndUpdate <a href="https://github.com/aheuermann">aheuermann</a></li>
<li>fixed; subdocuments now use own toJSON opts #1376 <a href="https://github.com/ebensing">ebensing</a></li>
<li>fixed; model::geoNear fulfills promise when results empty #1658 <a href="https://github.com/ebensing">ebensing</a></li>
<li>fixed; utils.merge no longer overrides props and methods #1655 <a href="https://github.com/j">j</a></li>
<li>fixed; subdocuments now use their own transform #1412 <a href="https://github.com/ebensing">ebensing</a></li>
<li>fixed; model.remove() removes only what is necessary #1649</li>
<li>fixed; update() now only runs with cb or explicit true #1644</li>
<li>fixed; casting ref docs on creation #1606 <a href="https://github.com/ebensing">ebensing</a></li>
<li>fixed; model.update "overwrite" option works as documented</li>
<li>fixed; query::remove() works as documented</li>
<li>fixed; "limit" correctly applies to individual items on population #1490 <a href="https://github.com/ebensing">ebensing</a></li>
<li>fixed; issue with positional operator on ref docs #1572 <a href="https://github.com/ebensing">ebensing</a></li>
<li>fixed; benchmarks to actually output valid json</li>
<li>deprecated; promise::addBack (use promise::onResolve)</li>
<li>deprecated; promise::complete (use promise::fulfill)</li>
<li>deprecated; promise::addCallback (use promise::onFulFill)</li>
<li>deprecated; promise::addErrback (use promise::onReject)</li>
<li>deprecated; query.nearSphere() (use query.near)</li>
<li>deprecated; query.center() (use query.circle)</li>
<li>deprecated; query.centerSphere() (use query.circle)</li>
<li>deprecated; query::slaveOk (use query::read)</li>
<li>docs; custom validator messages</li>
<li>docs; 10gen -&gt; MongoDB</li>
<li>docs; add Date method caveats #1598</li>
<li>docs; more validation details</li>
<li>docs; state which branch is stable/unstable</li>
<li>docs; mention that middleware does not run on Models</li>
<li>docs; promise.fulfill()</li>
<li>docs; fix readme spelling #1483 <a href="https://github.com/yorchopolis">yorchopolis</a></li>
<li>docs; fixed up the README and examples <a href="https://github.com/ebensing">ebensing</a></li>
<li>website; add "show code" for properties</li>
<li>website; move "show code" links down</li>
<li>website; update guide</li>
<li>website; add unstable docs</li>
<li>website; many improvements</li>
<li>website; fix copyright #1439</li>
<li>website; server.js -&gt; static.js #1546 <a href="https://github.com/nikmartin">nikmartin</a></li>
<li>tests; refactor 1703</li>
<li>tests; add test generator</li>
<li>tests; validate formatMessage() throws</li>
<li>tests; add script for continuously running tests</li>
<li>tests; fixed versioning tests</li>
<li>tests; race conditions in tests</li>
<li>tests; added for nested and/or queries</li>
<li>tests; close some test connections</li>
<li>tests; validate db contents</li>
<li>tests; remove .only</li>
<li>tests; close some test connections</li>
<li>tests; validate db contents</li>
<li>tests; remove .only</li>
<li>tests; replace deprecated method names</li>
<li>tests; convert id to string</li>
<li>tests; fix sharding tests for MongoDB 2.4.5</li>
<li>tests; now 4-5 seconds faster</li>
<li>tests; fix race condition</li>
<li>make; suppress warning msg in test</li>
<li>benchmarks; updated for pull requests</li>
<li>examples; improved and expanded <a href="https://github.com/ebensing">ebensing</a></li>
</ul>
<h1>3.7.4 (unstable) / 2013-10-01 </h1>
<ul>
<li>updated; mquery to 0.3.2</li>
<li>removed; mongoose.Error.DocumentError (never used)</li>
<li>added; custom error msgs for built-in validators #747</li>
<li>added; discriminator support #1647 #1003 <a href="https://github.com/j">j</a></li>
<li>added; support disabled collection name pluralization #1350 #1707 <a href="https://github.com/refack">refack</a></li>
<li>fixed; do not pluralize model names not ending with letters #1703 <a href="https://github.com/refack">refack</a></li>
<li>fixed; repopulating modified populated paths #1697</li>
<li>fixed; doc.equals() when _id option is set to false #1687</li>
<li>fixed; strict mode warnings #1686</li>
<li>fixed; $near GeoJSON casting #1683</li>
<li>fixed; nearSphere GeoJSON query builder</li>
<li>fixed; population field selection w/ strings #1669</li>
<li>docs; custom validator messages</li>
<li>docs; 10gen -&gt; MongoDB</li>
<li>docs; add Date method caveats #1598</li>
<li>docs; more validation details</li>
<li>website; add "show code" for properties</li>
<li>website; move "show code" links down</li>
<li>tests; refactor 1703</li>
<li>tests; add test generator</li>
<li>tests; validate formatMessage() throws</li>
</ul>
<h1>3.7.3 (unstable) / 2013-08-22 </h1>
<ul>
<li>updated; warn when using an unstable version</li>
<li>updated; mquery to 0.3.1</li>
<li>updated; mocha to 1.12.0</li>
<li>updated; mongodb driver to 1.3.19 (fix error swallowing behavior)</li>
<li>changed; no longer offically supporting node 0.6.x</li>
<li>added; support for GeoJSON to Query::near <a href="https://github.com/ebensing">ebensing</a></li>
<li>added; stand-alone base query support - query.toConstructor() <a href="https://github.com/ebensing">ebensing</a></li>
<li>added; promise support to geoSearch #1614 <a href="https://github.com/ebensing">ebensing</a></li>
<li>added; promise support for geoNear #1614 <a href="https://github.com/ebensing">ebensing</a></li>
<li>fixed; setters not firing on null values #1445 <a href="https://github.com/ebensing">ebensing</a></li>
<li>fixed; handle another versioning edge case #1520</li>
<li>fixed; excluding subdocument fields #1280 <a href="https://github.com/ebensing">ebensing</a></li>
<li>fixed; allow array properties to be set to null with findOneAndUpdate <a href="https://github.com/aheuermann">aheuermann</a></li>
<li>fixed; subdocuments now use own toJSON opts #1376 <a href="https://github.com/ebensing">ebensing</a></li>
<li>fixed; model::geoNear fulfills promise when results empty #1658 <a href="https://github.com/ebensing">ebensing</a></li>
<li>fixed; utils.merge no longer overrides props and methods #1655 <a href="https://github.com/j">j</a></li>
<li>fixed; subdocuments now use their own transform #1412 <a href="https://github.com/ebensing">ebensing</a></li>
<li>make; suppress warning msg in test</li>
<li>docs; state which branch is stable/unstable</li>
<li>docs; mention that middleware does not run on Models</li>
<li>tests; add script for continuously running tests</li>
<li>tests; fixed versioning tests</li>
<li>benchmarks; updated for pull requests</li>
</ul>
<h1>3.7.2 (unstable) / 2013-08-15 </h1>
<ul>
<li>fixed; model.remove() removes only what is necessary #1649</li>
<li>fixed; update() now only runs with cb or explicit true #1644</li>
<li>tests; race conditions in tests</li>
<li>website; update guide</li>
</ul>
<h1>3.7.1 (unstable) / 2013-08-13 </h1>
<ul>
<li>updated; driver to 1.3.18 (fixes memory leak)</li>
<li>added; connection.useDb() #1124 <a href="https://github.com/ebensing">ebensing</a></li>
<li>added; promise support to model.mapReduce()</li>
<li>added; promise support to model.ensureIndexes()</li>
<li>added; promise support to model.populate()</li>
<li>fixed; casting ref docs on creation #1606 <a href="https://github.com/ebensing">ebensing</a></li>
<li>fixed; model.update "overwrite" option works as documented</li>
<li>fixed; query::remove() works as documented</li>
<li>fixed; "limit" correctly applies to individual items on population #1490 <a href="https://github.com/ebensing">ebensing</a></li>
<li>fixed; issue with positional operator on ref docs #1572 <a href="https://github.com/ebensing">ebensing</a></li>
<li>fixed; benchmarks to actually output valid json</li>
<li>tests; added for nested and/or queries</li>
<li>tests; close some test connections</li>
<li>tests; validate db contents</li>
<li>tests; remove .only</li>
<li>tests; close some test connections</li>
<li>tests; validate db contents</li>
<li>tests; remove .only</li>
<li>tests; replace deprecated method names</li>
<li>tests; convert id to string</li>
<li>docs; promise.fulfill()</li>
</ul>
<h1>3.7.0 (unstable) / 2013-08-05 </h1>
<ul>
<li>changed; query.within getter is now a method -&gt; query.within()</li>
<li>changed; query.intersects getter is now a method -&gt; query.intersects()</li>
<li>deprecated; promise::addBack (use promise::onResolve)</li>
<li>deprecated; promise::complete (use promise::fulfill)</li>
<li>deprecated; promise::addCallback (use promise::onFulFill)</li>
<li>deprecated; promise::addErrback (use promise::onReject)</li>
<li>deprecated; query.nearSphere() (use query.near)</li>
<li>deprecated; query.center() (use query.circle)</li>
<li>deprecated; query.centerSphere() (use query.circle)</li>
<li>deprecated; query::slaveOk (use query::read)</li>
<li>removed; namedscope (undocumented and broken) #679 #642 #455 #379</li>
<li>added; benchmarks <a href="https://github.com/ebensing">ebensing</a></li>
<li>added; publicly exposed connection states #1585</li>
<li>added; $geoWithin support #1529 $1455 <a href="https://github.com/ebensing">ebensing</a></li>
<li>added; query method chain validation</li>
<li>added; model.update <code>overwrite</code> option</li>
<li>added; model.geoNear() support #1563 <a href="https://github.com/ebensing">ebensing</a></li>
<li>added; model.geoSearch() support #1560 <a href="https://github.com/ebensing">ebensing</a></li>
<li>added; MongooseBuffer::subtype()</li>
<li>added; model.create() now returns a promise #1340</li>
<li>added; support for <code>awaitdata</code> query option</li>
<li>added; pass the doc to doc.remove() callback #1419 <a href="https://github.com/JoeWagner">JoeWagner</a></li>
<li>added; aggregation query builder #1404 <a href="https://github.com/njoyard">njoyard</a></li>
<li>updated; integrate mquery #1562 <a href="https://github.com/ebensing">ebensing</a></li>
<li>updated; error msg in doc.save() #1595</li>
<li>updated; bump driver to 1.3.15</li>
<li>updated; mpromise 0.3.0</li>
<li>updated; sliced 0.0.5</li>
<li>tests; fix sharding tests for MongoDB 2.4.5</li>
<li>tests; now 4-5 seconds faster</li>
<li>tests; fix race condition</li>
<li>docs; fix readme spelling #1483 <a href="https://github.com/yorchopolis">yorchopolis</a></li>
<li>docs; fixed up the README and examples <a href="https://github.com/ebensing">ebensing</a></li>
<li>website; add unstable docs</li>
<li>website; many improvements</li>
<li>website; fix copyright #1439</li>
<li>website; server.js -&gt; static.js #1546 <a href="https://github.com/nikmartin">nikmartin</a></li>
<li>examples; improved and expanded <a href="https://github.com/ebensing">ebensing</a></li>
</ul>
<h1>3.6.20 (stable) / 2013-09-23 </h1>
<ul>
<li>fixed; repopulating modified populated paths #1697</li>
<li>fixed; doc.equals w/ _id false #1687</li>
<li>fixed; strict mode warning #1686</li>
<li>docs; near/nearSphere</li>
</ul>
<h1>3.6.19 (stable) / 2013-09-04 </h1>
<ul>
<li>fixed; population field selection w/ strings #1669</li>
<li>docs; Date method caveats #1598</li>
</ul>
<h1>3.6.18 (stable) / 2013-08-22 </h1>
<ul>
<li>updated; warn when using an unstable version of mongoose</li>
<li>updated; mocha to 1.12.0</li>
<li>updated; mongodb driver to 1.3.19 (fix error swallowing behavior)</li>
<li>fixed; setters not firing on null values #1445 <a href="https://github.com/ebensing">ebensing</a></li>
<li>fixed; properly exclude subdocument fields #1280 <a href="https://github.com/ebensing">ebensing</a></li>
<li>fixed; cast error in findAndModify #1643 <a href="https://github.com/aheuermann">aheuermann</a></li>
<li>website; update guide</li>
<li>website; added documentation for safe:false and versioning interaction</li>
<li>docs; mention that middleware dont run on Models</li>
<li>docs; fix indexes link</li>
<li>make; suppress warning msg in test</li>
<li>tests; moar</li>
</ul>
<h1>3.6.17 / 2013-08-13 </h1>
<ul>
<li>updated; driver to 1.3.18 (fixes memory leak)</li>
<li>fixed; casting ref docs on creation #1606</li>
<li>docs; query options</li>
</ul>
<h1>3.6.16 / 2013-08-08 </h1>
<ul>
<li>added; publicly expose connection states #1585</li>
<li>fixed; limit applies to individual items on population #1490 <a href="https://github.com/ebensing">ebensing</a></li>
<li>fixed; positional operator casting in updates #1572 <a href="https://github.com/ebensing">ebensing</a></li>
<li>updated; MongoDB driver to 1.3.17</li>
<li>updated; sliced to 0.0.5</li>
<li>website; tweak homepage</li>
<li>tests; fixed + added</li>
<li>docs; fix some examples</li>
<li>docs; multi-mongos support details</li>
<li>docs; auto open browser after starting static server</li>
</ul>
<h1>3.6.15 / 2013-07-16 </h1>
<ul>
<li>added; mongos failover support #1037</li>
<li>updated; make schematype return vals return self #1580</li>
<li>docs; add note to model.update #571</li>
<li>docs; document third param to document.save callback #1536</li>
<li>tests; tweek mongos test timeout</li>
</ul>
<h1>3.6.14 / 2013-07-05 </h1>
<ul>
<li>updated; driver to 1.3.11</li>
<li>fixed; issue with findOneAndUpdate not returning null on upserts #1533 <a href="https://github.com/ebensing">ebensing</a></li>
<li>fixed; missing return statement in SchemaArray::$geoIntersects() #1498 <a href="https://github.com/bsrykt">bsrykt</a></li>
<li>fixed; wrong isSelected() behavior #1521 <a href="https://github.com/kyano">kyano</a></li>
<li>docs; note about toObject behavior during save()</li>
<li>docs; add callbacks details #1547 <a href="https://github.com/nikmartin">nikmartin</a></li>
</ul>
<h1>3.6.13 / 2013-06-27 </h1>
<ul>
<li>fixed; calling model.distinct without conditions #1541</li>
<li>fixed; regression in Query::count() #1542</li>
<li>now working on 3.6.13</li>
</ul>
<h1>3.6.12 / 2013-06-25 </h1>
<ul>
<li>updated; driver to 1.3.10</li>
<li>updated; clearer capped collection error message #1509 <a href="https://github.com/bitmage">bitmage</a></li>
<li>fixed; MongooseBuffer subtype loss during casting #1517 <a href="https://github.com/zedgu">zedgu</a></li>
<li>fixed; docArray::id when doc.id is disabled #1492</li>
<li>fixed; docArray::id now supports matches on populated arrays #1492 <a href="https://github.com/pgherveou">pgherveou</a></li>
<li>website; fix example</li>
<li>website; improve _id disabling example</li>
<li>website; fix typo #1494 <a href="https://github.com/dejj">dejj</a></li>
<li>docs; added a 'Requesting new features' section #1504 <a href="https://github.com/shovon">shovon</a></li>
<li>docs; improve subtypes description</li>
<li>docs; clarify _id disabling</li>
<li>docs: display by alphabetical order the methods list #1508 <a href="https://github.com/nicolasleger">nicolasleger</a></li>
<li>tests; refactor isSelected checks</li>
<li>tests; remove pointless test</li>
<li>tests; fixed timeouts</li>
</ul>
<h1>3.6.11 / 2013-05-15 </h1>
<ul>
<li>updated; driver to 1.3.5</li>
<li>fixed; compat w/ Object.create(null) #1484 #1485</li>
<li>fixed; cloning objects w/ missing constructors</li>
<li>fixed; prevent multiple min number validators #1481 <a href="https://github.com/nrako">nrako</a></li>
<li>docs; add doc.increment() example</li>
<li>docs; add $size example</li>
<li>docs; add "distinct" example</li>
</ul>
<h1>3.6.10 / 2013-05-09 </h1>
<ul>
<li>update driver to 1.3.3</li>
<li>fixed; increment() works without other changes #1475</li>
<li>website; fix links to posterous</li>
<li>docs; fix link #1472</li>
</ul>
<h1>3.6.9 / 2013-05-02 </h1>
<ul>
<li>fixed; depopulation of mixed documents #1471</li>
<li>fixed; use of $options in array #1462</li>
<li>tests; fix race condition</li>
<li>docs; fix default example</li>
</ul>
<h1>3.6.8 / 2013-04-25 </h1>
<ul>
<li>updated; driver to 1.3.0</li>
<li>fixed; connection.model should retain options #1458 <a href="https://github.com/vedmalex">vedmalex</a></li>
<li>tests; 4-5 seconds faster</li>
</ul>
<h1>3.6.7 / 2013-04-19 </h1>
<ul>
<li>fixed; population regression in 3.6.6 #1444</li>
</ul>
<h1>3.6.6 / 2013-04-18 </h1>
<ul>
<li>fixed; saving populated new documents #1442</li>
<li>fixed; population regession in 3.6.5 #1441</li>
<li>website; fix copyright #1439</li>
</ul>
<h1>3.6.5 / 2013-04-15 </h1>
<ul>
<li>fixed; strict:throw edge case using .set(path, val)</li>
<li>fixed; schema.pathType() on some numbericAlpha paths</li>
<li>fixed; numbericAlpha path versioning</li>
<li>fixed; setting nested mixed paths #1418</li>
<li>fixed; setting nested objects with null prop #1326</li>
<li>fixed; regression in v3.6 population performance #1426 <a href="https://github.com/vedmalex">vedmalex</a></li>
<li>fixed; read pref typos #1422 <a href="https://github.com/kyano">kyano</a></li>
<li>docs; fix method example</li>
<li>website; update faq</li>
<li>website; add more deep links</li>
<li>website; update poolSize docs</li>
<li>website; add 3.6 release notes</li>
<li>website; note about keepAlive</li>
</ul>
<h1>3.6.4 / 2013-04-03 </h1>
<ul>
<li>fixed; +field conflict with $slice #1370</li>
<li>fixed; nested deselection conflict #1333</li>
<li>fixed; RangeError in ValidationError.toString() #1296</li>
<li>fixed; do not save user defined transforms #1415</li>
<li>tests; fix race condition</li>
</ul>
<h1>3.6.3 / 2013-04-02 </h1>
<ul>
<li>fixed; setting subdocuments deeply nested fields #1394</li>
<li>fixed; regression: populated streams #1411</li>
<li>docs; mention hooks/validation with findAndModify</li>
<li>docs; mention auth</li>
<li>docs; add more links</li>
<li>examples; add document methods example</li>
<li>website; display "see" links for properties</li>
<li>website; clean up homepage</li>
</ul>
<h1>3.6.2 / 2013-03-29 </h1>
<ul>
<li>fixed; corrupted sub-doc array #1408</li>
<li>fixed; document::update returns a Query #1397</li>
<li>docs; readpref strategy</li>
</ul>
<h1>3.6.1 / 2013-03-27 </h1>
<ul>
<li>added; populate support to findAndModify varients #1395</li>
<li>added; text index type to schematypes</li>
<li>expose allowed index types as Schema.indexTypes</li>
<li>fixed; use of <code>setMaxListeners</code> as path</li>
<li>fixed; regression in node 0.6 on docs with &gt; 10 arrays</li>
<li>fixed; do not alter schema arguments #1364</li>
<li>fixed; subdoc::ownerDocument() #1385</li>
<li>website; change search id</li>
<li>website; add search from google <a href="https://github.com/jackdbernier">jackdbernier</a></li>
<li>website; fix link</li>
<li>website; add 3.5.x docs release</li>
<li>website; fix link</li>
<li>docs; fix geometry</li>
<li>docs; hide internal constructor</li>
<li>docs; aggregation does not cast arguments #1399</li>
<li>docs; querystream options</li>
<li>examples; added for population</li>
</ul>
<h1>3.6.0 / 2013-03-18 </h1>
<ul>
<li>changed; cast 'true'/'false' to boolean #1282 <a href="https://github.com/mgrach">mgrach</a></li>
<li>changed; Buffer arrays can now contain nulls</li>
<li>added; QueryStream transform option</li>
<li>added; support for authSource driver option</li>
<li>added; {mongoose,db}.modelNames()</li>
<li>added; $push w/ $slice,$sort support (MongoDB 2.4)</li>
<li>added; hashed index type (MongoDB 2.4)</li>
<li>added; support for mongodb 2.4 geojson (MongoDB 2.4)</li>
<li>added; value at time of validation error</li>
<li>added; support for object literal schemas</li>
<li>added; bufferCommands schema option</li>
<li>added; allow auth option in connections #1360 <a href="https://github.com/geoah">geoah</a></li>
<li>added; performance improvements to populate() <a href="https://github.com/LearnBoost/mongoose/commit/263ece9">263ece9</a></li>
<li>added; allow adding uncasted docs to populated arrays and properties #570</li>
<li>added; doc::populated(path) stores original populated _ids</li>
<li>added; lean population #1260</li>
<li>added; query.populate() now accepts an options object</li>
<li>added; document::populate(opts, callback)</li>
<li>added; Model.populate(docs, opts, callback)</li>
<li>added; support for rich nested path population</li>
<li>added; doc.array.remove(value) subdoc with _id value support #1278</li>
<li>added; optionally allow non-strict sets and updates</li>
<li>added; promises/A+ comformancy with <a href="https://github.com/aheckmann/mpromise">mpromise</a></li>
<li>added; promise::then</li>
<li>added; promise::end</li>
<li>fixed; use of <code>model</code> as doc property</li>
<li>fixed; lean population #1382</li>
<li>fixed; empty object mixed defaults #1380</li>
<li>fixed; populate w/ deselected _id using string syntax</li>
<li>fixed; attempted save of divergent populated arrays #1334 related</li>
<li>fixed; better error msg when attempting toObject as property name</li>
<li>fixed; non population buffer casting from doc</li>
<li>fixed; setting populated paths #570</li>
<li>fixed; casting when added docs to populated arrays #570</li>
<li>fixed; prohibit updating arrays selected with $elemMatch #1334</li>
<li>fixed; pull / set subdoc combination #1303</li>
<li>fixed; multiple bg index creation #1365</li>
<li>fixed; manual reconnection to single mongod</li>
<li>fixed; Constructor / version exposure #1124</li>
<li>fixed; CastError race condition</li>
<li>fixed; no longer swallowing misuse of subdoc::invalidate()</li>
<li>fixed; utils.clone retains RegExp opts</li>
<li>fixed; population of non-schema property</li>
<li>fixed; allow updating versionKey #1265</li>
<li>fixed; add EventEmitter props to reserved paths #1338</li>
<li>fixed; can now deselect populated doc _ids #1331</li>
<li>fixed; properly pass subtype to Binary in MongooseBuffer</li>
<li>fixed; casting _id from document with non-ObjectId _id</li>
<li>fixed; specifying schema type edge case { path: [{type: "String" }] }</li>
<li>fixed; typo in schemdate #1329 <a href="https://github.com/jplock">jplock</a></li>
<li>updated; driver to 1.2.14</li>
<li>updated; muri to 0.3.1</li>
<li>updated; mpromise to 0.2.1</li>
<li>updated; mocha 1.8.1</li>
<li>updated; mpath to 0.1.1</li>
<li>deprecated; pluralization will die in 4.x</li>
<li>refactor; rename private methods to something unusable as doc properties</li>
<li>refactor MongooseArray::remove</li>
<li>refactor; move expires index to SchemaDate #1328</li>
<li>refactor; internal document properties #1171 #1184</li>
<li>tests; added</li>
<li>docs; indexes</li>
<li>docs; validation</li>
<li>docs; populate</li>
<li>docs; populate</li>
<li>docs; add note about stream compatibility with node 0.8</li>
<li>docs; fix for private names</li>
<li>docs; Buffer -&gt; mongodb.Binary #1363</li>
<li>docs; auth options</li>
<li>docs; improved</li>
<li>website; update FAQ</li>
<li>website; add more api links</li>
<li>website; add 3.5.x docs to prior releases</li>
<li>website; Change mongoose-types to an active repo <a href="https://github.com/jackdbernier">jackdbernier</a></li>
<li>website; compat with node 0.10</li>
<li>website; add news section</li>
<li>website; use T for generic type</li>
<li>benchmark; make adjustable</li>
</ul>
<h1>3.6.0rc1 / 2013-03-12 </h1>
<ul>
<li>refactor; rename private methods to something unusable as doc properties</li>
<li>added; {mongoose,db}.modelNames()</li>
<li>added; $push w/ $slice,$sort support (MongoDB 2.4)</li>
<li>added; hashed index type (MongoDB 2.4)</li>
<li>added; support for mongodb 2.4 geojson (MongoDB 2.4)</li>
<li>added; value at time of validation error</li>
<li>added; support for object literal schemas</li>
<li>added; bufferCommands schema option</li>
<li>added; allow auth option in connections #1360 <a href="https://github.com/geoah">geoah</a></li>
<li>fixed; lean population #1382</li>
<li>fixed; empty object mixed defaults #1380</li>
<li>fixed; populate w/ deselected _id using string syntax</li>
<li>fixed; attempted save of divergent populated arrays #1334 related</li>
<li>fixed; better error msg when attempting toObject as property name</li>
<li>fixed; non population buffer casting from doc</li>
<li>fixed; setting populated paths #570</li>
<li>fixed; casting when added docs to populated arrays #570</li>
<li>fixed; prohibit updating arrays selected with $elemMatch #1334</li>
<li>fixed; pull / set subdoc combination #1303</li>
<li>fixed; multiple bg index creation #1365</li>
<li>fixed; manual reconnection to single mongod</li>
<li>fixed; Constructor / version exposure #1124</li>
<li>fixed; CastError race condition</li>
<li>fixed; no longer swallowing misuse of subdoc::invalidate()</li>
<li>fixed; utils.clone retains RegExp opts</li>
<li>fixed; population of non-schema property</li>
<li>fixed; allow updating versionKey #1265</li>
<li>fixed; add EventEmitter props to reserved paths #1338</li>
<li>fixed; can now deselect populated doc _ids #1331</li>
<li>updated; muri to 0.3.1</li>
<li>updated; driver to 1.2.12</li>
<li>updated; mpromise to 0.2.1</li>
<li>deprecated; pluralization will die in 4.x</li>
<li>docs; Buffer -&gt; mongodb.Binary #1363</li>
<li>docs; auth options</li>
<li>docs; improved</li>
<li>website; add news section</li>
<li>benchmark; make adjustable</li>
</ul>
<h1>3.6.0rc0 / 2013-02-03 </h1>
<ul>
<li>changed; cast 'true'/'false' to boolean #1282 <a href="https://github.com/mgrach">mgrach</a></li>
<li>changed; Buffer arrays can now contain nulls</li>
<li>fixed; properly pass subtype to Binary in MongooseBuffer</li>
<li>fixed; casting _id from document with non-ObjectId _id</li>
<li>fixed; specifying schema type edge case { path: [{type: "String" }] }</li>
<li>fixed; typo in schemdate #1329 <a href="https://github.com/jplock">jplock</a></li>
<li>refactor; move expires index to SchemaDate #1328</li>
<li>refactor; internal document properties #1171 #1184</li>
<li>added; performance improvements to populate() <a href="https://github.com/LearnBoost/mongoose/commit/263ece9">263ece9</a></li>
<li>added; allow adding uncasted docs to populated arrays and properties #570</li>
<li>added; doc::populated(path) stores original populated _ids</li>
<li>added; lean population #1260</li>
<li>added; query.populate() now accepts an options object</li>
<li>added; document::populate(opts, callback)</li>
<li>added; Model.populate(docs, opts, callback)</li>
<li>added; support for rich nested path population</li>
<li>added; doc.array.remove(value) subdoc with _id value support #1278</li>
<li>added; optionally allow non-strict sets and updates</li>
<li>added; promises/A+ comformancy with <a href="https://github.com/aheckmann/mpromise">mpromise</a></li>
<li>added; promise::then</li>
<li>added; promise::end</li>
<li>updated; mocha 1.8.1</li>
<li>updated; muri to 0.3.0</li>
<li>updated; mpath to 0.1.1</li>
<li>updated; docs</li>
</ul>
<h1>3.5.16 / 2013-08-13 </h1>
<ul>
<li>updated; driver to 1.3.18</li>
</ul>
<h1>3.5.15 / 2013-07-26 </h1>
<ul>
<li>updated; sliced to 0.0.5</li>
<li>updated; driver to 1.3.12</li>
<li>fixed; regression in Query::count() due to driver change</li>
<li>tests; fixed timeouts</li>
<li>tests; handle differing test uris</li>
</ul>
<h1>3.5.14 / 2013-05-15 </h1>
<ul>
<li>updated; driver to 1.3.5</li>
<li>fixed; compat w/ Object.create(null) #1484 #1485</li>
<li>fixed; cloning objects missing constructors</li>
<li>fixed; prevent multiple min number validators #1481 <a href="https://github.com/nrako">nrako</a></li>
</ul>
<h1>3.5.13 / 2013-05-09 </h1>
<ul>
<li>update driver to 1.3.3</li>
<li>fixed; use of $options in array #1462</li>
</ul>
<h1>3.5.12 / 2013-04-25 </h1>
<ul>
<li>updated; driver to 1.3.0</li>
<li>fixed; connection.model should retain options #1458 <a href="https://github.com/vedmalex">vedmalex</a></li>
<li>fixed; read pref typos #1422 <a href="https://github.com/kyano">kyano</a></li>
</ul>
<h1>3.5.11 / 2013-04-03 </h1>
<ul>
<li>fixed; +field conflict with $slice #1370</li>
<li>fixed; RangeError in ValidationError.toString() #1296</li>
<li>fixed; nested deselection conflict #1333</li>
<li>remove time from Makefile</li>
</ul>
<h1>3.5.10 / 2013-04-02 </h1>
<ul>
<li>fixed; setting subdocuments deeply nested fields #1394</li>
<li>fixed; do not alter schema arguments #1364</li>
</ul>
<h1>3.5.9 / 2013-03-15 </h1>
<ul>
<li>updated; driver to 1.2.14</li>
<li>added; support for authSource driver option (mongodb 2.4)</li>
<li>added; QueryStream transform option (node 0.10 helper)</li>
<li>fixed; backport for saving required populated buffers</li>
<li>fixed; pull / set subdoc combination #1303</li>
<li>fixed; multiple bg index creation #1365</li>
<li>test; added for saveable required populated buffers</li>
<li>test; added for #1365</li>
<li>test; add authSource test</li>
</ul>
<h1>3.5.8 / 2013-03-12 </h1>
<ul>
<li>added; auth option in connection <a href="https://github.com/geoah">geoah</a></li>
<li>fixed; CastError race condition</li>
<li>docs; add note about stream compatibility with node 0.8</li>
</ul>
<h1>3.5.7 / 2013-02-22 </h1>
<ul>
<li>updated; driver to 1.2.13</li>
<li>updated; muri to 0.3.1 #1347</li>
<li>fixed; utils.clone retains RegExp opts #1355</li>
<li>fixed; deepEquals RegExp support</li>
<li>tests; fix a connection test</li>
<li>website; clean up docs <a href="https://github.com/afshinm">afshinm</a></li>
<li>website; update homepage</li>
<li>website; migragtion: emphasize impact of strict docs #1264</li>
</ul>
<h1>3.5.6 / 2013-02-14 </h1>
<ul>
<li>updated; driver to 1.2.12</li>
<li>fixed; properly pass Binary subtype</li>
<li>fixed; add EventEmitter props to reserved paths #1338</li>
<li>fixed; use correct node engine version</li>
<li>fixed; display empty docs as {} in log output #953 follow up</li>
<li>improved; "bad $within $box argument" error message</li>
<li>populate; add unscientific benchmark</li>
<li>website; add stack overflow to help section</li>
<li>website; use better code font #1336 <a href="https://github.com/risseraka">risseraka</a></li>
<li>website; clarify where help is available</li>
<li>website; fix source code links #1272 <a href="https://github.com/floatingLomas">floatingLomas</a></li>
<li>docs; be specific about _id schema option #1103</li>
<li>docs; add ensureIndex error handling example</li>
<li>docs; README</li>
<li>docs; CONTRIBUTING.md</li>
</ul>
<h1>3.5.5 / 2013-01-29 </h1>
<ul>
<li>updated; driver to 1.2.11</li>
<li>removed; old node &lt; 0.6x shims</li>
<li>fixed; documents with Buffer _ids equality</li>
<li>fixed; MongooseBuffer properly casts numbers</li>
<li>fixed; reopening closed connection on alt host/port #1287</li>
<li>docs; fixed typo in Readme #1298 <a href="https://github.com/rened">rened</a></li>
<li>docs; fixed typo in migration docs <a href="https://github.com/Prinzhorn">Prinzhorn</a></li>
<li>docs; fixed incorrect annotation in SchemaNumber::min <a href="https://github.com/bilalq">bilalq</a></li>
<li>docs; updated</li>
</ul>
<h1>3.5.4 / 2013-01-07 </h1>
<ul>
<li>changed; "_pres" &amp; "_posts" are now reserved pathnames #1261</li>
<li>updated; driver to 1.2.8</li>
<li>fixed; exception when reopening a replica set. #1263 <a href="https://github.com/ethankan">ethankan</a></li>
<li>website; updated</li>
</ul>
<h1>3.5.3 / 2012-12-26 </h1>
<ul>
<li>added; support for geo object notation #1257</li>
<li>fixed; $within query casting with arrays</li>
<li>fixed; unix domain socket support #1254</li>
<li>updated; driver to 1.2.7</li>
<li>updated; muri to 0.0.5</li>
</ul>
<h1>3.5.2 / 2012-12-17 </h1>
<ul>
<li>fixed; using auth with replica sets #1253</li>
</ul>
<h1>3.5.1 / 2012-12-12 </h1>
<ul>
<li>fixed; regression when using subdoc with <code>path</code> as pathname #1245 <a href="https://github.com/daeq">daeq</a></li>
<li>fixed; safer db option checks</li>
<li>updated; driver to 1.2.5</li>
<li>website; add more examples</li>
<li>website; clean up old docs</li>
<li>website; fix prev release urls</li>
<li>docs; clarify streaming with HTTP responses</li>
</ul>
<h1>3.5.0 / 2012-12-10 </h1>
<ul>
<li>added; paths to CastErrors #1239</li>
<li>added; support for mongodb connection string spec #1187</li>
<li>added; post validate event</li>
<li>added; Schema::get (to retrieve schema options)</li>
<li>added; VersionError #1071</li>
<li>added; npmignore <a href="https://github.com/hidekiy">hidekiy</a></li>
<li>update; driver to 1.2.3</li>
<li>fixed; stackoverflow in setter #1234</li>
<li>fixed; utils.isObject()</li>
<li>fixed; do not clobber user specified driver writeConcern #1227</li>
<li>fixed; always pass current document to post hooks</li>
<li>fixed; throw error when user attempts to overwrite a model</li>
<li>fixed; connection.model only caches on connection #1209</li>
<li>fixed; respect conn.model() creation when matching global model exists #1209</li>
<li>fixed; passing model name + collection name now always honors collection name</li>
<li>fixed; setting virtual field to an empty object #1154</li>
<li>fixed; subclassed MongooseErrors exposure, now available in mongoose.Error.xxxx</li>
<li>fixed; model.remove() ignoring callback when executed twice <a href="https://github.com/daeq">daeq</a> #1210</li>
<li>docs; add collection option to schema api docs #1222</li>
<li>docs; NOTE about db safe options</li>
<li>docs; add post hooks docs</li>
<li>docs; connection string options</li>
<li>docs; middleware is not executed with Model.remove #1241</li>
<li>docs; {g,s}etter introspection #777</li>
<li>docs; update validation docs</li>
<li>docs; add link to plugins page</li>
<li>docs; clarify error returned by unique indexes #1225</li>
<li>docs; more detail about disabling autoIndex behavior</li>
<li>docs; add homepage section to package (npm docs mongoose)</li>
<li>docs; more detail around collection name pluralization #1193</li>
<li>website; add .important css</li>
<li>website; update models page</li>
<li>website; update getting started</li>
<li>website; update quick start</li>
</ul>
<h1>3.4.0 / 2012-11-10 </h1>
<ul>
<li>added; support for generic toJSON/toObject transforms #1160 #1020 #1197</li>
<li>added; doc.set() merge support #1148 <a href="https://github.com/NuORDER">NuORDER</a></li>
<li>added; query::add support #1188 <a href="https://github.com/aleclofabbro">aleclofabbro</a></li>
<li>changed; adding invalid nested paths to non-objects throws 4216f14</li>
<li>changed; fixed; stop invalid function cloning (internal fix)</li>
<li>fixed; add query $and casting support #1180 <a href="https://github.com/anotheri">anotheri</a></li>
<li>fixed; overwriting of query arguments #1176</li>
<li>docs; fix expires examples</li>
<li>docs; transforms</li>
<li>docs; schema <code>collection</code> option docs <a href="https://github.com/hermanjunge">hermanjunge</a></li>
<li>website; updated</li>
<li>tests; added</li>
</ul>
<h1>3.3.1 / 2012-10-11 </h1>
<ul>
<li>fixed; allow goose.connect(uris, dbname, opts) #1144</li>
<li>docs; persist API private checked state across page loads</li>
</ul>
<h1>3.3.0 / 2012-10-10 </h1>
<ul>
<li>fixed; passing options as 2nd arg to connect() #1144</li>
<li>fixed; race condition after no-op save #1139</li>
<li>fixed; schema field selection application in findAndModify #1150</li>
<li>fixed; directly setting arrays #1126</li>
<li>updated; driver to 1.1.11</li>
<li>updated; collection pluralization rules <a href="https://github.com/mrickard">mrickard</a></li>
<li>tests; added</li>
<li>docs; updated</li>
</ul>
<h1>3.2.2 / 2012-10-08 </h1>
<ul>
<li>updated; driver to 1.1.10 #1143</li>
<li>updated; use sliced 0.0.3</li>
<li>fixed; do not recast embedded docs unnecessarily</li>
<li>fixed; expires schema option helper #1132</li>
<li>fixed; built in string setters #1131</li>
<li>fixed; debug output for Dates/ObjectId properties #1129</li>
<li>docs; fixed Javascript syntax error in example <a href="https://github.com/olalonde">olalonde</a></li>
<li>docs; fix toJSON example #1137</li>
<li>docs; add ensureIndex production notes</li>
<li>docs; fix spelling</li>
<li>docs; add blogposts about v3</li>
<li>website; updated</li>
<li>removed; undocumented inGroupsOf util</li>
<li>tests; added</li>
</ul>
<h1>3.2.1 / 2012-09-28 </h1>
<ul>
<li>fixed; remove query batchSize option default of 1000 <a href="https://github.com/learnboost/mongoose/commit/3edaa8651">https://github.com/learnboost/mongoose/commit/3edaa8651</a></li>
<li>docs; updated</li>
<li>website; updated</li>
</ul>
<h1>3.2.0 / 2012-09-27 </h1>
<ul>
<li>added; direct array index assignment with casting support <code>doc.array.set(index, value)</code></li>
<li>fixed; QueryStream::resume within same tick as pause() #1116</li>
<li>fixed; default value validatation #1109</li>
<li>fixed; array splice() not casting #1123</li>
<li>fixed; default array construction edge case #1108</li>
<li>fixed; query casting for inequalities in arrays #1101 <a href="https://github.com/dpatti">dpatti</a></li>
<li>tests; added</li>
<li>website; more documentation</li>
<li>website; fixed layout issue #1111 <a href="https://github.com/SlashmanX">SlashmanX</a></li>
<li>website; refactored <a href="https://github.com/guille">guille</a></li>
</ul>
<h1>3.1.2 / 2012-09-10 </h1>
<ul>
<li>added; ReadPreferrence schema option #1097</li>
<li>updated; driver to 1.1.7</li>
<li>updated; default query batchSize to 1000</li>
<li>fixed; we now cast the mapReduce query option #1095</li>
<li>fixed; $elemMatch+$in with field selection #1091</li>
<li>fixed; properly cast $elemMatch+$in conditions #1100</li>
<li>fixed; default field application of subdocs #1027</li>
<li>fixed; querystream prematurely dying #1092</li>
<li>fixed; querystream never resumes when paused at getMore boundries #1092</li>
<li>fixed; querystream occasionally emits data events after destroy #1092</li>
<li>fixed; remove unnecessary ObjectId creation in querystream</li>
<li>fixed; allow ne(boolean) again #1093</li>
<li>docs; add populate/field selection syntax notes</li>
<li>docs; add toObject/toJSON options detail</li>
<li>docs; <code>read</code> schema option</li>
</ul>
<h1>3.1.1 / 2012-08-31 </h1>
<ul>
<li>updated; driver to 1.1.6</li>
</ul>
<h1>3.1.0 / 2012-08-29 </h1>
<ul>
<li>changed; fixed; directly setting nested objects now overwrites entire object (previously incorrectly merged them)</li>
<li>added; read pref support (mongodb 2.2) 205a709c</li>
<li>added; aggregate support (mongodb 2.2) f3a5bd3d</li>
<li>added; virtual {g,s}etter introspection (#1070)</li>
<li>updated; docs <a href="https://github.com/brettz9">brettz9</a></li>
<li>updated; driver to 1.1.5</li>
<li>fixed; retain virtual setter return values (#1069)</li>
</ul>
<h1>3.0.3 / 2012-08-23 </h1>
<ul>
<li>fixed; use of nested paths beginning w/ numbers #1062</li>
<li>fixed; query population edge case #1053 #1055 <a href="https://github.com/jfremy">jfremy</a></li>
<li>fixed; simultaneous top and sub level array modifications #1073</li>
<li>added; id and _id schema option aliases + tests</li>
<li>improve debug formatting to allow copy/paste logged queries into mongo shell <a href="https://github.com/eknkc">eknkc</a></li>
<li>docs</li>
</ul>
<h1>3.0.2 / 2012-08-17 </h1>
<ul>
<li>added; missing support for v3 sort/select syntax to findAndModify helpers (#1058)</li>
<li>fixed; replset fullsetup event emission</li>
<li>fixed; reconnected event for replsets</li>
<li>fixed; server reconnection setting discovery</li>
<li>fixed; compat with non-schema path props using positional notation (#1048)</li>
<li>fixed; setter/casting order (#665)</li>
<li>docs; updated</li>
</ul>
<h1>3.0.1 / 2012-08-11 </h1>
<ul>
<li>fixed; throw Error on bad validators (1044)</li>
<li>fixed; typo in EmbeddedDocument::parentArray [lackac]</li>
<li>fixed; repair mongoose.SchemaTypes alias</li>
<li>updated; docs</li>
</ul>
<h1>3.0.0 / 2012-08-07 </h1>
<ul>
<li>removed; old subdocument::commit method</li>
<li>fixed; setting arrays of matching docs [6924cbc2]</li>
<li>fixed; doc!remove event now emits in save order as save for consistency</li>
<li>fixed; pre-save hooks no longer fire on subdocuments when validation fails</li>
<li>added; subdoc::parent() and subdoc::parentArray() to access subdocument parent objects</li>
<li>added; query::lean() helper</li>
</ul>
<h1>3.0.0rc0 / 2012-08-01 </h1>
<ul>
<li>fixed; allow subdoc literal declarations containing "type" pathname (#993)</li>
<li>fixed; unsetting a default array (#758)</li>
<li>fixed; boolean $in queries (#998)</li>
<li>fixed; allow use of <code>options</code> as a pathname (#529)</li>
<li>fixed; <code>model</code> is again a permitted schema path name</li>
<li>fixed; field selection option on subdocs (#1022)</li>
<li>fixed; handle another edge case with subdoc saving (#975)</li>
<li>added; emit save err on model if listening</li>
<li>added; MongoDB TTL collection support (#1006)</li>
<li>added; $center options support</li>
<li>added; $nearSphere and $polygon support</li>
<li>updated; driver version to 1.1.2</li>
</ul>
<h1>3.0.0alpha2 / 2012-07-18 </h1>
<ul>
<li>changed; index errors are now emitted on their model and passed to an optional callback (#984)</li>
<li>fixed; specifying index along with sparse/unique option no longer overwrites (#1004)</li>
<li>fixed; never swallow connection errors (#618)</li>
<li>fixed; creating object from model with emded object no longer overwrites defaults <a href="#859">achurkin</a></li>
<li>fixed; stop needless validation of unchanged/unselected fields (#891)</li>
<li>fixed; document::equals behavior of objectids (#974)</li>
<li>fixed; honor the minimize schema option (#978)</li>
<li>fixed; provide helpful error msgs when reserved schema path is used (#928)</li>
<li>fixed; callback to conn::disconnect is optional (#875)</li>
<li>fixed; handle missing protocols in connection urls (#987)</li>
<li>fixed; validate args to query::where (#969)</li>
<li>fixed; saving modified/removed subdocs (#975)</li>
<li>fixed; update with $pull from Mixed array (#735)</li>
<li>fixed; error with null shard key value</li>
<li>fixed; allow unsetting enums (#967)</li>
<li>added; support for manual index creation (#984)</li>
<li>added; support for disabled auto-indexing (#984)</li>
<li>added; support for preserving MongooseArray::sort changes (#752)</li>
<li>added; emit state change events on connection</li>
<li>added; support for specifying BSON subtype in MongooseBuffer::toObject [jcrugzz]</li>
<li>added; support for disabled versioning (#977)</li>
<li>added; implicit "new" support for models and Schemas</li>
</ul>
<h1>3.0.0alpha1 / 2012-06-15 </h1>
<ul>
<li>removed; doc::commit (use doc::markModified)</li>
<li>removed; doc.modified getter (#950)</li>
<li>removed; mongoose{connectSet,createSetConnection}. use connect,createConnection instead</li>
<li>removed; query alias methods 1149804c</li>
<li>removed; MongooseNumber</li>
<li>changed; now creating indexes in background by default</li>
<li>changed; strict mode now enabled by default (#952)</li>
<li>changed; doc::modifiedPaths is now a method (#950)</li>
<li>changed; getters no longer cast (#820); casting happens during set</li>
<li>fixed; no need to pass updateArg to findOneAndUpdate (#931)</li>
<li>fixed: utils.merge bug when merging nested non-objects. [treygriffith]</li>
<li>fixed; strict:throw should produce errors in findAndModify (#963)</li>
<li>fixed; findAndUpdate no longer overwrites document (#962)</li>
<li>fixed; setting default DocumentArrays (#953)</li>
<li>fixed; selection of _id with schema deselection (#954)</li>
<li>fixed; ensure promise::error emits instanceof Error</li>
<li>fixed; CursorStream: No stack overflow on any size result (#929)</li>
<li>fixed; doc::remove now passes safe options</li>
<li>fixed; invalid use of $set during $pop</li>
<li>fixed; array#{$pop,$shift} mirror MongoDB behavior</li>
<li>fixed; no longer test non-required vals in string match (#934)</li>
<li>fixed; edge case with doc::inspect</li>
<li>fixed; setter order (#665)</li>
<li>fixed; setting invalid paths in strict mode (#916)</li>
<li>fixed; handle docs without id in DocumentArray::id method (#897)</li>
<li>fixed; do not save virtuals during model.update (#894)</li>
<li>fixed; sub doc toObject virtuals application (#889)</li>
<li>fixed; MongooseArray::pull of ObjectId (#881)</li>
<li>fixed; handle passing db name with any repl set string</li>
<li>fixed; default application of selected fields (#870)</li>
<li>fixed; subdoc paths reported in validation errors (#725)</li>
<li>fixed; incorrect reported num of affected docs in update ops (#862)</li>
<li>fixed; connection assignment in Model::model (#853)</li>
<li>fixed; stringifying arrays of docs (#852)</li>
<li>fixed; modifying subdoc and parent array works (#842)</li>
<li>fixed; passing undefined to next hook (#785)</li>
<li>fixed; Query#{update,remove}() works without callbacks (#788)</li>
<li>fixed; set/updating nested objects by parent pathname (#843)</li>
<li>fixed; allow null in number arrays (#840)</li>
<li>fixed; isNew on sub doc after insertion error (#837)</li>
<li>fixed; if an insert fails, set isNew back to false [boutell]</li>
<li>fixed; isSelected when only _id is selected (#730)</li>
<li>fixed; setting an unset default value (#742)</li>
<li>fixed; query::sort error messaging (#671)</li>
<li>fixed; support for passing $options with $regex</li>
<li>added; array of object literal notation in schema creates DocumentArrays</li>
<li>added; gt,gte,lt,lte query support for arrays (#902)</li>
<li>added; capped collection support (#938)</li>
<li>added; document versioning support</li>
<li>added; inclusion of deselected schema path (#786)</li>
<li>added; non-atomic array::pop</li>
<li>added; EmbeddedDocument constructor is now exposed in DocArray::create 7cf8beec</li>
<li>added; mapReduce support (#678)</li>
<li>added; support for a configurable minimize option #to{Object,JSON}(option) (#848)</li>
<li>added; support for strict: <code>throws</code> [regality]</li>
<li>added; support for named schema types (#795)</li>
<li>added; to{Object,JSON} schema options (#805)</li>
<li>added; findByIdAnd{Update,Remove}()</li>
<li>added; findOneAnd{Update,Remove}()</li>
<li>added; query.setOptions()</li>
<li>added; instance.update() (#794)</li>
<li>added; support specifying model in populate() [DanielBaulig]</li>
<li>added; <code>lean</code> query option [gitfy]</li>
<li>added; multi-atomic support to MongooseArray::nonAtomicPush</li>
<li>added; support for $set + other $atomic ops on single array</li>
<li>added; tests</li>
<li>updated; driver to 1.0.2</li>
<li>updated; query.sort() syntax to mirror query.select()</li>
<li>updated; clearer cast error msg for array numbers</li>
<li>updated; docs</li>
<li>updated; doc.clone 3x faster (#950)</li>
<li>updated; only create _id if necessary (#950)</li>
</ul>
<h1>2.7.3 / 2012-08-01 </h1>
<ul>
<li>fixed; boolean $in queries (#998)</li>
<li>fixed field selection option on subdocs (#1022)</li>
</ul>
<h1>2.7.2 / 2012-07-18 </h1>
<ul>
<li>fixed; callback to conn::disconnect is optional (#875)</li>
<li>fixed; handle missing protocols in connection urls (#987)</li>
<li>fixed; saving modified/removed subdocs (#975)</li>
<li>updated; tests</li>
</ul>
<h1>2.7.1 / 2012-06-26 </h1>
<ul>
<li>fixed; sharding: when a document holds a null as a value of the shard key</li>
<li>fixed; update() using $pull on an array of Mixed (gh-735)</li>
<li>deprecated; MongooseNumber#{inc, increment, decrement} methods</li>
<li>tests; now using mocha</li>
</ul>
<h1>2.7.0 / 2012-06-14 </h1>
<ul>
<li>added; deprecation warnings to methods being removed in 3.x</li>
</ul>
<h1>2.6.8 / 2012-06-14 </h1>
<ul>
<li>fixed; edge case when using 'options' as a path name (#961)</li>
</ul>
<h1>2.6.7 / 2012-06-08 </h1>
<ul>
<li>fixed; ensure promise::error always emits instanceof Error</li>
<li>fixed; selection of _id w/ another excluded path (#954)</li>
<li>fixed; setting default DocumentArrays (#953)</li>
</ul>
<h1>2.6.6 / 2012-06-06 </h1>
<ul>
<li>fixed; stack overflow in query stream with large result sets (#929)</li>
<li>added; $gt, $gte, $lt, $lte support to arrays (#902)</li>
<li>fixed; pass option <code>safe</code> along to doc::remove() calls</li>
</ul>
<h1>2.6.5 / 2012-05-24 </h1>
<ul>
<li>fixed; do not save virtuals in Model.update (#894)</li>
<li>added; missing $ prefixed query aliases (going away in 3.x) (#884) [timoxley]</li>
<li>fixed; setting invalid paths in strict mode (#916)</li>
<li>fixed; resetting isNew after insert failure (#837) [boutell]</li>
</ul>
<h1>2.6.4 / 2012-05-15 </h1>
<ul>
<li>updated; backport string regex $options to 2.x</li>
<li>updated; use driver 1.0.2 (performance improvements) (#914)</li>
<li>fixed; calling MongooseDocumentArray::id when the doc has no _id (#897)</li>
</ul>
<h1>2.6.3 / 2012-05-03 </h1>
<ul>
<li>fixed; repl-set connectivity issues during failover on MongoDB 2.0.1</li>
<li>updated; driver to 1.0.0</li>
<li>fixed; virtuals application of subdocs when using toObject({ virtuals: true }) (#889)</li>
<li>fixed; MongooseArray::pull of ObjectId correctly updates the array itself (#881)</li>
</ul>
<h1>2.6.2 / 2012-04-30 </h1>
<ul>
<li>fixed; default field application of selected fields (#870)</li>
</ul>
<h1>2.6.1 / 2012-04-30 </h1>
<ul>
<li>fixed; connection assignment in mongoose::model (#853, #877)</li>
<li>fixed; incorrect reported num of affected docs in update ops (#862)</li>
</ul>
<h1>2.6.0 / 2012-04-19 </h1>
<ul>
<li>updated; hooks.js to 0.2.1</li>
<li>fixed; issue with passing undefined to a hook callback. thanks to [chrisleishman] for reporting.</li>
<li>fixed; updating/setting nested objects in strict schemas (#843) as reported by [kof]</li>
<li>fixed; Query#{update,remove}() work without callbacks again (#788)</li>
<li>fixed; modifying subdoc along with parent array $atomic op (#842)</li>
</ul>
<h1>2.5.14 / 2012-04-13 </h1>
<ul>
<li>fixed; setting an unset default value (#742)</li>
<li>fixed; doc.isSelected(otherpath) when only _id is selected (#730)</li>
<li>updated; docs</li>
</ul>
<h1>2.5.13 / 2012-03-22 </h1>
<ul>
<li>fixed; failing validation of unselected required paths (#730,#713)</li>
<li>fixed; emitting connection error when only one listener (#759)</li>
<li>fixed; MongooseArray::splice was not returning values (#784) [chrisleishman]</li>
</ul>
<h1>2.5.12 / 2012-03-21 </h1>
<ul>
<li>fixed; honor the <code>safe</code> option in all ensureIndex calls</li>
<li>updated; node-mongodb-native driver to 0.9.9-7</li>
</ul>
<h1>2.5.11 / 2012-03-15 </h1>
<ul>
<li>added; introspection for getters/setters (#745)</li>
<li>updated; node-mongodb-driver to 0.9.9-5</li>
<li>added; tailable method to Query (#769) [holic]</li>
<li>fixed; Number min/max validation of null (#764) [btamas]</li>
<li>added; more flexible user/password connection options (#738) [KarneAsada]</li>
</ul>
<h1>2.5.10 / 2012-03-06 </h1>
<ul>
<li>updated; node-mongodb-native driver to 0.9.9-4</li>
<li>added; Query::comment()</li>
<li>fixed; allow unsetting arrays</li>
<li>fixed; hooking the set method of subdocuments (#746)</li>
<li>fixed; edge case in hooks</li>
<li>fixed; allow $id and $ref in queries (fixes compatibility with mongoose-dbref) (#749) [richtera]</li>
<li>added; default path selection to SchemaTypes</li>
</ul>
<h1>2.5.9 / 2012-02-22 </h1>
<ul>
<li>fixed; properly cast nested atomic update operators for sub-documents</li>
</ul>
<h1>2.5.8 / 2012-02-21 </h1>
<ul>
<li>added; post 'remove' middleware includes model that was removed (#729) [timoxley]</li>
</ul>
<h1>2.5.7 / 2012-02-09 </h1>
<ul>
<li>fixed; RegExp validators on node &gt;= v0.6.x</li>
</ul>
<h1>2.5.6 / 2012-02-09 </h1>
<ul>
<li>fixed; emit errors returned from db.collection() on the connection (were being swallowed)</li>
<li>added; can add multiple validators in your schema at once (#718) [diogogmt]</li>
<li>fixed; strict embedded documents (#717)</li>
<li>updated; docs [niemyjski]</li>
<li>added; pass number of affected docs back in model.update/save</li>
</ul>
<h1>2.5.5 / 2012-02-03 </h1>
<ul>
<li>fixed; RangeError: maximum call stack exceed error when removing docs with Number _id (#714)</li>
</ul>
<h1>2.5.4 / 2012-02-03 </h1>
<ul>
<li>fixed; RangeError: maximum call stack exceed error (#714)</li>
</ul>
<h1>2.5.3 / 2012-02-02 </h1>
<ul>
<li>added; doc::isSelected(path)</li>
<li>added; query::equals()</li>
<li>added; beta sharding support</li>
<li>added; more descript error msgs (#700) [obeleh]</li>
<li>added; document.modifiedPaths (#709) [ljharb]</li>
<li>fixed; only functions can be added as getters/setters (#707,704) [ljharb]</li>
</ul>
<h1>2.5.2 / 2012-01-30 </h1>
<ul>
<li>fixed; rollback -native driver to 0.9.7-3-5 (was causing timeouts and other replica set weirdness)</li>
<li>deprecated; MongooseNumber (will be moved to a separate repo for 3.x)</li>
<li>added; init event is emitted on schemas</li>
</ul>
<h1>2.5.1 / 2012-01-27 </h1>
<ul>
<li>fixed; honor strict schemas in Model.update (#699)</li>
</ul>
<h1>2.5.0 / 2012-01-26 </h1>
<ul>
<li>added; doc.toJSON calls toJSON on embedded docs when exists [jerem]</li>
<li>added; populate support for refs of type Buffer (#686) [jerem]</li>
<li>added; $all support for ObjectIds and Dates (#690)</li>
<li>fixed; virtual setter calling on instantiation when strict: true (#682) [hunterloftis]</li>
<li>fixed; doc construction triggering getters (#685)</li>
<li>fixed; MongooseBuffer check in deepEquals (#688)</li>
<li>fixed; range error when using Number _ids with <code>instance.save()</code> (#691)</li>
<li>fixed; isNew on embedded docs edge case (#680)</li>
<li>updated; driver to 0.9.8-3</li>
<li>updated; expose <code>model()</code> method within static methods</li>
</ul>
<h1>2.4.10 / 2012-01-10 </h1>
<ul>
<li>added; optional getter application in .toObject()/.toJSON() (#412)</li>
<li>fixed; nested $operators in $all queries (#670)</li>
<li>added; $nor support (#674)</li>
<li>fixed; bug when adding nested schema (#662) [paulwe]</li>
</ul>
<h1>2.4.9 / 2012-01-04 </h1>
<ul>
<li>updated; driver to 0.9.7-3-5 to fix Linux performance degradation on some boxes</li>
</ul>
<h1>2.4.8 / 2011-12-22 </h1>
<ul>
<li>updated; bump -native to 0.9.7.2-5</li>
<li>fixed; compatibility with date.js (#646) [chrisleishman]</li>
<li>changed; undocumented schema "lax" option to "strict"</li>
<li>fixed; default value population for strict schemas</li>
<li>updated; the nextTick helper for small performance gain. 1bee2a2</li>
</ul>
<h1>2.4.7 / 2011-12-16 </h1>
<ul>
<li>fixed; bug in 2.4.6 with path setting</li>
<li>updated; bump -native to 0.9.7.2-1</li>
<li>added; strict schema option [nw]</li>
</ul>
<h1>2.4.6 / 2011-12-16 </h1>
<ul>
<li>fixed; conflicting mods on update bug [sirlantis]</li>
<li>improved; doc.id getter performance</li>
</ul>
<h1>2.4.5 / 2011-12-14 </h1>
<ul>
<li>fixed; bad MongooseArray behavior in 2.4.2 - 2.4.4</li>
</ul>
<h1>2.4.4 / 2011-12-14 </h1>
<ul>
<li>fixed; MongooseArray::doAtomics throwing after sliced</li>
</ul>
<h1>2.4.3 / 2011-12-14 </h1>
<ul>
<li>updated; system.profile schema for MongoDB 2x</li>
</ul>
<h1>2.4.2 / 2011-12-12 </h1>
<ul>
<li>fixed; partially populating multiple children of subdocs (#639) [kenpratt]</li>
<li>fixed; allow Update of numbers to null (#640) [jerem]</li>
</ul>
<h1>2.4.1 / 2011-12-02 </h1>
<ul>
<li>added; options support for populate() queries</li>
<li>updated; -native driver to 0.9.7-1.4</li>
</ul>
<h1>2.4.0 / 2011-11-29 </h1>
<ul>
<li>added; QueryStreams (#614)</li>
<li>added; debug print mode for development</li>
<li>added; $within support to Array queries (#586) [ggoodale]</li>
<li>added; $centerSphere query support</li>
<li>fixed; $within support</li>
<li>added; $unset is now used when setting a path to undefined (#519)</li>
<li>added; query::batchSize support</li>
<li>updated; docs</li>
<li>updated; -native driver to 0.9.7-1.3 (provides Windows support)</li>
</ul>
<h1>2.3.13 / 2011-11-15 </h1>
<ul>
<li>fixed; required validation for Refs (#612) [ded]</li>
<li>added; $nearSphere support for Arrays (#610)</li>
</ul>
<h1>2.3.12 / 2011-11-09 </h1>
<ul>
<li>fixed; regression, objects passed to Model.update should not be changed (#605)</li>
<li>fixed; regression, empty Model.update should not be executed</li>
</ul>
<h1>2.3.11 / 2011-11-08 </h1>
<ul>
<li>fixed; using $elemMatch on arrays of Mixed types (#591)</li>
<li>fixed; allow using $regex when querying Arrays (#599)</li>
<li>fixed; calling Model.update with no atomic keys (#602)</li>
</ul>
<h1>2.3.10 / 2011-11-05 </h1>
<ul>
<li>fixed; model.update casting for nested paths works (#542)</li>
</ul>
<h1>2.3.9 / 2011-11-04 </h1>
<ul>
<li>fixed; deepEquals check for MongooseArray returned false</li>
<li>fixed; reset modified flags of embedded docs after save [gitfy]</li>
<li>fixed; setting embedded doc with identical values no longer marks modified [gitfy]</li>
<li>updated; -native driver to 0.9.6.23 [mlazarov]</li>
<li>fixed; Model.update casting (#542, #545, #479)</li>
<li>fixed; populated refs no longer fail required validators (#577)</li>
<li>fixed; populating refs of objects with custom ids works</li>
<li>fixed; $pop &amp; $unset work with Model.update (#574)</li>
<li>added; more helpful debugging message for Schema::add (#578)</li>
<li>fixed; accessing .id when no _id exists now returns null (#590)</li>
</ul>
<h1>2.3.8 / 2011-10-26 </h1>
<ul>
<li>added; callback to query::findOne is now optional (#581)</li>
</ul>
<h1>2.3.7 / 2011-10-24 </h1>
<ul>
<li>fixed; wrapped save/remove callbacks in nextTick to mitigate -native swallowing thrown errors</li>
</ul>
<h1>2.3.6 / 2011-10-21 </h1>
<ul>
<li>fixed; exclusion of embedded doc _id from query results (#541)</li>
</ul>
<h1>2.3.5 / 2011-10-19 </h1>
<ul>
<li>fixed; calling queries without passing a callback works (#569)</li>
<li>fixed; populate() works with String and Number _ids too (#568)</li>
</ul>
<h1>2.3.4 / 2011-10-18 </h1>
<ul>
<li>added; Model.create now accepts an array as a first arg</li>
<li>fixed; calling toObject on a DocumentArray with nulls no longer throws</li>
<li>fixed; calling inspect on a DocumentArray with nulls no longer throws</li>
<li>added; MongooseArray::unshift support</li>
<li>fixed; save hooks now fire on embedded documents <a href="#456">gitfy</a></li>
<li>updated; -native driver to 0.9.6-22</li>
<li>fixed; correctly pass $addToSet op instead of $push</li>
<li>fixed; $addToSet properly detects dates</li>
<li>fixed; $addToSet with multiple items works</li>
<li>updated; better node 0.6 Buffer support</li>
</ul>
<h1>2.3.3 / 2011-10-12 </h1>
<ul>
<li>fixed; population conditions in multi-query settings <a href="#563">vedmalex</a></li>
<li>fixed; now compatible with Node v0.5.x</li>
</ul>
<h1>2.3.2 / 2011-10-11 </h1>
<ul>
<li>fixed; population of null subdoc properties no longer hangs (#561)</li>
</ul>
<h1>2.3.1 / 2011-10-10 </h1>
<ul>
<li>added; support for Query filters to populate() [eneko]</li>
<li>fixed; querying with number no longer crashes mongodb (#555) [jlbyrey]</li>
<li>updated; version of -native driver to 0.9.6-21</li>
<li>fixed; prevent query callbacks that throw errors from corrupting -native connection state</li>
</ul>
<h1>2.3.0 / 2011-10-04 </h1>
<ul>
<li>fixed; nulls as default values for Boolean now works as expected</li>
<li>updated; version of -native driver to 0.9.6-20</li>
</ul>
<h1>2.2.4 / 2011-10-03 </h1>
<ul>
<li>fixed; populate() works when returned array contains undefined/nulls</li>
</ul>
<h1>2.2.3 / 2011-09-29 </h1>
<ul>
<li>updated; version of -native driver to 0.9.6-19</li>
</ul>
<h1>2.2.2 / 2011-09-28 </h1>
<ul>
<li>added; $regex support to String [davidandrewcope]</li>
<li>added; support for other contexts like repl etc (#535)</li>
<li>fixed; clear modified state properly after saving</li>
<li>added; $addToSet support to Array</li>
</ul>
<h1>2.2.1 / 2011-09-22 </h1>
<ul>
<li>more descript error when casting undefined to string</li>
<li>updated; version of -native driver to 0.9.6-18</li>
</ul>
<h1>2.2.0 / 2011-09-22 </h1>
<ul>
<li>fixed; maxListeners warning on schemas with many arrays (#530)</li>
<li>changed; return / apply defaults based on fields selected in query (#423)</li>
<li>fixed; correctly detect Mixed types within schema arrays (#532)</li>
</ul>
<h1>2.1.4 / 2011-09-20 </h1>
<ul>
<li>fixed; new private methods that stomped on users code</li>
<li>changed; finished removing old "compat" support which did nothing</li>
</ul>
<h1>2.1.3 / 2011-09-16 </h1>
<ul>
<li>updated; version of -native driver to 0.9.6-15</li>
<li>added; emit <code>error</code> on connection when open fails [edwardhotchkiss]</li>
<li>added; index support to Buffers (thanks justmoon for helping track this down)</li>
<li>fixed; passing collection name via schema in conn.model() now works (thanks vedmalex for reporting)</li>
</ul>
<h1>2.1.2 / 2011-09-07 </h1>
<ul>
<li>fixed; Query::find with no args no longer throws</li>
</ul>
<h1>2.1.1 / 2011-09-07 </h1>
<ul>
<li>added; support Model.count(fn)</li>
<li>fixed; compatibility with node &gt;=0.4.0 &lt; 0.4.3</li>
<li>added; pass model.options.safe through with .save() so w:2, wtimeout:5000 options work [andrewjstone]</li>
<li>added; support for $type queries</li>
<li>added; support for Query::or</li>
<li>added; more tests</li>
<li>optimized populate queries</li>
</ul>
<h1>2.1.0 / 2011-09-01 </h1>
<ul>
<li>changed; document::validate is a public method</li>
<li>fixed; setting number to same value no longer marks modified (#476) [gitfy]</li>
<li>fixed; Buffers shouldn't have default vals</li>
<li>added; allow specifying collection name in schema (#470) [ixti]</li>
<li>fixed; reset modified paths and atomics after saved (#459)</li>
<li>fixed; set isNew on embedded docs to false after save</li>
<li>fixed; use self to ensure proper scope of options in doOpenSet (#483) [andrewjstone]</li>
</ul>
<h1>2.0.4 / 2011-08-29 </h1>
<ul>
<li>Fixed; Only send the depopulated ObjectId instead of the entire doc on save (DBRefs)</li>
<li>Fixed; Properly cast nested array values in Model.update (the data was stored in Mongo incorrectly but recast on document fetch was "fixing" it)</li>
</ul>
<h1>2.0.3 / 2011-08-28 </h1>
<ul>
<li>Fixed; manipulating a populated array no longer causes infinite loop in BSON serializer during save (#477)</li>
<li>Fixed; populating an empty array no longer hangs foreeeeeeeever (#481)</li>
</ul>
<h1>2.0.2 / 2011-08-25 </h1>
<ul>
<li>Fixed; Maintain query option key order (fixes 'bad hint' error from compound query hints)</li>
</ul>
<h1>2.0.1 / 2011-08-25 </h1>
<ul>
<li>Fixed; do not over-write the doc when no valide props exist in Model.update (#473)</li>
</ul>
<h1>2.0.0 / 2011-08-24 </h1>
<ul>
<li>Added; support for Buffers [justmoon]</li>
<li>Changed; improved error handling [maelstrom]</li>
<li>Removed: unused utils.erase</li>
<li>Fixed; support for passing other context object into Schemas (#234) [Sija]</li>
<li>Fixed; getters are no longer circular refs to themselves (#366)</li>
<li>Removed; unused compat.js</li>
<li>Fixed; getter/setter scopes are set properly</li>
<li>Changed; made several private properties more obvious by prefixing _</li>
<li>Added; DBRef support [guille]</li>
<li>Changed; removed support for multiple collection names per model</li>
<li>Fixed; no longer applying setters when document returned from db</li>
<li>Changed; default auto_reconnect to true</li>
<li>Changed; Query::bind no longer clones the query</li>
<li>Fixed; Model.update now accepts $pull, $inc and friends (#404)</li>
<li>Added; virtual type option support [nw]</li>
</ul>
<h1>1.8.4 / 2011-08-21 </h1>
<ul>
<li>Fixed; validation bug when instantiated with non-schema properties (#464) [jmreidy]</li>
</ul>
<h1>1.8.3 / 2011-08-19 </h1>
<ul>
<li>Fixed; regression in connection::open [jshaw86]</li>
</ul>
<h1>1.8.2 / 2011-08-17 </h1>
<ul>
<li>fixed; reset connection.readyState after failure [tomseago]</li>
<li>fixed; can now query positionally for non-embedded docs (arrays of numbers/strings etc)</li>
<li>fixed; embedded document query casting</li>
<li>added; support for passing options to node-mongo-native db, server, and replsetserver [tomseago]</li>
</ul>
<h1>1.8.1 / 2011-08-10 </h1>
<ul>
<li>fixed; ObjectIds were always marked modified</li>
<li>fixed; can now query using document instances</li>
<li>fixed; can now query/update using documents with subdocs</li>
</ul>
<h1>1.8.0 / 2011-08-04 </h1>
<ul>
<li>fixed; can now use $all with String and Number</li>
<li>fixed; can query subdoc array with $ne: null</li>
<li>fixed; instance.subdocs::id now works with custom _ids</li>
<li>fixed; do not apply setters when doc returned from db (change in bad behavior)</li>
</ul>
<h1>1.7.4 / 2011-07-25 </h1>
<ul>
<li>fixed; sparse now a valid seperate schema option</li>
<li>fixed; now catching cast errors in queries</li>
<li>fixed; calling new Schema with object created in vm.runInNewContext now works (#384) [Sija]</li>
<li>fixed; String enum was disallowing null</li>
<li>fixed; Find by nested document _id now works (#389)</li>
</ul>
<h1>1.7.3 / 2011-07-16 </h1>
<ul>
<li>fixed; MongooseArray::indexOf now works with ObjectIds</li>
<li>fixed; validation scope now set properly (#418)</li>
<li>fixed; added missing colors dependency (#398)</li>
</ul>
<h1>1.7.2 / 2011-07-13 </h1>
<ul>
<li>changed; node-mongodb-native driver to v0.9.6.7</li>
</ul>
<h1>1.7.1 / 2011-07-12 </h1>
<ul>
<li>changed; roll back node-mongodb-native driver to v0.9.6.4</li>
</ul>
<h1>1.7.0 / 2011-07-12 </h1>
<ul>
<li>fixed; collection name misspelling [mathrawka]</li>
<li>fixed; 2nd param is required for ReplSetServers [kevinmarvin]</li>
<li>fixed; MongooseArray behaves properly with Object.keys</li>
<li>changed; node-mongodb-native driver to v0.9.6.6</li>
<li>fixed/changed; Mongodb segfault when passed invalid ObjectId (#407)<ul>
<li>This means invalid data passed to the ObjectId constructor will now error</li>
</ul>
</li>
</ul>
<h1>1.6.0 / 2011-07-07 </h1>
<ul>
<li>changed; .save() errors are now emitted on the instances db instead of the instance 9782463fc</li>
<li>fixed; errors occurring when creating indexes now properly emit on db</li>
<li>added; $maxDistance support to MongooseArrays</li>
<li>fixed; RegExps now work with $all</li>
<li>changed; node-mongodb-native driver to v0.9.6.4</li>
<li>fixed; model names are now accessible via .modelName</li>
<li>added; Query::slaveOk support</li>
</ul>
<h1>1.5.0 / 2011-06-27 </h1>
<ul>
<li>changed; saving without a callback no longer ignores the error ()</li>
<li>changed; hook-js version bump to 0.1.9</li>
<li>changed; node-mongodb-native version bumped to 0.9.6.1 - When .remove() doesn't return an error, null is no longer passed.</li>
<li>fixed; two memory leaks ()</li>
<li>added; sparse index support</li>
<li>added; more ObjectId conditionals (gt, lt, gte, lte) ()</li>
<li>added; options are now passed in model::remote ()</li>
</ul>
<h1>1.4.0 / 2011-06-10 </h1>
<ul>
<li>bumped hooks-js dependency (fixes issue passing null as first arg to next())</li>
<li>fixed; document::inspect now works properly with nested docs</li>
<li>fixed; 'set' now works as a schema attribute (GH-365)</li>
<li>fixed; _id is now set properly within pre-init hooks (GH-289)</li>
<li>added; Query::distinct / Model::distinct support (GH-155)</li>
<li>fixed; embedded docs now can use instance methods (GH-249)</li>
<li>fixed; can now overwrite strings conflicting with schema type</li>
</ul>
<h1>1.3.7 / 2011-06-03 </h1>
<ul>
<li>added MongooseArray::splice support</li>
<li>fixed; 'path' is now a valid Schema pathname</li>
<li>improved hooks (utilizing <a href="https://github.com/bnoguchi/hooks-js">https://github.com/bnoguchi/hooks-js</a>)</li>
<li>fixed; MongooseArray::$shift now works (never did)</li>
<li>fixed; Document.modified no longer throws</li>
<li>fixed; modifying subdoc property sets modified paths for subdoc and parent doc</li>
<li>fixed; marking subdoc path as modified properly persists the value to the db</li>
<li>fixed; RexExps can again be saved ( #357 )</li>
</ul>
<h1>1.3.6 / 2011-05-18 </h1>
<ul>
<li>fixed; corrected casting for queries against array types</li>
<li>added; Document::set now accepts Document instances</li>
</ul>
<h1>1.3.5 / 2011-05-17 </h1>
<ul>
<li>fixed; $ne queries work properly with single vals</li>
<li>added; #inspect() methods to improve console.log output</li>
</ul>
<h1>1.3.4 / 2011-05-17 </h1>
<ul>
<li>fixed; find by Date works as expected (#336)</li>
<li>added; geospatial 2d index support</li>
<li>added; support for $near (#309)</li>
<li>updated; node-mongodb-native driver</li>
<li>fixed; updating numbers work (#342)</li>
<li>added; better error msg when try to remove an embedded doc without an _id (#307)</li>
<li>added; support for 'on-the-fly' schemas (#227)</li>
<li>changed; virtual id getters can now be skipped</li>
<li>fixed; .index() called on subdoc schema now works as expected</li>
<li>fixed; db.setProfile() now buffers until the db is open (#340)</li>
</ul>
<h1>1.3.3 / 2011-04-27 </h1>
<ul>
<li>fixed; corrected query casting on nested mixed types</li>
</ul>
<h1>1.3.2 / 2011-04-27 </h1>
<ul>
<li>fixed; query hints now retain key order</li>
</ul>
<h1>1.3.1 / 2011-04-27 </h1>
<ul>
<li>fixed; setting a property on an embedded array no longer overwrites entire array (GH-310)</li>
<li>fixed; setting nested properties works when sibling prop is named "type"</li>
<li>fixed; isModified is now much finer grained when .set() is used (GH-323)</li>
<li>fixed; mongoose.model() and connection.model() now return the Model (GH-308, GH-305)</li>
<li>fixed; can now use $gt, $lt, $gte, $lte with String schema types (GH-317)</li>
<li>fixed; .lowercase() -&gt; .toLowerCase() in pluralize()</li>
<li>fixed; updating an embedded document by index works (GH-334)</li>
<li>changed; .save() now passes the instance to the callback (GH-294, GH-264)</li>
<li>added; can now query system.profile and system.indexes collections</li>
<li>added; db.model('system.profile') is now included as a default Schema</li>
<li>added; db.setProfiling(level, ms, callback)</li>
<li>added; Query::hint() support</li>
<li>added; more tests</li>
<li>updated node-mongodb-native to 0.9.3</li>
</ul>
<h1>1.3.0 / 2011-04-19 </h1>
<ul>
<li>changed; save() callbacks now fire only once on failed validation</li>
<li>changed; Errors returned from save() callbacks now instances of ValidationError</li>
<li>fixed; MongooseArray::indexOf now works properly</li>
</ul>
<h1>1.2.0 / 2011-04-11 </h1>
<ul>
<li>changed; MongooseNumber now casts empty string to null</li>
</ul>
<h1>1.1.25 / 2011-04-08 </h1>
<ul>
<li>fixed; post init now fires at proper time</li>
</ul>
<h1>1.1.24 / 2011-04-03 </h1>
<ul>
<li>fixed; pushing an array onto an Array works on existing docs</li>
</ul>
<h1>1.1.23 / 2011-04-01 </h1>
<ul>
<li>Added Model::model</li>
</ul>
<h1>1.1.22 / 2011-03-31 </h1>
<ul>
<li>Fixed; $in queries on mixed types now work</li>
</ul>
<h1>1.1.21 / 2011-03-31 </h1>
<ul>
<li>Fixed; setting object root to null/undefined works</li>
</ul>
<h1>1.1.20 / 2011-03-31 </h1>
<ul>
<li>Fixed; setting multiple props on null field works</li>
</ul>
<h1>1.1.19 / 2011-03-31 </h1>
<ul>
<li>Fixed; no longer using $set on paths to an unexisting fields</li>
</ul>
<h1>1.1.18 / 2011-03-30 </h1>
<ul>
<li>Fixed; non-mixed type object setters work after initd from null</li>
</ul>
<h1>1.1.17 / 2011-03-30 </h1>
<ul>
<li>Fixed; nested object property access works when root initd with null value</li>
</ul>
<h1>1.1.16 / 2011-03-28 </h1>
<ul>
<li>Fixed; empty arrays are now saved</li>
</ul>
<h1>1.1.15 / 2011-03-28 </h1>
<ul>
<li>Fixed; <code>null</code> and <code>undefined</code> are set atomically.</li>
</ul>
<h1>1.1.14 / 2011-03-28 </h1>
<ul>
<li>Changed; more forgiving date casting, accepting '' as null.</li>
</ul>
<h1>1.1.13 / 2011-03-26 </h1>
<ul>
<li>Fixed setting values as <code>undefined</code>.</li>
</ul>
<h1>1.1.12 / 2011-03-26 </h1>
<ul>
<li>Fixed; nested objects now convert to JSON properly</li>
<li>Fixed; setting nested objects directly now works</li>
<li>Update node-mongodb-native</li>
</ul>
<h1>1.1.11 / 2011-03-25 </h1>
<ul>
<li>Fixed for use of <code>type</code> as a key.</li>
</ul>
<h1>1.1.10 / 2011-03-23 </h1>
<ul>
<li>Changed; Make sure to only ensure indexes while connected</li>
</ul>
<h1>1.1.9 / 2011-03-2 </h1>
<ul>
<li>Fixed; Mixed can now default to empty arrays</li>
<li>Fixed; keys by the name 'type' are now valid</li>
<li>Fixed; null values retrieved from the database are hydrated as null values.</li>
<li>Fixed repeated atomic operations when saving a same document twice.</li>
</ul>
<h1>1.1.8 / 2011-03-23 </h1>
<ul>
<li>Fixed 'id' overriding. [bnoguchi]</li>
</ul>
<h1>1.1.7 / 2011-03-22 </h1>
<ul>
<li>Fixed RegExp query casting when querying against an Array of Strings [bnoguchi]</li>
<li>Fixed getters/setters for nested virtualsl. [bnoguchi]</li>
</ul>
<h1>1.1.6 / 2011-03-22 </h1>
<ul>
<li>Only doValidate when path exists in Schema [aheckmann]</li>
<li>Allow function defaults for Array types [aheckmann]</li>
<li>Fix validation hang [aheckmann]</li>
<li>Fix setting of isRequired of SchemaType [aheckmann]</li>
<li>Fix SchemaType::required(false) filter [aheckmann]</li>
<li>More backwards compatibility [aheckmann]</li>
<li>More tests [aheckmann]</li>
</ul>
<h1>1.1.5 / 2011-03-14 </h1>
<ul>
<li>Added support for <code>uri, db, fn</code> and <code>uri, fn</code> signatures for replica sets.</li>
<li>Improved/extended replica set tests.</li>
</ul>
<h1>1.1.4 / 2011-03-09 </h1>
<ul>
<li>Fixed; running an empty Query doesn't throw. [aheckmann]</li>
<li>Changed; Promise::addBack returns promise. [aheckmann]</li>
<li>Added streaming cursor support. [aheckmann]</li>
<li>Changed; Query::update defaults to use$SetOnSave now. [brian]</li>
<li>Added more docs.</li>
</ul>
<h1>1.1.3 / 2011-03-04 </h1>
<ul>
<li>Added Promise::resolve [aheckmann]</li>
<li>Fixed backward compatibility with nulls [aheckmann]</li>
<li>Changed; Query#{run,exec} return promises [aheckmann]</li>
</ul>
<h1>1.1.2 / 2011-03-03 </h1>
<ul>
<li>Restored Query::exec and added notion of default operation [brian]</li>
<li>Fixed ValidatorError messages [brian]</li>
</ul>
<h1>1.1.1 / 2011-03-01 </h1>
<ul>
<li>Added SchemaType String <code>lowercase</code>, <code>uppercase</code>, <code>trim</code>.</li>
<li>Public exports (<code>Model</code>, <code>Document</code>) and tests.</li>
<li>Added ObjectId casting support for <code>Document</code>s.</li>
</ul>
<h1>1.1.0 / 2011-02-25 </h1>
<ul>
<li>Added support for replica sets.</li>
</ul>
<h1>1.0.16 / 2011-02-18 </h1>
<ul>
<li>Added $nin as another whitelisted $conditional for SchemaArray [brian]</li>
<li>Changed #with to #where [brian]</li>
<li>Added ability to use $in conditional with Array types [brian]</li>
</ul>
<h1>1.0.15 / 2011-02-18 </h1>
<ul>
<li>Added <code>id</code> virtual getter for documents to easily access the hexString of the <code>_id</code>.</li>
</ul>
<h1>1.0.14 / 2011-02-17 </h1>
<ul>
<li>Fix for arrays within subdocuments [brian]</li>
</ul>
<h1>1.0.13 / 2011-02-16 </h1>
<ul>
<li>Fixed embedded documents saving.</li>
</ul>
<h1>1.0.12 / 2011-02-14 </h1>
<ul>
<li>Minor refactorings [brian]</li>
</ul>
<h1>1.0.11 / 2011-02-14 </h1>
<ul>
<li>Query refactor and $ne, $slice, $or, $size, $elemMatch, $nin, $exists support [brian]</li>
<li>Named scopes sugar [brian]</li>
</ul>
<h1>1.0.10 / 2011-02-11 </h1>
<ul>
<li>Updated node-mongodb-native driver [thanks John Allen]</li>
</ul>
<h1>1.0.9 / 2011-02-09 </h1>
<ul>
<li>Fixed single member arrays as defaults [brian]</li>
</ul>
<h1>1.0.8 / 2011-02-09 </h1>
<ul>
<li>Fixed for collection-level buffering of commands [gitfy]</li>
<li>Fixed <code>Document::toJSON</code> [dalejefferson]</li>
<li>Fixed <code>Connection</code> authentication [robrighter]</li>
<li>Fixed clash of accessors in getters/setters [eirikurn]</li>
<li>Improved <code>Model::save</code> promise handling</li>
</ul>
<h1>1.0.7 / 2011-02-05 </h1>
<ul>
<li>Fixed memory leak warnings for test suite on 0.3</li>
<li>Fixed querying documents that have an array that contain at least one specified member. [brian]</li>
<li>Fixed default value for Array types (fixes GH-210). [brian]</li>
<li>Fixed example code.</li>
</ul>
<h1>1.0.6 / 2011-02-03 </h1>
<ul>
<li>Fixed <code>post</code> middleware</li>
<li>Fixed; it's now possible to instantiate a model even when one of the paths maps to an undefined value [brian]</li>
</ul>
<h1>1.0.5 / 2011-02-02 </h1>
<ul>
<li>Fixed; combo $push and $pushAll auto-converts into a $pushAll [brian]</li>
<li>Fixed; combo $pull and $pullAll auto-converts to a single $pullAll [brian]</li>
<li>Fixed; $pullAll now removes said members from array before save (so it acts just like pushAll) [brian]</li>
<li>Fixed; multiple $pulls and $pushes become a single $pullAll and $pushAll. Moreover, $pull now modifies the array before save to reflect the immediate change [brian]</li>
<li>Added tests for nested shortcut getters [brian]</li>
<li>Added tests that show that Schemas with nested Arrays don't apply defaults [brian]</li>
</ul>
<h1>1.0.4 / 2011-02-02 </h1>
<ul>
<li>Added MongooseNumber::toString</li>
<li>Added MongooseNumber unit tests</li>
</ul>
<h1>1.0.3 / 2011-02-02 </h1>
<ul>
<li>Make sure safe mode works with Model::save</li>
<li>Changed Schema options: safe mode is now the default</li>
<li>Updated node-mongodb-native to HEAD</li>
</ul>
<h1>1.0.2 / 2011-02-02 </h1>
<ul>
<li>Added a Model.create shortcut for creating documents. [brian]</li>
<li>Fixed; we can now instantiate models with hashes that map to at least one null value. [brian]</li>
<li>Fixed Schema with more than 2 nested levels. [brian]</li>
</ul>
<h1>1.0.1 / 2011-02-02 </h1>
<ul>
<li>Improved <code>MongooseNumber</code>, works almost like the native except for <code>typeof</code> not being &lsquo;'number&rsquo;`. </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
